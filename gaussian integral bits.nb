(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    380378,      10374]
NotebookOptionsPosition[    346846,       9798]
NotebookOutlinePosition[    347274,       9815]
CellTagsIndexPosition[    347231,       9812]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["??", "Section",
 CellChangeTimes->{{3.859906320810646*^9, 
  3.859906320977248*^9}},ExpressionUUID->"554853e5-0d33-4eb5-9fc4-\
e2b55bf10581"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RealSimplify", "[", 
    RowBox[{"foo_", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"foo", ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", "\[Element]", "Reals"}], "}"}], ",", "opts"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8573214876933537`*^9, 3.857321509259219*^9}},
 CellLabel->
  "(Local 2) In[1]:=",ExpressionUUID->"5f0cfd65-e141-4b2c-a455-8ce72f7a4e01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x_List", ",", "mean_List", ",", "var_List"}], "}"}]}], "]"}], ":=", 
   RowBox[{"RealSimplify", "[", 
    RowBox[{"Expectation", "[", 
     RowBox[{"func", ",", 
      RowBox[{"x", "\[Distributed]", 
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{"mean", ",", "var"}], "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "mean_", ",", "var_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "mean", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var", "}"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_List", ",", "mean1_List", ",", "var1_List"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_List", ",", "mean2_List", ",", "var2_List"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"RealSimplify", "[", 
    RowBox[{
     RowBox[{"Expectation", "[", 
      RowBox[{
       RowBox[{"Expectation", "[", 
        RowBox[{"func", ",", 
         RowBox[{"x1", "\[Distributed]", 
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{"mean1", ",", "var1"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"x2", "\[Distributed]", 
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{"mean2", ",", "var2"}], "]"}]}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", ">=", "0"}], ")"}], "&"}], "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"var1", ",", "var2"}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", "mean1_", ",", "var1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "mean2_", ",", "var2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x1", "}"}], ",", 
       RowBox[{"{", "mean1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var1", "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x2", "}"}], ",", 
       RowBox[{"{", "mean2", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var2", "}"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8572184464809*^9, 3.857218513059203*^9}, {
  3.857218853827277*^9, 3.857218858153126*^9}, {3.8572193619492483`*^9, 
  3.857219365977461*^9}, {3.857319437983425*^9, 3.8573194525824127`*^9}, {
  3.857319504520795*^9, 3.857319512093252*^9}, {3.857319984168502*^9, 
  3.857320079001564*^9}, {3.857321118949943*^9, 3.8573211469935417`*^9}, {
  3.857321198854895*^9, 3.857321202147283*^9}, {3.857321242722563*^9, 
  3.857321252493494*^9}, {3.857322001159059*^9, 3.857322007624271*^9}},
 CellLabel->
  "(Local 2) In[64]:=",ExpressionUUID->"18a34ef7-bac8-484e-9cc3-58e228d0bb4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegralSlow", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_List", ",", "mean1_List", ",", "var1_List"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_List", ",", "mean2_List", ",", "var2_List"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"RealSimplify", "[", 
    RowBox[{"Expectation", "[", 
     RowBox[{"func", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", "\[Distributed]", 
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{"mean1", ",", "var1"}], "]"}]}], ",", 
        RowBox[{"x2", "\[Distributed]", 
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{"mean2", ",", "var2"}], "]"}]}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegralSlow", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", "mean1_", ",", "var1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "mean2_", ",", "var2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"GaussianIntegralSlow", "[", 
    RowBox[{"func", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x1", "}"}], ",", 
       RowBox[{"{", "mean1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var1", "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x2", "}"}], ",", 
       RowBox[{"{", "mean2", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var2", "}"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.857322011916379*^9, 3.8573220165429993`*^9}},
 CellLabel->
  "(Local 2) In[68]:=",ExpressionUUID->"2e8637c6-e70b-4ac4-9c0a-f53064dfb57e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "/", 
       RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellLabel->
  "(Local 2) In[8]:=",ExpressionUUID->"81c5849c-d438-4102-b1c2-e5fe51119c65"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi\[Prime]", ",", "xj\[Prime]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xj\[Prime]", ",", "xj", ",", 
     RowBox[{"\[Sigma]j", "^", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.85721856653706*^9, 3.8572185678101797`*^9}, {
  3.8573200905014877`*^9, 3.8573200919594316`*^9}, {3.8573202294377317`*^9, 
  3.857320232576221*^9}},
 CellLabel->
  "(Local 2) In[9]:=",ExpressionUUID->"56292ce7-4847-41a6-b73d-986ff6ab888c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xi\[Prime]", "-", "xj"}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SuperscriptBox["\[Sigma]j", "2"]}], ")"}]}]]}]], " ", 
   RowBox[{"Abs", "[", "\[Sigma]", "]"}]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SuperscriptBox["\[Sigma]j", "2"]}]]]], "Output",
 CellChangeTimes->{{3.857218560300439*^9, 3.8572186169082193`*^9}, 
   3.857218861789538*^9, 3.857219118867981*^9, 3.85721938962039*^9, 
   3.8572199857668333`*^9, 3.857220557708271*^9, 3.857223888071138*^9, {
   3.857223980996464*^9, 3.8572239932035007`*^9}, 3.857305909894116*^9, 
   3.857307535067521*^9, 3.857320093626306*^9, {3.8573202373414*^9, 
   3.857320247986476*^9}, 3.857321513153656*^9, 3.857321543204609*^9},
 CellLabel->
  "(Local 2) Out[9]=",ExpressionUUID->"94eace02-fb04-4462-aec1-8c95a2e7651b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{"\[Sigma]", ">=", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.857219988934943*^9, 3.85721999273597*^9}},
 CellLabel->
  "(Local 2) In[10]:=",ExpressionUUID->"92ecbc5c-724f-4a9d-b34a-5c33ff424a08"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Sigma]", "\[GreaterEqual]", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.857219993469366*^9, 3.8572205592928*^9, 
  3.8572238893099623`*^9, 3.857224024530616*^9, 3.857305909959468*^9, 
  3.8573075351315527`*^9, 3.857320207825614*^9, 3.857320248522793*^9, 
  3.857321544034947*^9},
 CellLabel->
  "(Local 2) Out[10]=",ExpressionUUID->"a79deef9-b810-4292-87ad-145ea0e97ccb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi\[Prime]", ",", "xj\[Prime]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xj\[Prime]", ",", "xj", ",", 
     RowBox[{"\[Sigma]j", "^", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857320213602458*^9, 3.857320214829916*^9}},
 CellLabel->
  "(Local 2) In[11]:=",ExpressionUUID->"d12f4432-4845-4633-bb60-6f7ee28eaf1d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xi\[Prime]", "-", "xj"}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SuperscriptBox["\[Sigma]j", "2"]}], ")"}]}]]}]], " ", "\[Sigma]"}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SuperscriptBox["\[Sigma]j", "2"]}]]]], "Output",
 CellChangeTimes->{3.8572200004174356`*^9, 3.8572205621600943`*^9, 
  3.857223891135466*^9, 3.857224026110366*^9, 3.85730591169543*^9, 
  3.857307536146448*^9, 3.857320250008459*^9, 3.857321545446999*^9},
 CellLabel->
  "(Local 2) Out[11]=",ExpressionUUID->"9e84f5f6-9db9-4a98-8c75-6830d2ca3f94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi\[Prime]", ",", "xj\[Prime]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xj\[Prime]", ",", "xj", ",", 
     RowBox[{"\[Sigma]j", "^", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xi\[Prime]", ",", "xi", ",", 
     RowBox[{"\[Sigma]i", "^", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857320267478361*^9, 3.857320269544979*^9}},
 CellLabel->
  "(Local 2) In[12]:=",ExpressionUUID->"2954e04d-6e4d-4b69-8f28-6e0b4a8ee4fc"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xi", "-", "xj"}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SuperscriptBox["\[Sigma]i", "2"], "+", 
         SuperscriptBox["\[Sigma]j", "2"]}], ")"}]}]]}]], " ", "\[Sigma]"}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SuperscriptBox["\[Sigma]i", "2"], "+", 
    SuperscriptBox["\[Sigma]j", "2"]}]]]], "Output",
 CellChangeTimes->{{3.857320276125882*^9, 3.857320286546969*^9}, 
   3.8573215537884407`*^9},
 CellLabel->
  "(Local 2) Out[12]=",ExpressionUUID->"e03807a1-1dc4-438a-8482-9e6adee020e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral2", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi\[Prime]", ",", "xj\[Prime]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xj\[Prime]", ",", "xj", ",", 
     RowBox[{"\[Sigma]j", "^", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xi\[Prime]", ",", "xi", ",", 
     RowBox[{"\[Sigma]i", "^", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.8573215666393127`*^9},
 CellLabel->
  "(Local 2) In[13]:=",ExpressionUUID->"cfa60f23-8fac-43cf-97ac-70b54fc28611"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xi", "-", "xj"}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SuperscriptBox["\[Sigma]i", "2"], "+", 
         SuperscriptBox["\[Sigma]j", "2"]}], ")"}]}]]}]], " ", "\[Sigma]"}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SuperscriptBox["\[Sigma]i", "2"], "+", 
    SuperscriptBox["\[Sigma]j", "2"]}]]]], "Output",
 CellChangeTimes->{3.857321568645597*^9},
 CellLabel->
  "(Local 2) Out[13]=",ExpressionUUID->"0f7e212d-e77d-4f4b-9408-0387a9cd8f09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["varx", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857215120665328*^9, 3.8572151209452543`*^9}, {
  3.8572206430758057`*^9, 3.85722065198853*^9}, {3.8573202914822407`*^9, 
  3.8573202927115383`*^9}},
 CellLabel->
  "(Local 2) In[14]:=",ExpressionUUID->"fe4a731a-4518-46b1-9e7a-a5615f07df5b"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.8572151212901783`*^9, 3.857220653253992*^9, 
  3.857223917785863*^9, 3.857224031795994*^9, 3.857307538313869*^9, 
  3.857320293205864*^9, 3.85732158570986*^9},
 CellLabel->
  "(Local 2) Out[14]=",ExpressionUUID->"229c0c08-234d-43bc-9a23-d4c9efe3227f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{"x", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["varx", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857215076686284*^9, 3.857215109553892*^9}, {
  3.857220657747738*^9, 3.857220658886512*^9}, {3.857320295920599*^9, 
  3.8573202969443893`*^9}},
 CellLabel->
  "(Local 2) In[15]:=",ExpressionUUID->"fab5e232-2ee5-4570-93d9-59515291e52a"],

Cell[BoxData[
 SubscriptBox["x", "1"]], "Output",
 CellChangeTimes->{3.857215110342638*^9, 3.857220659347376*^9, 
  3.857223918575803*^9, 3.857224032409536*^9, 3.857307538947831*^9, 
  3.857320297343981*^9, 3.857321586242777*^9},
 CellLabel->
  "(Local 2) Out[15]=",ExpressionUUID->"45b21b42-bce7-43cb-b696-3065487692f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"x", "^", "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["varx", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857215130062523*^9, 3.8572151302099867`*^9}, {
   3.8572206615655127`*^9, 3.857220664607554*^9}, 3.85732030171517*^9},
 CellLabel->
  "(Local 2) In[16]:=",ExpressionUUID->"b1fee1c7-ffbd-4050-bfc7-7bac4aac4cf7"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["varx", "1"], "+", 
  SubsuperscriptBox["x", "1", "2"]}]], "Output",
 CellChangeTimes->{3.857215130627294*^9, 3.8572206651679153`*^9, 
  3.8572239191415377`*^9, 3.8572240337400513`*^9, 3.857307539597005*^9, 
  3.857320302227964*^9, 3.857321586753108*^9},
 CellLabel->
  "(Local 2) Out[16]=",ExpressionUUID->"72c56f38-85e8-470c-afee-0e6817c2135a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"x", "^", "3"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["varx", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8572206765829144`*^9, 3.857220676635233*^9}, 
   3.8573203054908133`*^9},
 CellLabel->
  "(Local 2) In[17]:=",ExpressionUUID->"f7f5528b-770c-45bd-898d-a1bf2e54dcb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SubscriptBox["varx", "1"], " ", 
   SubscriptBox["x", "1"]}], "+", 
  SubsuperscriptBox["x", "1", "3"]}]], "Output",
 CellChangeTimes->{3.857220676960815*^9, 3.857223919690485*^9, 
  3.857224034291625*^9, 3.857307540534522*^9, 3.8573203067272263`*^9, 
  3.857321587343089*^9},
 CellLabel->
  "(Local 2) Out[17]=",ExpressionUUID->"92cbb888-b9bc-4c2d-9fb0-53d3b5633569"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"x", "^", "4"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["varx", "1"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.8572206793236027`*^9, 3.857320308920454*^9},
 CellLabel->
  "(Local 2) In[18]:=",ExpressionUUID->"8a31cffa-c940-4218-b2fc-358ddb52b1eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SubsuperscriptBox["varx", "1", "2"]}], "+", 
  RowBox[{"6", " ", 
   SubscriptBox["varx", "1"], " ", 
   SubsuperscriptBox["x", "1", "2"]}], "+", 
  SubsuperscriptBox["x", "1", "4"]}]], "Output",
 CellChangeTimes->{3.857220679769081*^9, 3.857223920377625*^9, 
  3.85722403482414*^9, 3.857307541412696*^9, 3.857320309371133*^9, 
  3.857321587898415*^9},
 CellLabel->
  "(Local 2) Out[18]=",ExpressionUUID->"946f9745-a056-4b50-9431-9e79a182d385"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", 
       SubscriptBox["y", "1"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["varx", "1"], ",", 
         SubscriptBox["covxy", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["covxy", "1"], ",", 
         SubscriptBox["vary", "1"]}], "}"}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857220806011265*^9, 3.857220829193685*^9}, {
  3.857320314466875*^9, 3.8573203183456583`*^9}},
 CellLabel->
  "(Local 2) In[19]:=",ExpressionUUID->"5d1bc6b0-d3d3-41f2-b809-83df29f615bd"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.857220830223393*^9, 3.8572239226156883`*^9, 
  3.8572240354483223`*^9, 3.857307542197266*^9, 3.8573203188771048`*^9, 
  3.85732158852789*^9},
 CellLabel->
  "(Local 2) Out[19]=",ExpressionUUID->"83ac56eb-def0-4714-a7b5-e5cbf555e524"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{"x", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", 
       SubscriptBox["y", "1"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["varx", "1"], ",", 
         SubscriptBox["covxy", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["covxy", "1"], ",", 
         SubscriptBox["vary", "1"]}], "}"}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857220835838251*^9, 3.8572208406673927`*^9}, 
   3.857320323709592*^9},
 CellLabel->
  "(Local 2) In[20]:=",ExpressionUUID->"1c23353a-5401-4b30-93c8-34a18258b541"],

Cell[BoxData[
 SubscriptBox["x", "1"]], "Output",
 CellChangeTimes->{3.857220836224595*^9, 3.857223923331121*^9, 
  3.857224036082465*^9, 3.857307543078622*^9, 3.857320324530761*^9, 
  3.857321589103573*^9},
 CellLabel->
  "(Local 2) Out[20]=",ExpressionUUID->"d4c6623f-461b-466e-92b2-fb535125597a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"x", " ", "y"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", 
       SubscriptBox["y", "1"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["varx", "1"], ",", 
         SubscriptBox["covxy", "1"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["covxy", "1"], ",", 
         SubscriptBox["vary", "1"]}], "}"}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857220845240034*^9, 3.857220845461656*^9}, 
   3.8573203278352222`*^9},
 CellLabel->
  "(Local 2) In[21]:=",ExpressionUUID->"da6d2c2a-cb12-4bc8-9f5e-87d0868c2d73"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["covxy", "1"], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["y", "1"]}]}]], "Output",
 CellChangeTimes->{3.8572208458628397`*^9, 3.857223924713615*^9, 
  3.857224036701274*^9, 3.857307556579997*^9, 3.857320328661475*^9, 
  3.85732158962926*^9},
 CellLabel->
  "(Local 2) Out[21]=",ExpressionUUID->"e26f267b-84c2-4af8-9c8c-de5b51c19f2f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xi_", ",", "yi_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xj_", ",", "yj_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"yi", "-", "yj"}], ")"}], "^", "2"}]}], ")"}], "/", 
       RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.857220906321344*^9, 3.857220948263351*^9}},
 CellLabel->
  "(Local 2) In[22]:=",ExpressionUUID->"f976ddaa-8b5a-4638-9c9e-9da01c6d6365"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"a2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xi", ",", "xj"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yi", ",", "yj"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xj", ",", "yj"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", "y1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Sigma]x1", "^", "2"}], ",", "\[Sigma]x1\[Sigma]y1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]x1\[Sigma]y1", ",", 
         RowBox[{"\[Sigma]y1", "^", "2"}]}], "}"}]}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857220967665229*^9, 3.857221094497923*^9}, {
  3.857221186991632*^9, 3.857221188970944*^9}, {3.85732033918989*^9, 
  3.8573203402380867`*^9}},
 CellLabel->
  "(Local 2) In[23]:=",ExpressionUUID->"394ba93a-a5d8-4d11-a6cc-b17da3f5a8ec"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["x1", "2"], " ", 
        SuperscriptBox["\[Sigma]", "2"]}], "-", 
       RowBox[{"2", " ", "x1", " ", "y1", " ", 
        SuperscriptBox["\[Sigma]", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["y1", "2"], " ", 
        SuperscriptBox["\[Sigma]", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["yi", "2"], " ", 
        SuperscriptBox["\[Sigma]", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["yi", "2"], " ", 
        SuperscriptBox["\[Sigma]x1", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["yi", "2"], " ", "\[Sigma]x1\[Sigma]y1"}], "+", 
       RowBox[{
        SuperscriptBox["yi", "2"], " ", 
        SuperscriptBox["\[Sigma]y1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["xi", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "2"], "+", 
          SuperscriptBox["\[Sigma]x1", "2"], "-", 
          RowBox[{"2", " ", "\[Sigma]x1\[Sigma]y1"}], "+", 
          SuperscriptBox["\[Sigma]y1", "2"]}], ")"}]}], "-", 
       RowBox[{"2", " ", "xi", " ", "yi", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "2"], "+", 
          SuperscriptBox["\[Sigma]x1", "2"], "-", 
          RowBox[{"2", " ", "\[Sigma]x1\[Sigma]y1"}], "+", 
          SuperscriptBox["\[Sigma]y1", "2"]}], ")"}]}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Sigma]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SuperscriptBox["\[Sigma]x1", "2"], "-", 
         RowBox[{"2", " ", "\[Sigma]x1\[Sigma]y1"}], "+", 
         SuperscriptBox["\[Sigma]y1", "2"]}], ")"}]}]]}]], " ", "\[Sigma]"}], 
  
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SuperscriptBox["\[Sigma]x1", "2"], "-", 
    RowBox[{"2", " ", "\[Sigma]x1\[Sigma]y1"}], "+", 
    SuperscriptBox["\[Sigma]y1", "2"]}]]]], "Output",
 CellChangeTimes->{3.857221064001259*^9, 3.857221095776176*^9, 
  3.85722120175349*^9, 3.857223940469862*^9, 3.8572241326615133`*^9, 
  3.85732035310117*^9, 3.857321603282818*^9},
 CellLabel->
  "(Local 2) Out[23]=",ExpressionUUID->"664e0913-78da-4945-81e4-5e9621e933ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetModel", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Guild", "[", "n", "]"}], "->", 
     RowBox[{"{", 
      RowBox[{"Traits", "->", 
       RowBox[{"{", "x", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Transitions", ":>", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["n", "\[FormalI]"], "\[DoubleRightArrow]", 
           "\[EmptySet]"}], "}"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{
              SubscriptBox["x", "\[FormalI]"], ",", 
              SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
            SubscriptBox["n", "\[FormalJ]"]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FormalJ]", ",", 
             SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0", 
            SubscriptBox["n", "\[FormalI]"]}], "\[DoubleRightArrow]", 
           SubscriptBox["n", "\[FormalI]"]}], "}"}], ",", 
         RowBox[{"r", "[", 
          SubscriptBox["x", "\[FormalI]"], "]"}], ",", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "\[Sigma]\[Mu]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Parameters", ":>", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]\[Mu]", ">=", "0"}], ",", 
       RowBox[{"\[Sigma]", ">=", "0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8573203550840883`*^9, 3.857320359685589*^9}},
 CellLabel->
  "(Local 2) In[25]:=",ExpressionUUID->"fe0ed2bb-12ed-44bb-bdbe-108ed88b4684"],

Cell[BoxData[
 RowBox[{"SetModel", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Guild", "[", "n", "]"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Traits", "\[Rule]", 
       RowBox[{"{", "x", "}"}]}], "}"}]}], ",", 
    RowBox[{"Transitions", "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["n", "\[FormalI]"], "\[DoubleRightArrow]", 
           "\[EmptySet]"}], "}"}], ",", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
           SubscriptBox["\[ScriptCapitalN]", "n"]], 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{
             SubscriptBox["x", "\[FormalI]"], ",", 
             SubscriptBox["x", "\[FormalJ]"]}], "]"}], " ", 
           SubscriptBox["n", "\[FormalJ]"]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0", " ", 
            SubscriptBox["n", "\[FormalI]"]}], "\[DoubleRightArrow]", 
           SubscriptBox["n", "\[FormalI]"]}], "}"}], ",", 
         RowBox[{"r", "[", 
          SubscriptBox["x", "\[FormalI]"], "]"}], ",", 
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "\[Sigma]\[Mu]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Parameters", "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]\[Mu]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Sigma]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "}"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.857320376472913*^9},
 CellLabel->
  "(Local 2) Out[25]=",ExpressionUUID->"d2613e8b-77d4-471a-ad7d-984785fa79f6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "/", 
       RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "x_", "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"x", "^", "2"}]}]}], ";"}]}], "Input",
 CellLabel->
  "(Local 2) In[24]:=",ExpressionUUID->"5966fe6e-c58f-482a-963f-e1611eb9111c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "[", 
     SubscriptBox["x", "\[FormalI]"], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "\[FormalI]"], ",", 
     SubscriptBox[
      OverscriptBox["x", "_"], "\[FormalI]"], ",", 
     SubscriptBox[
      RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857306014231331*^9, 3.8573060680847073`*^9}, {
  3.857316557755234*^9, 3.8573165955856047`*^9}, {3.857320384674637*^9, 
  3.857320397611349*^9}},
 CellLabel->
  "(Local 2) In[26]:=",ExpressionUUID->"d981d701-831c-4905-849a-d67ed73eb00f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["n", "\[FormalI]"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SubsuperscriptBox[
     OverscriptBox["x", "_"], "\[FormalI]", "2"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.857320398274344*^9, 3.85732161831973*^9},
 CellLabel->
  "(Local 2) Out[26]=",ExpressionUUID->"cbdee128-06bd-4ac9-ad03-d99cb9386729"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"UnfactorSum", ":=", 
  RowBox[{
   RowBox[{"pre_.", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}]}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"pre", " ", "func"}], ",", "range", ",", "opts"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8573081609208117`*^9, 3.857308186088821*^9}},
 CellLabel->
  "(Local 2) In[27]:=",ExpressionUUID->"e359571d-7920-4527-896e-9ca656228054"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}]}], "]"}], 
   SubscriptBox["n", "\[FormalI]"]}], "/.", "UnfactorSum"}]], "Input",
 CellChangeTimes->{{3.8573081984207487`*^9, 3.857308199982733*^9}},
 CellLabel->
  "(Local 2) In[28]:=",ExpressionUUID->"d1441c21-b391-4759-bd8a-7e693ce7b1a1"],

Cell[BoxData[
 RowBox[{
  UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
   SubscriptBox["\[ScriptCapitalN]", "n"]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], "-", 
         SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
   SubscriptBox["n", "\[FormalI]"], " ", 
   SubscriptBox["n", "\[FormalJ]"]}]}]], "Output",
 CellChangeTimes->{3.8573082007113867`*^9, 3.857320431324923*^9, 
  3.857321620679586*^9},
 CellLabel->
  "(Local 2) Out[28]=",ExpressionUUID->"bf862410-d376-455a-ba01-02f474756c57"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FixSum", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FixSum", ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{"stuff___", ",", 
     RowBox[{"{", 
      RowBox[{"ind_", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "gu_", "]"}]}], "}"}]}], "]"}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"GaussianIntegral", "[", 
      RowBox[{"stuff", ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "ind"], ",", 
         SubscriptBox[
          OverscriptBox["x", "_"], "ind"], ",", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "ind"]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ind", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], "}"}], ",", 
     RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8573112772516117`*^9, 3.857311277739324*^9}, {
  3.857311341613207*^9, 3.857311426324417*^9}, {3.8573116191311197`*^9, 
  3.857311686726427*^9}, {3.857311769206984*^9, 3.857311781553483*^9}, {
  3.857311815642366*^9, 3.857311936564413*^9}, {3.8573119744440804`*^9, 
  3.857311974480036*^9}, {3.857312186019644*^9, 3.857312228127037*^9}, {
  3.8573122724978247`*^9, 3.8573122773314323`*^9}, {3.857312332541511*^9, 
  3.857312354056139*^9}, {3.857313080085478*^9, 3.857313106741029*^9}, {
  3.857313667504217*^9, 3.8573136784411*^9}, {3.857316942423396*^9, 
  3.857316989482092*^9}, {3.857317105073801*^9, 3.8573171131133337`*^9}, {
  3.857317187521577*^9, 3.857317187787684*^9}, {3.857317290582019*^9, 
  3.857317320291498*^9}, {3.857320537029088*^9, 3.857320546390667*^9}},
 CellLabel->
  "(Local 2) In[29]:=",ExpressionUUID->"20829558-2407-4de2-a2f8-751ba2fec106"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}]}], "]"}], "/.", 
   "FixSum"}], "/.", 
  RowBox[{
   RowBox[{"OverBar", "[", "var_", "]"}], "->", "var"}]}]], "Input",
 CellLabel->
  "(Local 2) In[31]:=",ExpressionUUID->"726b3ae3-18f6-45fe-b993-325cde3cea0b"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], "-", 
           SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ",
      "\[Sigma]", " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.857317348739381*^9, 3.857317462021633*^9, 
  3.857320552852069*^9, 3.857321622565197*^9},
 CellLabel->
  "(Local 2) Out[31]=",ExpressionUUID->"1050b8c5-a1bb-4984-b181-44f71922c4c1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FixSum", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FixSum", ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{"stuff___", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "gu_", "]"}]}], "}"}]}], "]"}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"GaussianIntegral", "[", 
      RowBox[{"stuff", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "i"], ",", 
           SubscriptBox["y", "i"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["x", "_"], "i"], ",", 
           SubscriptBox[
            OverscriptBox["y", "_"], "i"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              RowBox[{"Var", "[", "x", "]"}], "i"], ",", 
             SubscriptBox[
              RowBox[{"Cov", "[", 
               RowBox[{"x", ",", "y"}], "]"}], "i"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              RowBox[{"Cov", "[", 
               RowBox[{"x", ",", "y"}], "]"}], "i"], ",", 
             SubscriptBox[
              RowBox[{"Var", "[", "y", "]"}], "i"]}], "}"}]}], "}"}]}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], "}"}], ",", 
     RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8573112772516117`*^9, 3.857311277739324*^9}, {
  3.857311341613207*^9, 3.857311426324417*^9}, {3.8573116191311197`*^9, 
  3.857311686726427*^9}, {3.857311769206984*^9, 3.857311781553483*^9}, {
  3.857311815642366*^9, 3.857311936564413*^9}, {3.8573119744440804`*^9, 
  3.857311974480036*^9}, {3.857312186019644*^9, 3.857312228127037*^9}, {
  3.8573122724978247`*^9, 3.8573122773314323`*^9}, {3.857312332541511*^9, 
  3.857312354056139*^9}, {3.857313080085478*^9, 3.857313106741029*^9}, {
  3.857313667504217*^9, 3.8573136784411*^9}, {3.857316942423396*^9, 
  3.857316989482092*^9}, {3.857317105073801*^9, 3.8573171131133337`*^9}, {
  3.857317187521577*^9, 3.857317187787684*^9}, {3.857317290582019*^9, 
  3.857317320291498*^9}, {3.857317405260932*^9, 3.85731743975886*^9}, {
  3.857317821497497*^9, 3.857317839187798*^9}, {3.857320565760758*^9, 
  3.857320568750787*^9}},
 CellLabel->
  "(Local 2) In[32]:=",ExpressionUUID->"76038f19-1797-4b9f-8237-3ed3bedbc2f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}]}], "]"}], "/.", 
   "FixSum"}], "/.", 
  RowBox[{
   RowBox[{"OverBar", "[", "var_", "]"}], "->", "var"}]}]], "Input",
 CellLabel->
  "(Local 2) In[34]:=",ExpressionUUID->"4f21765b-2936-41e1-a3c9-5858659aeaf0"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], "-", 
           SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ",
      "\[Sigma]", " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.857317453578229*^9, 3.857317465475315*^9}, 
   3.857317842425621*^9, 3.857320574698113*^9, 3.857321627836932*^9},
 CellLabel->
  "(Local 2) Out[34]=",ExpressionUUID->"d2d65219-9eaf-4b87-a11a-c33c79be08f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}]}], "]"}], 
   SubscriptBox["n", "\[FormalI]"]}], "/.", "UnfactorSum"}]], "Input",
 CellChangeTimes->{{3.857317982075604*^9, 3.8573179841047993`*^9}, {
  3.857318064241583*^9, 3.857318066324696*^9}},
 CellLabel->
  "(Local 2) In[35]:=",ExpressionUUID->"d2dba971-9c93-4ec3-b006-00b8855fd967"],

Cell[BoxData[
 RowBox[{
  UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
   RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], "-", 
         SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
   SubscriptBox["n", "\[FormalI]"], " ", 
   SubscriptBox["n", "\[FormalJ]"]}]}]], "Output",
 CellChangeTimes->{{3.857317958116879*^9, 3.857317985940795*^9}, 
   3.857318066927096*^9, 3.857320601075177*^9, 3.8573216294246492`*^9},
 CellLabel->
  "(Local 2) Out[35]=",ExpressionUUID->"aa820a53-8f5a-428e-9688-fb7d2a5fe4a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}]}], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], "/.", "UnfactorSum"}], "/.", 
  "FixSum"}]], "Input",
 CellChangeTimes->{{3.8573180769445543`*^9, 3.857318077913192*^9}},
 CellLabel->
  "(Local 2) In[36]:=",ExpressionUUID->"e544634e-76fe-4259-9fc8-4405e1393375"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], "-", 
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ",
      "\[Sigma]", " ", 
     SubscriptBox["n", "\[FormalI]"], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.8573180795173264`*^9, 3.8573206066565943`*^9, 
  3.85732163115165*^9},
 CellLabel->
  "(Local 2) Out[36]=",ExpressionUUID->"121c340c-4fec-4bf4-ae56-729f7ffeb291"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FixSum", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FixSum", ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{"stuff___", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "gu_", "]"}]}], "}"}]}], "]"}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"GaussianIntegral", "[", 
      RowBox[{"stuff", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "i"], ",", 
           SubscriptBox["y", "i"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["x", "_"], "i"], ",", 
           SubscriptBox[
            OverscriptBox["y", "_"], "i"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              RowBox[{"Var", "[", "x", "]"}], "i"], ",", 
             SubscriptBox[
              RowBox[{"Cov", "[", 
               RowBox[{"x", ",", "y"}], "]"}], "i"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              RowBox[{"Cov", "[", 
               RowBox[{"x", ",", "y"}], "]"}], "i"], ",", 
             SubscriptBox[
              RowBox[{"Var", "[", "y", "]"}], "i"]}], "}"}]}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], ",", 
           SubscriptBox["y", "\[FormalI]"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalI]"], ",", 
           SubscriptBox[
            OverscriptBox["y", "_"], "\[FormalI]"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], ",", 
             SubscriptBox[
              RowBox[{"Cov", "[", 
               RowBox[{"x", ",", "y"}], "]"}], "\[FormalI]"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              RowBox[{"Cov", "[", 
               RowBox[{"x", ",", "y"}], "]"}], "\[FormalI]"], ",", 
             SubscriptBox[
              RowBox[{"Var", "[", "y", "]"}], "\[FormalI]"]}], "}"}]}], 
          "}"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], "}"}], ",", 
     RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQbcK74qjN3jeO3Su2g+mU+ZvPgugFiV43QLSSUcoH
EP3E7voPED13vhqzLUh820YWEO3c94UDRK/hF5IA0S9Mz8mA6JKY82D6zQIH
cxC9QaDFBkTrveN3AtESs1eBaf6QiZ4g+slpRx8QbbOHaTmIbtoWvgpE9ygV
fADRdbLnPoLosp6znfZA2id3fT+InhKjNA9E5y1Qng+iD20oWAGit5pUguln
84O2gugvwZw7QXRf5IrDIHqqx4/jILr+9frvILqQ6dlPEK0YscPPEUgXsUn4
g2jblDURIDrFSiMaRAMAsvedZQ==
  "],
 CellLabel->
  "(Local 2) In[37]:=",ExpressionUUID->"79e776f8-5d55-42c7-9f7c-36239325751b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}]}], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], "/.", "UnfactorSum"}], "/.", 
  "FixSum"}]], "Input",
 CellChangeTimes->{{3.857320728150079*^9, 3.857320739872755*^9}},
 CellLabel->
  "(Local 2) In[39]:=",ExpressionUUID->"5b6ede48-f3e7-4ecd-93bb-843cb361f62d"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalI]"], "-", 
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ",
      "\[Sigma]", " ", 
     SubscriptBox["n", "\[FormalI]"], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.857320677909618*^9, {3.857320737110107*^9, 3.8573207432313013`*^9}, 
   3.85732164991429*^9},
 CellLabel->
  "(Local 2) Out[39]=",ExpressionUUID->"34353891-f480-4a0a-8aa8-7516529fdce0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "FixSum", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FixSum", ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{"stuff___", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "gu_", "]"}]}], "}"}]}], "]"}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"GaussianIntegral", "[", 
      RowBox[{"stuff", ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "i"], ",", 
         SubscriptBox[
          OverscriptBox["x", "_"], "i"], ",", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "i"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalI]"], ",", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], "}"}], ",", 
     RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQbcK74qjN3jeO3Su2g+mU+ZvPgugFiV43QLSSUcoH
EP3E7voPED13vhqzLUh820YWEO3c94UDRK/hF5IA0S9Mz8mA6JKY82D6zQIH
cxC9QaDFBkTrveN3AtESs1eBaf6QiZ4g+slpRx8QbbOHaTmIbtoWvgpE9ygV
fADRdbLnPoLosp6znfZA2id3fT+InhKjNA9E5y1Qng+iD20oWAGit5pUguln
84O2gugvwZw7QXRf5IrDIHqqx4/jILr+9frvILqQ6dlPEK0YscPPEUgXsUn4
g2jblDURIDrFSiMaRBt9TM4A0Z1bN+SCaADSkqYF
  "],
 CellLabel->
  "(Local 2) In[40]:=",ExpressionUUID->"26e93dce-e2a7-4002-b538-bc7ba35e95dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}]}], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], "/.", "UnfactorSum"}], "/.", 
  "FixSum"}]], "Input",
 CellLabel->
  "(Local 2) In[42]:=",ExpressionUUID->"da5f927b-df81-4a98-a1a4-457fda884d7e"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalI]"], "-", 
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ",
      "\[Sigma]", " ", 
     SubscriptBox["n", "\[FormalI]"], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.8573208447616653`*^9, 3.8573216608089533`*^9},
 CellLabel->
  "(Local 2) Out[42]=",ExpressionUUID->"44387381-57aa-485a-94cc-489cdd6104c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
    SubscriptBox["n", "\[FormalJ]"], 
    SubscriptBox["n", "\[FormalI]"]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "\[FormalJ]"], ",", 
     SubscriptBox[
      OverscriptBox["x", "_"], "\[FormalJ]"], ",", 
     SubscriptBox[
      RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "\[FormalI]"], ",", 
     SubscriptBox[
      OverscriptBox["x", "_"], "\[FormalI]"], ",", 
     SubscriptBox[
      RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857320865439762*^9, 3.857320893617255*^9}},
 CellLabel->
  "(Local 2) In[43]:=",ExpressionUUID->"e5c1536d-61e0-4ad5-bafa-b8b0e41641d8"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalI]"], "-", 
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ", 
   "\[Sigma]", " ", 
   SubscriptBox["n", "\[FormalI]"], " ", 
   SubscriptBox["n", "\[FormalJ]"]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]]], "Output",
 CellChangeTimes->{3.857320896244625*^9, 3.857321677930287*^9},
 CellLabel->
  "(Local 2) Out[43]=",ExpressionUUID->"63960d81-c6c6-4cff-87ac-8786053e2c6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
      SubscriptBox["n", "\[FormalJ]"], 
      SubscriptBox["n", "\[FormalI]"]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "\[FormalJ]"], ",", 
       SubscriptBox[
        OverscriptBox["x", "_"], "\[FormalJ]"], ",", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox[
        OverscriptBox["x", "_"], "\[FormalI]"], ",", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Sigma]", ">=", "0"}], ",", 
     RowBox[{
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], ">=", "0"}], ",", 
     RowBox[{
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"], ">=", "0"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8573210538480387`*^9, 3.8573210660536737`*^9}},
 CellLabel->
  "(Local 2) In[44]:=",ExpressionUUID->"a46eec44-6775-4743-9951-c972141d5818"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalI]"], "-", 
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ", 
   "\[Sigma]", " ", 
   SubscriptBox["n", "\[FormalI]"], " ", 
   SubscriptBox["n", "\[FormalJ]"]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]]], "Output",
 CellChangeTimes->{{3.857321061923428*^9, 3.857321067194723*^9}, 
   3.857321683223133*^9},
 CellLabel->
  "(Local 2) Out[44]=",ExpressionUUID->"77b125d7-5427-45a7-b248-e3a7417884f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianIntegral", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
     SubscriptBox["n", "\[FormalJ]"], 
     SubscriptBox["n", "\[FormalI]"]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalJ]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalJ]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.857321270566875*^9, 3.857321271599318*^9}},
 CellLabel->
  "(Local 2) In[71]:=",ExpressionUUID->"95786a3a-f664-43b7-8ae0-9801eab0caf1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5971075`", ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalI]"], "-", 
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ",
      "\[Sigma]", " ", 
     SubscriptBox["n", "\[FormalI]"], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.85732117042944*^9, 3.8573212170768642`*^9}, {
   3.857321260405252*^9, 3.8573212758647738`*^9}, 3.8573216883946333`*^9, 
   3.857322061087913*^9},
 CellLabel->
  "(Local 2) Out[71]=",ExpressionUUID->"db8c084a-c61e-48f6-83b4-ca9e2c3b407e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianIntegralSlow", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
     SubscriptBox["n", "\[FormalJ]"], 
     SubscriptBox["n", "\[FormalI]"]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalJ]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalJ]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{
  3.8573212195999403`*^9, {3.857321277728198*^9, 3.857321278810804*^9}, {
   3.857322046714407*^9, 3.857322047076064*^9}},
 CellLabel->
  "(Local 2) In[72]:=",ExpressionUUID->"88a4c135-cc87-4230-bba4-b85068280d94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.904177`", ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalI]"], "-", 
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ",
      "\[Sigma]", " ", 
     SubscriptBox["n", "\[FormalI]"], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8573212203638773`*^9, {3.857321264073138*^9, 3.8573212822001123`*^9}, 
   3.857321464277417*^9, 3.857321693315695*^9, 3.8573219873355503`*^9, {
   3.8573220550394793`*^9, 3.8573220683412457`*^9}},
 CellLabel->
  "(Local 2) Out[72]=",ExpressionUUID->"a1516bbb-020a-4bbb-a5ae-91520162fb34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "=", 
  RowBox[{"GaussianIntegral", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
     SubscriptBox["n", "\[FormalJ]"], 
     SubscriptBox["n", "\[FormalI]"]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalJ]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalJ]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.857322497241714*^9, 3.857322508501834*^9}},
 CellLabel->
  "(Local 2) In[74]:=",ExpressionUUID->"85665344-b85f-4ad3-8eac-297ff6533607"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalI]"], "-", 
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ", 
   "\[Sigma]", " ", 
   SubscriptBox["n", "\[FormalI]"], " ", 
   SubscriptBox["n", "\[FormalJ]"]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]]], "Output",
 CellChangeTimes->{3.857322453306569*^9, 3.857322509892082*^9},
 CellLabel->
  "(Local 2) Out[74]=",ExpressionUUID->"d9a478cd-e796-452c-aeba-7f2848d1afc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"f", ",", 
   RowBox[{"{", 
    SubscriptBox[
     OverscriptBox["x", "_"], "\[FormalI]"], "}"}]}], "]"}]], "Input",
 CellLabel->
  "(Local 2) In[81]:=",ExpressionUUID->"7c6c5bba-8e80-4d2f-8565-ec13c29e90c3"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox[
           OverscriptBox["x", "_"], "\[FormalI]"], "-", 
          SubscriptBox[
           OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "2"], "+", 
          SubscriptBox[
           RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
          SubscriptBox[
           RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ", 
    "\[Sigma]", " ", 
    SubscriptBox["n", "\[FormalI]"], " ", 
    SubscriptBox["n", "\[FormalJ]"], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], "-", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]]}]], "Output",
 CellChangeTimes->{3.857322637529963*^9},
 CellLabel->
  "(Local 2) Out[81]=",ExpressionUUID->"5f5ede85-be9c-476a-8cd7-62c7a3038ef4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"f", ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["x", "_"], "\[FormalI]"], ",", "2"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857322606733407*^9, 3.857322615172237*^9}},
 CellLabel->
  "(Local 2) In[83]:=",ExpressionUUID->"be92ecd5-cfc8-4fdf-8f0f-e47f1222208e"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Sigma]", " ", 
   SubscriptBox["n", "\[FormalI]"], " ", 
   SubscriptBox["n", "\[FormalJ]"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox[
              OverscriptBox["x", "_"], "\[FormalI]"], "-", 
             SubscriptBox[
              OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "2"], "+", 
             SubscriptBox[
              RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
             SubscriptBox[
              RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], 
       " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox[
           OverscriptBox["x", "_"], "\[FormalI]"], "-", 
          SubscriptBox[
           OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}], "2"]], "-", 
     
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["x", "_"], "\[FormalI]"], "-", 
            SubscriptBox[
             OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "+", 
            SubscriptBox[
             RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
            SubscriptBox[
             RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], 
      RowBox[{
       SuperscriptBox["\[Sigma]", "2"], "+", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]}], ")"}]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
    SubscriptBox[
     RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}]]]], "Output",
 CellChangeTimes->{3.857322616000894*^9, 3.857322661443613*^9},
 CellLabel->
  "(Local 2) Out[83]=",ExpressionUUID->"19830707-1ff7-4e94-a1d1-7f41163e0c3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"f", ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", "2"}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857322664984791*^9, 3.857322706293639*^9}},
 CellLabel->
  "(Local 2) In[88]:=",ExpressionUUID->"5c954a6c-b7b8-4b11-b794-9aeda119dbee"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox[
           OverscriptBox["x", "_"], "\[FormalI]"], "-", 
          SubscriptBox[
           OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "2"], "+", 
          SubscriptBox[
           RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
          SubscriptBox[
           RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ", 
    "\[Sigma]", " ", 
    SubscriptBox["n", "\[FormalI]"], " ", 
    SubscriptBox["n", "\[FormalJ]"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "-", 
      SubsuperscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]", "2"], "+", 
      RowBox[{"2", " ", 
       SubscriptBox[
        OverscriptBox["x", "_"], "\[FormalI]"], " ", 
       SubscriptBox[
        OverscriptBox["x", "_"], "\[FormalJ]"]}], "-", 
      SubsuperscriptBox[
       OverscriptBox["x", "_"], "\[FormalJ]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}], 
    RowBox[{"5", "/", "2"}]]]}]], "Output",
 CellChangeTimes->{{3.85732266739222*^9, 3.857322706670492*^9}},
 CellLabel->
  "(Local 2) Out[88]=",ExpressionUUID->"e68c31e7-60d7-4a46-9ebc-3e171a0a1ab4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{"d", "[", 
    SubscriptBox["x", "\[FormalI]"], "]"}], "+", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}]}], "]"}], 
    SubscriptBox["x", "\[FormalI]"]}]}]}]], "Input",
 CellChangeTimes->{{3.857385549959547*^9, 3.857385559897143*^9}, 
   3.857391544836273*^9, {3.857391753905685*^9, 3.8573917697958593`*^9}, {
   3.857402808420705*^9, 3.857402810225338*^9}},
 CellLabel->
  "(Local 2) \
In[106]:=",ExpressionUUID->"960626d9-4ad8-49a0-99a5-7a7f742d01a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", 
   SubscriptBox["x", "\[FormalI]"], "]"}], "+", 
  RowBox[{
   SubscriptBox["x", "\[FormalI]"], " ", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], "-", 
           SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"]}]}]}]}]], "Output",
 CellChangeTimes->{
  3.8573855627991333`*^9, 3.857391545423502*^9, {3.857391754521303*^9, 
   3.857391770458143*^9}, 3.8574028107776003`*^9},
 CellLabel->
  "(Local 2) \
Out[106]=",ExpressionUUID->"274b57ef-5517-4010-849c-27bf8ba6ea54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "/.", "UnfactorSum"}]], "Input",
 CellChangeTimes->{{3.857385565618318*^9, 3.8573855678664703`*^9}, {
  3.857391756552758*^9, 3.857391759226149*^9}},
 CellLabel->
  "(Local 2) \
In[107]:=",ExpressionUUID->"c9a066fb-63c3-41c9-9c53-03b2935db47a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", 
   SubscriptBox["x", "\[FormalI]"], "]"}], "+", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
    RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "\[FormalI]"], "-", 
          SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
    SubscriptBox["n", "\[FormalJ]"], " ", 
    SubscriptBox["x", "\[FormalI]"]}]}]}]], "Output",
 CellChangeTimes->{
  3.857385568215564*^9, 3.857391545924286*^9, {3.857391759697658*^9, 
   3.857391773714478*^9}, 3.8574028116369047`*^9},
 CellLabel->
  "(Local 2) \
Out[107]=",ExpressionUUID->"c9f5201c-22ec-4457-8c27-7da39d471f8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Map"}]], "Input",
 CellChangeTimes->{{3.857392603818294*^9, 3.857392606878337*^9}},
 CellLabel->
  "(Local 2) In[99]:=",ExpressionUUID->"bb04a0cb-01c6-4527-9e27-d2d2ca67c08b"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/Map",
              ButtonNote->"paclet:ref/Map"],
             "\"paclet:ref/Map\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"Map\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"expr\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\\) or \\!\\(\\*RowBox[{StyleBox[\\\"f\\\", \
\\\"TI\\\"], \\\"/@\\\", StyleBox[\\\"expr\\\", \\\"TI\\\"]}]\\) applies \
\\!\\(\\*StyleBox[\\\"f\\\", \\\"TI\\\"]\\) to each element on the first \
level in \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\). \\n\\!\\(\\*RowBox[{\
\\\"Map\\\", \\\"[\\\", RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"levelspec\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\\) applies \\!\\(\\*StyleBox[\\\"f\\\", \
\\\"TI\\\"]\\) to parts of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\) \
specified by \\!\\(\\*StyleBox[\\\"levelspec\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Map\\\", \\\"[\\\", StyleBox[\\\"f\\\", \\\"TI\\\"], \
\\\"]\\\"}]\\) represents an operator form of Map that can be applied to an \
expression.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", "paclet:ref/Map", 
                    "paclet:ref/Map", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"], "\"  \"", 
                    StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False], 
                    "\"  \"", 
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL["http://reference.wolfram.com/language/ref/Map.html"],
                     None}, 
                    "http://reference.wolfram.com/language/ref/Map.html", 
                    "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Options\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Options\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Options", "Tooltip"]& ], 
                   RowBox[{"Heads", "\[Rule]", "False"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", 
                    RowBox[{"Protected", ",", "ReadProtected"}], "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`Map\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{16., {5., 11.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{16., {5., 11.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/Map",
              ButtonNote->"paclet:ref/Map"],
             "\"paclet:ref/Map\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"Map\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"expr\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\\) or \\!\\(\\*RowBox[{StyleBox[\\\"f\\\", \
\\\"TI\\\"], \\\"/@\\\", StyleBox[\\\"expr\\\", \\\"TI\\\"]}]\\) applies \
\\!\\(\\*StyleBox[\\\"f\\\", \\\"TI\\\"]\\) to each element on the first \
level in \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\). \\n\\!\\(\\*RowBox[{\
\\\"Map\\\", \\\"[\\\", RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"levelspec\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\\) applies \\!\\(\\*StyleBox[\\\"f\\\", \
\\\"TI\\\"]\\) to parts of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\) \
specified by \\!\\(\\*StyleBox[\\\"levelspec\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"Map\\\", \\\"[\\\", StyleBox[\\\"f\\\", \\\"TI\\\"], \
\\\"]\\\"}]\\) represents an operator form of Map that can be applied to an \
expression.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {2., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{13., {2., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"Map\", \"[\", RowBox[{StyleBox[\"f\", \"TI\"], \",\", \
StyleBox[\"expr\", \"TI\"]}], \"]\"}]\) or \!\(\*RowBox[{StyleBox[\"f\", \"TI\
\"], \"/@\", StyleBox[\"expr\", \"TI\"]}]\) applies \!\(\*StyleBox[\"f\", \
\"TI\"]\) to each element on the first level in \!\(\*StyleBox[\"expr\", \"TI\
\"]\). \n\!\(\*RowBox[{\"Map\", \"[\", RowBox[{StyleBox[\"f\", \"TI\"], \
\",\", StyleBox[\"expr\", \"TI\"], \",\", StyleBox[\"levelspec\", \"TI\"]}], \
\"]\"}]\) applies \!\(\*StyleBox[\"f\", \"TI\"]\) to parts of \!\(\*StyleBox[\
\"expr\", \"TI\"]\) specified by \!\(\*StyleBox[\"levelspec\", \"TI\"]\). \n\
\!\(\*RowBox[{\"Map\", \"[\", StyleBox[\"f\", \"TI\"], \"]\"}]\) represents \
an operator form of Map that can be applied to an expression.", 
    "Documentation" -> <|
     "Local" -> "paclet:ref/Map", "Web" -> 
      "http://reference.wolfram.com/language/ref/Map.html"|>, "OwnValues" -> 
    None, "UpValues" -> None, "DownValues" -> None, "SubValues" -> None, 
    "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> {Heads -> False}, "Attributes" -> {Protected, ReadProtected},
     "FullName" -> "System`Map"|>, False]]], "Output",
 CellChangeTimes->{{3.857392604757406*^9, 3.857392607113092*^9}},
 CellLabel->
  "(Local 2) Out[99]=",ExpressionUUID->"f16672f1-7921-44ae-8e94-bdcd848fbc19"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianIntegral", "[", 
   RowBox[{
    RowBox[{"Plus", "[", "stuff__", "]"}], ",", "args_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"gaussianIntegral", "[", 
      RowBox[{"#", ",", "args"}], "]"}], "&"}], ",", 
    RowBox[{"stuff", "/.", "UnfactorSum"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8573925536761637`*^9, 3.8573925938962593`*^9}, {
   3.857402456431243*^9, 3.857402506594266*^9}, {3.857402575902892*^9, 
   3.857402586371806*^9}, 3.8574028749613533`*^9, 
   3.857403035034865*^9},ExpressionUUID->"08563147-b2f3-4181-8458-\
bfb5b0b201f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianIntegral", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"stuff__", ",", 
      RowBox[{"{", 
       RowBox[{"i_", ",", 
        RowBox[{"\[ScriptCapitalN]", "[", "gu_", "]"}]}], "}"}]}], "]"}], ",",
     "args_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"gaussianIntegral", "[", 
     RowBox[{"stuff", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "i"], ",", 
        SubscriptBox[
         OverscriptBox["x", "_"], "i"], ",", 
        SubscriptBox[
         RowBox[{"Var", "[", "x", "]"}], "i"]}], "}"}], ",", "args"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], "}"}], ",", 
    RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.857393314190959*^9, 3.8573933226685553`*^9}, {
   3.85740260613512*^9, 3.857402618312427*^9}, 3.857402859917942*^9, 
   3.8574030369519577`*^9},ExpressionUUID->"121cd6bf-97bb-4c80-b9c7-\
26f8f8aea440"],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"GaussianIntegral", ",", "HoldFirst"}], "]"}]], "Input",
 CellChangeTimes->{{3.8574029547233067`*^9, 3.857403000520048*^9}},
 CellLabel->
  "(Local 2) \
In[118]:=",ExpressionUUID->"759a7238-e1f5-4e67-a9bc-6cab7cd6977b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{"tmp", ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "\[FormalI]"], ",", 
     SubscriptBox[
      OverscriptBox["x", "_"], "\[FormalI]"], ",", 
     SubscriptBox[
      RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857402778521254*^9, 3.857402788000875*^9}},
 CellLabel->
  "(Local 2) \
In[119]:=",ExpressionUUID->"0cfa86d4-f913-47bc-aea1-45aabdb5de3a"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.857402804698628*^9, {3.857402849309575*^9, 3.857402872660557*^9}, 
   3.857402911593052*^9, 3.857403017935843*^9},
 CellLabel->
  "(Local 2) \
Out[119]=",ExpressionUUID->"018069cf-23c3-423b-895b-f91988d5c9d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"x", "+", "y"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "\[FormalI]"], ",", 
     SubscriptBox[
      OverscriptBox["x", "_"], "\[FormalI]"], ",", 
     SubscriptBox[
      RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857402918018282*^9, 3.857402918418969*^9}, {
  3.857403020498914*^9, 3.857403021722527*^9}},
 CellLabel->
  "(Local 2) \
In[120]:=",ExpressionUUID->"cc251418-47a0-41bc-85d4-300753e6868f"],

Cell[BoxData[
 RowBox[{"x", "+", "y"}]], "Output",
 CellChangeTimes->{3.857402918698989*^9, 3.8574030222514668`*^9},
 CellLabel->
  "(Local 2) \
Out[120]=",ExpressionUUID->"34309187-42a5-4e53-b05c-4e5a87cbee4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.857402924981114*^9, 3.857402928958993*^9}},
 CellLabel->
  "(Local 2) \
In[115]:=",ExpressionUUID->"9ee7effa-2255-403a-81e2-722af42238f1"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Plus", "[", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"Subscript", "[", 
       RowBox[{"x", ",", "\[FormalI]"}], "]"}], "]"}], ",", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"x", ",", "\[FormalI]"}], "]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Times", "[", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"E", ",", 
             RowBox[{"Times", "[", 
              RowBox[{
               RowBox[{"Rational", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Power", "[", 
                RowBox[{"\[Sigma]", ",", 
                 RowBox[{"-", "2"}]}], "]"}], ",", 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"Plus", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"x", ",", "\[FormalI]"}], "]"}], ",", 
                   RowBox[{"Times", "[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"x", ",", "\[FormalJ]"}], "]"}]}], "]"}]}], "]"}],
                  ",", "2"}], "]"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"Subscript", "[", 
            RowBox[{"n", ",", "\[FormalJ]"}], "]"}]}], "]"}], ",", 
         RowBox[{"List", "[", 
          RowBox[{"\[FormalJ]", ",", 
           RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{{3.8574029255588007`*^9, 3.857402929590403*^9}},
 CellLabel->
  "(Local 2) \
Out[115]//FullForm=",ExpressionUUID->"8ef5a49e-a247-46f0-b865-4f5ea8ede3a5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "GaussianIntegral", "]"}]], "Input",
 CellChangeTimes->{{3.857403053243866*^9, 3.857403055326798*^9}},
 CellLabel->
  "(Local 2) \
In[185]:=",ExpressionUUID->"41ef57ca-0475-4a3a-992c-369bedd1e7f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x_List", ",", "mean_List", ",", "var_List"}], "}"}]}], "]"}], ":=", 
   RowBox[{"RealSimplify", "[", 
    RowBox[{"Expectation", "[", 
     RowBox[{"func", ",", 
      RowBox[{"x", "\[Distributed]", 
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{"mean", ",", "var"}], "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "mean_", ",", "var_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "mean", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var", "}"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_List", ",", "mean1_List", ",", "var1_List"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_List", ",", "mean2_List", ",", "var2_List"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"RealSimplify", "[", 
    RowBox[{
     RowBox[{"Expectation", "[", 
      RowBox[{
       RowBox[{"Expectation", "[", 
        RowBox[{"func", ",", 
         RowBox[{"x1", "\[Distributed]", 
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{"mean1", ",", "var1"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"x2", "\[Distributed]", 
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{"mean2", ",", "var2"}], "]"}]}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", ">=", "0"}], ")"}], "&"}], "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"var1", ",", "var2"}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", "mean1_", ",", "var1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "mean2_", ",", "var2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x1", "}"}], ",", 
       RowBox[{"{", "mean1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var1", "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x2", "}"}], ",", 
       RowBox[{"{", "mean2", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var2", "}"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8572184464809*^9, 3.857218513059203*^9}, {
  3.857218853827277*^9, 3.857218858153126*^9}, {3.8572193619492483`*^9, 
  3.857219365977461*^9}, {3.857319437983425*^9, 3.8573194525824127`*^9}, {
  3.857319504520795*^9, 3.857319512093252*^9}, {3.857319984168502*^9, 
  3.857320079001564*^9}, {3.857321118949943*^9, 3.8573211469935417`*^9}, {
  3.857321198854895*^9, 3.857321202147283*^9}, {3.857321242722563*^9, 
  3.857321252493494*^9}, {3.857322001159059*^9, 3.857322007624271*^9}},
 CellLabel->
  "(Local 2) \
In[188]:=",ExpressionUUID->"bc71189d-165e-4785-b0a1-3c0432a9c227"],

Cell[BoxData[
 RowBox[{"UnfactorSums", ":=", 
  RowBox[{
   RowBox[{"pre_.", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}]}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"pre", " ", "func"}], ",", "range", ",", "opts"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{3.8574033307595243`*^9},
 CellLabel->
  "(Local 2) \
In[180]:=",ExpressionUUID->"261413f0-a242-4ce8-8482-30428f1a9748"],

Cell[CellGroupData[{

Cell[BoxData["tmp"], "Input",
 CellChangeTimes->{{3.8574035333486557`*^9, 3.857403533483609*^9}},
 CellLabel->
  "(Local 2) \
In[181]:=",ExpressionUUID->"d39ebaea-3616-47a9-82a7-c530a15df48e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", 
   SubscriptBox["x", "\[FormalI]"], "]"}], "+", 
  RowBox[{
   SubscriptBox["x", "\[FormalI]"], " ", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], "-", 
           SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"]}]}]}]}]], "Output",
 CellChangeTimes->{3.857403533953494*^9, 3.857405085427185*^9, 
  3.857428811633946*^9},
 CellLabel->
  "(Local 2) \
Out[181]=",ExpressionUUID->"ea911595-cb31-4f27-b41c-7203b7160ce8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "/.", "UnfactorSums"}]], "Input",
 CellChangeTimes->{{3.8574037866362953`*^9, 3.8574037908498096`*^9}},
 CellLabel->
  "(Local 2) \
In[182]:=",ExpressionUUID->"66d83fb5-11da-404e-a29f-c7132c080330"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", 
   SubscriptBox["x", "\[FormalI]"], "]"}], "+", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
    RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "\[FormalI]"], "-", 
          SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
    SubscriptBox["n", "\[FormalJ]"], " ", 
    SubscriptBox["x", "\[FormalI]"]}]}]}]], "Output",
 CellChangeTimes->{3.8574037915638027`*^9, 3.857405087744536*^9, 
  3.8574288142693787`*^9},
 CellLabel->
  "(Local 2) \
Out[182]=",ExpressionUUID->"12376e5c-abd5-4830-b119-fee15b5abb23"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Distribute", "[", 
  RowBox[{"gaussianIntegral", "[", 
   RowBox[{
    RowBox[{"tmp", "/.", "UnfactorSums"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857404404716813*^9, 3.8574044523418703`*^9}, {
  3.857404571595789*^9, 3.857404572923046*^9}, {3.857404953648142*^9, 
  3.857404957646289*^9}},
 CellLabel->
  "(Local 2) \
In[160]:=",ExpressionUUID->"9b2b4e70-723c-4f1d-98d2-88b3b4f3e696"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussianIntegral", "[", 
   RowBox[{
    RowBox[{"d", "[", 
     SubscriptBox["x", "\[FormalI]"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], "+", 
  RowBox[{"gaussianIntegral", "[", 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
      RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "\[FormalI]"], "-", 
            SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
      SubscriptBox["n", "\[FormalJ]"], " ", 
      SubscriptBox["x", "\[FormalI]"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{{3.8574044450337257`*^9, 3.857404452820537*^9}, 
   3.8574045735429497`*^9, 3.8574049582667427`*^9, 3.8574050978862247`*^9},
 CellLabel->
  "(Local 2) \
Out[160]=",ExpressionUUID->"4cd398bf-7624-4bbd-8025-5ae023374751"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussianIntegral", "[", 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
      RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "\[FormalI]"], "-", 
            SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
      SubscriptBox["n", "\[FormalJ]"], " ", 
      SubscriptBox["x", "\[FormalI]"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], "/.", 
  "DistributegISum"}]], "Input",
 CellChangeTimes->{
  3.857404968109539*^9, {3.857405010726343*^9, 3.857405011625828*^9}, 
   3.8574051137902193`*^9, 3.857405183445425*^9},
 CellLabel->
  "(Local 2) \
In[165]:=",ExpressionUUID->"56a249e6-3ff3-41c3-bcd8-d5436c6afbd2"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"gaussianIntegral", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "\[FormalI]"], "-", 
            SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
      SubscriptBox["n", "\[FormalJ]"], " ", 
      SubscriptBox["x", "\[FormalI]"]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "\[FormalJ]"], ",", 
       SubscriptBox[
        OverscriptBox["x", "_"], "\[FormalJ]"], ",", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox[
        OverscriptBox["x", "_"], "\[FormalI]"], ",", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.857405018449328*^9, 3.857405043038535*^9}, 
   3.857405120827602*^9, 3.857405184562045*^9, 3.85740524620712*^9},
 CellLabel->
  "(Local 2) \
Out[165]=",ExpressionUUID->"eda5cb44-ef82-4d8c-8165-e6f8873a75d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Distribute", "[", 
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{
     RowBox[{"tmp", "/.", "UnfactorSums"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox[
        OverscriptBox["x", "_"], "\[FormalI]"], ",", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], 
   "]"}], "/.", "DistributeGISum"}]], "Input",
 CellChangeTimes->{{3.8574272969986887`*^9, 3.857427328980453*^9}},
 CellLabel->
  "(Local 2) \
In[166]:=",ExpressionUUID->"0d8cdfd1-d8f2-49f9-b34d-21eb40ff01ab"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.857427495067268*^9},
 CellLabel->
  "(Local 2) \
Out[166]=",ExpressionUUID->"cf286aca-cfc0-4218-865c-391d48a1056e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["start here", "Section",
 CellChangeTimes->{{3.857432921217174*^9, 
  3.8574329228981037`*^9}},ExpressionUUID->"1be9b2c9-c3b7-41d3-b462-\
d2c48b4c6d91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussianIntegral", "[", 
   RowBox[{"expr_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "coeff", ",", "exp", ",", "\[Mu]", ",", "a", ",", "b", ",", "c", ",", 
      "rul", ",", "factor", ",", "\[Sigma]", ",", "moment"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coeff", ",", "exp"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"expr", "/", 
           RowBox[{"Exp", "[", "#", "]"}]}], ",", "#"}], "}"}], "&"}], "[", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"FactorList", "[", "expr", "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"E", "^", "x_"}], ",", "p_"}], "}"}], ":>", 
           RowBox[{"p", " ", "x"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{"exp", ",", "vars", ",", 
        RowBox[{"\"\<Symmetric\>\"", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{
       RowBox[{"LinearSolve", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rul", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"#", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"EvenQ", "@", 
            RowBox[{"Total", "@", 
             RowBox[{"First", "[", "x", "]"}]}]}]}]}], "]"}], "&"}], "@", 
       RowBox[{"CoefficientRules", "[", 
        RowBox[{
         RowBox[{"coeff", "/.", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"vars", "->", 
            RowBox[{"vars", "-", "\[Mu]"}]}], "]"}]}], ",", "vars"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rul", "==", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"factor", "=", 
      RowBox[{
       RowBox[{"\[Pi]", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "vars", "]"}], "/", "2"}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"c", "-", 
          RowBox[{
           RowBox[{"\[Mu]", ".", "b"}], "/", "2"}]}], "]"}], "/", 
        RowBox[{"Sqrt", "@", 
         RowBox[{"Det", "[", 
          RowBox[{"-", "a"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"rul", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ".."}], "}"}], "->", "_"}], "}"}]}], "]"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"rul", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "factor"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Inverse", "[", "a", "]"}]}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"moment", "[", 
       RowBox[{"{", 
        RowBox[{"0", "..."}], "}"}], "]"}], "=", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"moment", "[", "x_List", "]"}], "/;", 
       RowBox[{
        RowBox[{"Total", "[", "x", "]"}], "==", "2"}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "==", "1"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "&"}], 
       "@", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"x", ",", 
          RowBox[{"y_", "?", "Positive"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"moment", "[", "x_List", "]"}], ":=", 
      RowBox[{
       RowBox[{"moment", "[", "x", "]"}], "=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "=", 
            RowBox[{
             RowBox[{"LengthWhile", "[", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"#", "==", "0"}], "&"}]}], "]"}], "+", "1"}]}], ",", 
           RowBox[{"x2", "=", "x"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "--"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ">", "0"}], ",", 
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
               RowBox[{"moment", "@", 
                RowBox[{"MapAt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "-", "1"}], "&"}], ",", "x2", ",", "j"}], 
                 "]"}]}]}], ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "i", ",", 
              RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#2", " ", 
          RowBox[{"moment", "[", "#1", "]"}]}], "&"}], "@@@", "rul"}], "]"}], 
      " ", "factor"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.839022846949445*^9, 3.839022846951334*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4d1a5e2e-62c5-41c5-b4be-0bc48e3a1dc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussMoment", "[", 
   RowBox[{"fPre_", ",", "fExp_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coeff", ",", "dist", ",", "ai", ",", "\[Mu]", ",", "norm"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"coeff", "=", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{"fExp", ",", "vars", ",", 
        RowBox[{"\"\<Symmetric\>\"", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ai", "=", 
      RowBox[{"Inverse", "[", 
       RowBox[{"2", " ", 
        RowBox[{"coeff", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{"-", 
       RowBox[{"ai", ".", 
        RowBox[{"coeff", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dist", "=", 
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{"\[Mu]", ",", 
        RowBox[{"-", "ai"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"norm", "=", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"PDF", "[", 
         RowBox[{"dist", ",", "vars"}], "]"}]}], "/.", " ", 
       RowBox[{"Thread", "[", 
        RowBox[{"vars", "->", "\[Mu]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"norm", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{
           RowBox[{"coeff", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ".", "\[Mu]"}]}], "+", 
         RowBox[{"coeff", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
       RowBox[{"Distribute", "@", 
        RowBox[{"Expectation", "[", 
         RowBox[{"fPre", ",", 
          RowBox[{"vars", "\[Distributed]", "dist"}]}], "]"}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8599072049619427`*^9, 3.859907204981536*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"045e8fa5-325d-4309-a457-5decebae6c81"],

Cell[BoxData[
 RowBox[{"UnfactorSums", ":=", 
  RowBox[{
   RowBox[{"pre_.", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}]}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"pre", " ", "func"}], ",", "range", ",", "opts"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.857432347698988*^9, 3.8574323491061773`*^9}, 
   3.857432919458984*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"6d6e8817-a0b9-45d5-af65-7ff62f906016"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RealSimplify", "[", 
    RowBox[{"foo_", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"foo", ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", "\[Element]", "Reals"}], "}"}], ",", "opts"}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"45ef531b-1765-4ef1-87cf-b41e5fe46eaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GaussianIntegral", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"stuff__", ",", 
      RowBox[{"{", 
       RowBox[{"i_", ",", 
        RowBox[{"\[ScriptCapitalN]", "[", "gu_", "]"}]}], "}"}]}], "]"}], ",",
     "args_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"GaussianIntegral", "[", 
     RowBox[{"stuff", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "i"], ",", 
        SubscriptBox[
         OverscriptBox["x", "_"], "i"], ",", 
        SubscriptBox[
         RowBox[{"Var", "[", "x", "]"}], "i"]}], "}"}], ",", "args"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], "}"}], ",", 
    RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x_List", ",", "mean_List", ",", "var_List"}], "}"}]}], "]"}], ":=", 
   RowBox[{"RealSimplify", "[", 
    RowBox[{"Expectation", "[", 
     RowBox[{"func", ",", 
      RowBox[{"x", "\[Distributed]", 
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{"mean", ",", "var"}], "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x_Symbol", ",", "mean_", ",", "var_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"{", "mean", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var", "}"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_List", ",", "mean1_List", ",", "var1_List"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_List", ",", "mean2_List", ",", "var2_List"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"RealSimplify", "[", 
    RowBox[{
     RowBox[{"Expectation", "[", 
      RowBox[{
       RowBox[{"Expectation", "[", 
        RowBox[{"func", ",", 
         RowBox[{"x1", "\[Distributed]", 
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{"mean1", ",", "var1"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"x2", "\[Distributed]", 
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{"mean2", ",", "var2"}], "]"}]}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", ">=", "0"}], ")"}], "&"}], "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"var1", ",", "var2"}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", "mean1_", ",", "var1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "mean2_", ",", "var2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{"func", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x1", "}"}], ",", 
       RowBox[{"{", "mean1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var1", "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "x2", "}"}], ",", 
       RowBox[{"{", "mean2", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "var2", "}"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8574288014916058`*^9, 3.8574288016640377`*^9}, {
  3.857428852097266*^9, 3.857428852280386*^9}, {3.857432343722653*^9, 
  3.8574323466258163`*^9}, {3.8574807831079283`*^9, 3.857480784158065*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"ae9cbb88-6b6a-421b-af96-24713960e0a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "/", 
       RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"b90189ee-5b91-49a2-8eb2-da70cc558a5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]", ">=", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.857219988934943*^9, 3.85721999273597*^9}, 
   3.85743300185415*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"ceb2a796-8629-468b-8619-1b823d1ea7b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi\[Prime]", ",", "xj\[Prime]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xj\[Prime]", ",", "xj", ",", 
     RowBox[{"\[Sigma]j", "^", "2"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"9aba72ab-5a72-451f-a28b-d7f1db489ad6"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xi\[Prime]", "-", "xj"}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SuperscriptBox["\[Sigma]j", "2"]}], ")"}]}]]}]], " ", "\[Sigma]"}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SuperscriptBox["\[Sigma]j", "2"]}]]]], "Output",
 CellChangeTimes->{3.85748083187342*^9, 3.859906342201612*^9, 
  3.859906962304715*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"24d14699-1d03-4685-9c1a-8b7aa4a726b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi\[Prime]", ",", "xj\[Prime]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xj\[Prime]", ",", "xj", ",", 
     RowBox[{"\[Sigma]j", "^", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xi\[Prime]", ",", "xi", ",", 
     RowBox[{"\[Sigma]i", "^", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8574808638388243`*^9, 3.857480870506852*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"a155b74a-c7f1-4e49-91d0-54ed0acf19eb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xi", "-", "xj"}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SuperscriptBox["\[Sigma]i", "2"], "+", 
         SuperscriptBox["\[Sigma]j", "2"]}], ")"}]}]]}]], " ", "\[Sigma]"}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]", "2"], "+", 
    SuperscriptBox["\[Sigma]i", "2"], "+", 
    SuperscriptBox["\[Sigma]j", "2"]}]]]], "Output",
 CellChangeTimes->{3.857480873113614*^9, 3.859906412292416*^9, 
  3.8599069642007637`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"ea5ef367-13ed-4571-87b3-692c541535da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDF", "[", 
  RowBox[{"NormalDistribution", "[", 
   RowBox[{"xav", ",", "\[Sigma]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.859906745508676*^9, 3.8599067778463993`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"4fc5a719-ba16-4838-9dc6-3ed93419cfcc"],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"\[FormalX]", ",", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[FormalX]", "-", "xav"}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", "\[Sigma]"}]]}], "]"}]], "Output",
 CellChangeTimes->{{3.859906761843587*^9, 3.85990677869309*^9}, 
   3.859906964245761*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"34129009-4865-46ed-9d78-4ddce8d8dd48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussianIntegral", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "^", "2"}], " ", "+", " ", 
      RowBox[{"x", "^", "4"}], " ", "+", " ", 
      RowBox[{"x", "^", "6"}]}], ")"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", " ", "-", " ", "1"}], ")"}], "^", "2"}]}], "]"}]}], ",", 
   " ", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8599067432190027`*^9, 3.859906744115191*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"7f9fb8ed-09e0-424c-9d7f-8cc93da917fe"],

Cell[BoxData[
 FractionBox[
  RowBox[{"223", " ", 
   SqrtBox["\[Pi]"]}], "8"]], "Output",
 CellChangeTimes->{{3.859906392620363*^9, 3.859906415416254*^9}, 
   3.8599067864970207`*^9, 3.8599069658099318`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"657ca382-49c0-479c-8cf2-3bcba1f4f25a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sgI", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"gaussianIntegral", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "^", "2"}], " ", "+", " ", 
        RowBox[{"x", "^", "4"}], " ", "+", " ", 
        RowBox[{"x", "^", "6"}]}], ")"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", " ", "-", " ", "1"}], ")"}], "^", "2"}]}], "]"}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "xav"}], ")"}], "2"], 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Sigma]", "2"]}]]}]], 
       RowBox[{
        SqrtBox[
         RowBox[{"2", " ", "\[Pi]"}]], " ", "\[Sigma]"}]]}], ",", 
     RowBox[{"{", "x", "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8599064284882936`*^9, 3.859906439910347*^9}, {
  3.859906799161127*^9, 3.859906843940139*^9}, {3.859906900197164*^9, 
  3.859906901596034*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"111d358f-33b6-4eb5-8d69-0b7e77ac6c40"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SqrtBox[
     RowBox[{"2", "+", 
      FractionBox["1", 
       SuperscriptBox["\[Sigma]", "2"]]}]], " ", "\[Sigma]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]}], ")"}], "6"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "xav"}], ")"}], "2"], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]}]]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["xav", "6"], "+", 
     SuperscriptBox["\[Sigma]", "2"], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox["xav", "5"], " ", 
      SuperscriptBox["\[Sigma]", "2"]}], "+", 
     RowBox[{"17", " ", 
      SuperscriptBox["\[Sigma]", "4"]}], "+", 
     RowBox[{"135", " ", 
      SuperscriptBox["\[Sigma]", "6"]}], "+", 
     RowBox[{"678", " ", 
      SuperscriptBox["\[Sigma]", "8"]}], "+", 
     RowBox[{"1796", " ", 
      SuperscriptBox["\[Sigma]", "10"]}], "+", 
     RowBox[{"1784", " ", 
      SuperscriptBox["\[Sigma]", "12"]}], "+", 
     RowBox[{
      SuperscriptBox["xav", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"19", " ", 
         SuperscriptBox["\[Sigma]", "2"]}], "+", 
        RowBox[{"94", " ", 
         SuperscriptBox["\[Sigma]", "4"]}]}], ")"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["xav", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{"19", " ", 
         SuperscriptBox["\[Sigma]", "4"]}], "+", 
        RowBox[{"54", " ", 
         SuperscriptBox["\[Sigma]", "6"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["xav", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"14", " ", 
         SuperscriptBox["\[Sigma]", "2"]}], "+", 
        RowBox[{"129", " ", 
         SuperscriptBox["\[Sigma]", "4"]}], "+", 
        RowBox[{"740", " ", 
         SuperscriptBox["\[Sigma]", "6"]}], "+", 
        RowBox[{"1300", " ", 
         SuperscriptBox["\[Sigma]", "8"]}]}], ")"}]}], "+", 
     RowBox[{"4", " ", "xav", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{"14", " ", 
         SuperscriptBox["\[Sigma]", "4"]}], "+", 
        RowBox[{"113", " ", 
         SuperscriptBox["\[Sigma]", "6"]}], "+", 
        RowBox[{"436", " ", 
         SuperscriptBox["\[Sigma]", "8"]}], "+", 
        RowBox[{"564", " ", 
         SuperscriptBox["\[Sigma]", "10"]}]}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{
  3.859906429207534*^9, 3.8599064628378267`*^9, {3.859906807868631*^9, 
   3.859906844431126*^9}, {3.859906902775819*^9, 3.859906931543675*^9}, 
   3.859906969687551*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"a7917eee-711f-4778-8f35-06a6165db819"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sgI", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xav", "->", "1"}], ",", 
    RowBox[{"\[Sigma]", "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8599069033219137`*^9, 3.859906913957835*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"facb7990-5639-495c-8ca0-d387c822b27c"],

Cell[BoxData[
 FractionBox["146", 
  RowBox[{"9", " ", 
   SqrtBox["3"]}]]], "Output",
 CellChangeTimes->{3.859906914485627*^9, 3.859906973487526*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"14b6529b-6d38-48e9-9745-b299953a7ccc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sGI", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"GaussianIntegral", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "^", "2"}], " ", "+", " ", 
        RowBox[{"x", "^", "4"}], " ", "+", " ", 
        RowBox[{"x", "^", "6"}]}], ")"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", " ", "-", " ", "1"}], ")"}], "^", "2"}]}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "xav", ",", 
       RowBox[{"\[Sigma]", "^", "2"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.859906470517577*^9, 3.8599064804179792`*^9}, {
  3.859906860040119*^9, 3.859906885750064*^9}, {3.859906918828521*^9, 
  3.859906919833901*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"adc1f296-ee46-4626-b295-2b07f92eb5b5"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Sigma]", "2"]}]}], ")"}], 
    RowBox[{"13", "/", "2"}]]], 
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "xav"}], ")"}], "2"], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]}]]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["xav", "2"], "+", 
     SuperscriptBox["xav", "4"], "+", 
     SuperscriptBox["xav", "6"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"xav", " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", 
           RowBox[{"xav", " ", 
            RowBox[{"(", 
             RowBox[{"14", "+", 
              RowBox[{"xav", " ", 
               RowBox[{"(", 
                RowBox[{"8", "+", 
                 RowBox[{"xav", " ", 
                  RowBox[{"(", 
                   RowBox[{"19", "+", 
                    RowBox[{"12", " ", "xav"}]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox["\[Sigma]", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"17", "+", 
        RowBox[{"xav", " ", 
         RowBox[{"(", 
          RowBox[{"56", "+", 
           RowBox[{"xav", " ", 
            RowBox[{"(", 
             RowBox[{"129", "+", 
              RowBox[{"2", " ", "xav", " ", 
               RowBox[{"(", 
                RowBox[{"76", "+", 
                 RowBox[{"47", " ", "xav"}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], " ", 
      SuperscriptBox["\[Sigma]", "4"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"135", "+", 
        RowBox[{"4", " ", "xav", " ", 
         RowBox[{"(", 
          RowBox[{"113", "+", 
           RowBox[{"xav", " ", 
            RowBox[{"(", 
             RowBox[{"185", "+", 
              RowBox[{"108", " ", "xav"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox["\[Sigma]", "6"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"339", "+", 
        RowBox[{"872", " ", "xav"}], "+", 
        RowBox[{"650", " ", 
         SuperscriptBox["xav", "2"]}]}], ")"}], " ", 
      SuperscriptBox["\[Sigma]", "8"]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{"449", "+", 
        RowBox[{"564", " ", "xav"}]}], ")"}], " ", 
      SuperscriptBox["\[Sigma]", "10"]}], "+", 
     RowBox[{"1784", " ", 
      SuperscriptBox["\[Sigma]", "12"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8599064719532824`*^9, 3.859906506636176*^9}, {
   3.859906868008658*^9, 3.85990689079652*^9}, 3.859906923218275*^9, 
   3.859906979078586*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"e3a6dcf3-adbf-43a0-ab6f-df2c992336e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sGI", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xav", "->", "1"}], ",", 
    RowBox[{"\[Sigma]", "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{3.859906925263619*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"610b4554-fe55-4cc6-832b-a5a09b52fddd"],

Cell[BoxData[
 FractionBox["146", 
  RowBox[{"9", " ", 
   SqrtBox["3"]}]]], "Output",
 CellChangeTimes->{3.859906925930702*^9, 3.859906985719212*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"1135716c-5db7-4d3d-81bb-04b49e676f29"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sgM", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"gaussMoment", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"x", "^", "4"}], "+", 
       RowBox[{"x", "^", "6"}]}], ")"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "xav"}], ")"}], "^", "2"}]}], ",", 
     RowBox[{"{", "x", "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.859907223331149*^9, 3.8599073435099697`*^9}, {
  3.859907459101996*^9, 3.859907466375904*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"39c784ca-6c61-4f46-9d85-231363471a5c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  SqrtBox["\[Pi]"], " ", 
  RowBox[{"(", 
   RowBox[{"25", "+", 
    RowBox[{"122", " ", 
     SuperscriptBox["xav", "2"]}], "+", 
    RowBox[{"68", " ", 
     SuperscriptBox["xav", "4"]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["xav", "6"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.859907248983735*^9, 3.8599072800074472`*^9, {3.859907332049944*^9, 
   3.859907344043767*^9}, {3.8599074597622643`*^9, 3.859907466859653*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"7082f27c-2d36-4387-a0e5-c568eeddf686"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sgM", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xav", "->", "1"}], ",", 
    RowBox[{"\[Sigma]", "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.859907345259145*^9, 3.859907354586862*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"fe0a659d-e5a5-4ea6-8bec-bbe20c8b8156"],

Cell[BoxData[
 FractionBox[
  RowBox[{"223", " ", 
   SqrtBox["\[Pi]"]}], "8"]], "Output",
 CellChangeTimes->{
  3.8599073550714407`*^9, {3.859907460697901*^9, 3.859907467689034*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"4962f8b3-c7fc-445e-b23e-52401b9d1f0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussMoment", "[", 
  RowBox[{
   RowBox[{"Sqrt", "[", "x", "]"}], ",", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "xav"}], ")"}], "^", "2"}]}], ",", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.859907489142145*^9, 3.859907495395314*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"0bcfc480-eeaf-4b29-81a8-869a0a7e88ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     SqrtBox["xav"]}]], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["xav", "2"], "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Pi]", " ", 
       SuperscriptBox["xav", "2"], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], ",", 
         FractionBox[
          SuperscriptBox["xav", "2"], "2"]}], "]"}]}], "+", 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["xav", "2"]}], ")"}], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{
         FractionBox["1", "4"], ",", 
         FractionBox[
          SuperscriptBox["xav", "2"], "2"]}], "]"}]}], "+", 
      RowBox[{"\[Pi]", " ", 
       SuperscriptBox["xav", "2"], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{
         FractionBox["3", "4"], ",", 
         FractionBox[
          SuperscriptBox["xav", "2"], "2"]}], "]"}]}], "+", 
      RowBox[{"\[Pi]", " ", 
       SuperscriptBox["xav", "2"], " ", 
       RowBox[{"BesselI", "[", 
        RowBox[{
         FractionBox["5", "4"], ",", 
         FractionBox[
          SuperscriptBox["xav", "2"], "2"]}], "]"}]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         SuperscriptBox["xav", "2"], "2"]], " ", 
       SqrtBox["xav"], " ", 
       RowBox[{"Gamma", "[", 
        FractionBox["3", "4"], "]"}], " ", 
       RowBox[{"Hypergeometric1F1", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], ",", 
         FractionBox["1", "2"], ",", 
         RowBox[{"-", 
          SuperscriptBox["xav", "2"]}]}], "]"}]}], "-", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         SuperscriptBox["xav", "2"], "2"]], " ", 
       SuperscriptBox["xav", 
        RowBox[{"3", "/", "2"}]], " ", 
       RowBox[{"Gamma", "[", 
        FractionBox["5", "4"], "]"}], " ", 
       RowBox[{"Hypergeometric1F1", "[", 
        RowBox[{
         FractionBox["1", "4"], ",", 
         FractionBox["3", "2"], ",", 
         RowBox[{"-", 
          SuperscriptBox["xav", "2"]}]}], "]"}]}]}], ")"}]}]}], "-", 
  RowBox[{
   FractionBox["4", "3"], " ", 
   SuperscriptBox["xav", 
    RowBox[{"3", "/", "2"}]], " ", 
   RowBox[{"HypergeometricPFQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["5", "4"], ",", 
       FractionBox["7", "4"]}], "}"}], ",", 
     RowBox[{"-", 
      SuperscriptBox["xav", "2"]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.859907499843203*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"7d84f6e1-f987-4cc1-899c-0a8d1b2cb8b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussMoment", "[", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", "x"}], "]"}], ",", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "xav"}], ")"}], "^", "2"}]}], ",", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8599076704754953`*^9, 3.8599076705325336`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"8290ba41-426e-4706-ac09-54912b6004ff"],

Cell[BoxData[
 RowBox[{
  SqrtBox["\[Pi]"], " ", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    SqrtBox[
     RowBox[{"1", "-", "x"}]], ",", 
    RowBox[{
     RowBox[{"{", "x", "}"}], "\[Distributed]", 
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", "xav", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         FractionBox["1", "2"], "}"}], "}"}]}], "]"}]}]}], "]"}]}]], "Output",\

 CellChangeTimes->{3.8599076942145844`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"89e3f81e-4b5e-4436-90cd-ee618633655e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussianIntegral", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sqrt", "[", "x", "]"}], 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "xav"}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]]}]], 
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", "\[Sigma]"}]]}], ",", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8599070199713583`*^9, 3.859907036692728*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"35baa890-c96e-44ef-b2e6-445cd6cff8ed"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   RowBox[{"x", "+", "xav"}]], 
  RowBox[{
   SqrtBox[
    FractionBox["1", 
     SuperscriptBox["\[Sigma]", "2"]]], " ", "\[Sigma]"}]]], "Output",
 CellChangeTimes->{{3.8599070243438997`*^9, 3.8599070408069887`*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"e5044c4e-8fb4-4e7a-aa7b-f61fe9dc3fe3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"Sqrt", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "xav", ",", 
     RowBox[{"\[Sigma]", "^", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.859907064232683*^9, 3.859907068797557*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"d6eb67c4-26c5-4e64-9599-cfe3ad0dddce"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", "\[Sigma]"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", " ", 
       SqrtBox["xav"]}]], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["xav", "2"], 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Pi]", " ", 
         SuperscriptBox["xav", "2"], " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "4"]}], ",", 
           FractionBox[
            SuperscriptBox["xav", "2"], 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Sigma]", "2"]}]]}], "]"}]}], "+", 
        RowBox[{"\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["xav", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ")"}], " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{
           FractionBox["1", "4"], ",", 
           FractionBox[
            SuperscriptBox["xav", "2"], 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Sigma]", "2"]}]]}], "]"}]}], "+", 
        RowBox[{"\[Pi]", " ", 
         SuperscriptBox["xav", "2"], " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{
           FractionBox["3", "4"], ",", 
           FractionBox[
            SuperscriptBox["xav", "2"], 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Sigma]", "2"]}]]}], "]"}]}], "+", 
        RowBox[{"\[Pi]", " ", 
         SuperscriptBox["xav", "2"], " ", 
         RowBox[{"BesselI", "[", 
          RowBox[{
           FractionBox["5", "4"], ",", 
           FractionBox[
            SuperscriptBox["xav", "2"], 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Sigma]", "2"]}]]}], "]"}]}], "+", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", 
         SuperscriptBox["2", 
          RowBox[{"3", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           SuperscriptBox["xav", "2"], 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]]], " ", 
         SqrtBox["xav"], " ", 
         SuperscriptBox["\[Sigma]", 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"Gamma", "[", 
          FractionBox["3", "4"], "]"}], " ", 
         RowBox[{"Hypergeometric1F1", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "4"]}], ",", 
           FractionBox["1", "2"], ",", 
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox["xav", "2"], 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Sigma]", "2"]}]]}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "\[ImaginaryI]", " ", 
         SuperscriptBox["2", 
          RowBox[{"1", "/", "4"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           SuperscriptBox["xav", "2"], 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]]], " ", 
         SuperscriptBox["xav", 
          RowBox[{"3", "/", "2"}]], " ", 
         SqrtBox["\[Sigma]"], " ", 
         RowBox[{"Gamma", "[", 
          FractionBox["5", "4"], "]"}], " ", 
         RowBox[{"Hypergeometric1F1", "[", 
          RowBox[{
           FractionBox["1", "4"], ",", 
           FractionBox["3", "2"], ",", 
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox["xav", "2"], 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Sigma]", "2"]}]]}]}], "]"}]}]}], ")"}]}]}], 
    "-", 
    RowBox[{
     FractionBox["4", "3"], " ", 
     SuperscriptBox["xav", 
      RowBox[{"3", "/", "2"}]], " ", 
     RowBox[{"HypergeometricPFQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "2"], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["5", "4"], ",", 
         FractionBox["7", "4"]}], "}"}], ",", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["xav", "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.859907075151862*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"ae93e725-9349-403b-9f59-f288c3bd9271"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "x_", "]"}], ":=", 
   RowBox[{"x", "^", "2"}]}], ";"}]], "Input",
 CellLabel->
  "(Local 2) In[19]:=",ExpressionUUID->"b1da47d4-04fa-4427-b1b0-fc94438a36b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{"d", "[", "xi\[Prime]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xi\[Prime]", ",", "xi", ",", 
     RowBox[{"\[Sigma]i", "^", "2"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857480912180558*^9, 3.85748092044312*^9}},
 CellLabel->
  "(Local 2) In[20]:=",ExpressionUUID->"8912e85d-e524-4160-a1d3-3f4c7387864c"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["xi", "2"], "+", 
  SuperscriptBox["\[Sigma]i", "2"]}]], "Output",
 CellChangeTimes->{3.857480920763693*^9},
 CellLabel->
  "(Local 2) Out[20]=",ExpressionUUID->"19812d85-b43b-4328-b7e0-76dd83d35d06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegral", "[", 
  RowBox[{
   RowBox[{
    UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], "-", 
           SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"], " ", 
     SubscriptBox["x", "\[FormalI]"]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "\[FormalI]"], ",", 
     SubscriptBox[
      OverscriptBox["x", "_"], "\[FormalI]"], ",", 
     SubscriptBox[
      RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8574287793878803`*^9, 3.8574287865178127`*^9}},
 CellLabel->
  "(Local 2) In[21]:=",ExpressionUUID->"845512b2-ab41-4c49-b548-756d1fb9f934"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalI]"], "-", 
           SubscriptBox[
            OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], " ",
      "\[Sigma]", " ", 
     SubscriptBox["n", "\[FormalJ]"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         OverscriptBox["x", "_"], "\[FormalJ]"], " ", 
        SubscriptBox[
         RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "+", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["x", "_"], "\[FormalI]"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "2"], "+", 
          SubscriptBox[
           RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]}], 
      ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Sigma]", "2"], "+", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8574287975408363`*^9, 3.857428848120401*^9, 3.857428886593759*^9, {
   3.8574323332324743`*^9, 3.857432356548687*^9}, 3.8574329483858223`*^9, {
   3.8574330026750107`*^9, 3.857433007734715*^9}, 3.857480954126775*^9},
 CellLabel->
  "(Local 2) Out[21]=",ExpressionUUID->"adae10cf-e031-4bb3-ac46-ac0e313d0e19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{"d", "[", 
    SubscriptBox["x", "\[FormalI]"], "]"}], "+", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}]}], "]"}], 
    SubscriptBox["x", "\[FormalI]"]}]}]}]], "Input",
 CellLabel->
  "(Local 2) In[22]:=",ExpressionUUID->"ee33900b-7ab8-41a2-ac3c-fef45fa675b5"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["x", "\[FormalI]", "2"], "+", 
  RowBox[{
   SubscriptBox["x", "\[FormalI]"], " ", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
     RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], "-", 
           SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"]}]}]}]}]], "Output",
 CellChangeTimes->{3.857435476571947*^9, 3.857481008296775*^9},
 CellLabel->
  "(Local 2) Out[22]=",ExpressionUUID->"b229a221-3eb4-4854-93f0-e840297ad606"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Distribute", "[", 
  RowBox[{"GaussianIntegral", "[", 
   RowBox[{
    RowBox[{"tmp", "/.", "UnfactorSums"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "\[FormalI]"], ",", 
      SubscriptBox[
       OverscriptBox["x", "_"], "\[FormalI]"], ",", 
      SubscriptBox[
       RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857432418311838*^9, 3.857432418471435*^9}},
 CellLabel->
  "(Local 2) In[23]:=",ExpressionUUID->"134ee038-3360-4e35-bf06-2d85138c1b27"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.857432495859229*^9, 3.857435460058301*^9, 
  3.857435494910273*^9, 3.857481011682581*^9},
 CellLabel->
  "(Local 2) Out[23]=",ExpressionUUID->"adbdb48b-2c67-48c2-be1b-72018a51057d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "/.", "UnfactorSums"}]], "Input",
 CellLabel->
  "(Local 2) In[25]:=",ExpressionUUID->"77b84ff8-9df1-41e5-baa1-9817d58179a8"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["x", "\[FormalI]", "2"], "+", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
    RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "\[FormalI]"], "-", 
          SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
    SubscriptBox["n", "\[FormalJ]"], " ", 
    SubscriptBox["x", "\[FormalI]"]}]}]}]], "Output",
 CellChangeTimes->{3.857432505378378*^9, 3.857435496316792*^9, 
  3.857481072545987*^9},
 CellLabel->
  "(Local 2) Out[25]=",ExpressionUUID->"29b09ec2-078d-4338-96c1-6c0d88fb4e81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Distribute", "[", 
   RowBox[{"gaussianIntegral", "[", 
    RowBox[{
     RowBox[{"tmp", "/.", "UnfactorSums"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox[
        OverscriptBox["x", "_"], "\[FormalI]"], ",", 
       SubscriptBox[
        RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], 
   "]"}], "/.", 
  RowBox[{"gaussianIntegral", "->", "GaussianIntegral"}]}]], "Input",
 CellChangeTimes->{{3.857432553311236*^9, 3.8574325847018623`*^9}},
 CellLabel->
  "(Local 2) In[24]:=",ExpressionUUID->"d4a24464-b2fd-4b93-86d7-46ced8ebdd69"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox[
   OverscriptBox["x", "_"], "\[FormalI]", "2"], "+", 
  SubscriptBox[
   RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
  RowBox[{"Sum", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["x", "_"], "\[FormalI]"], "-", 
            SubscriptBox[
             OverscriptBox["x", "_"], "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "+", 
            SubscriptBox[
             RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
            SubscriptBox[
             RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], 
      " ", "\[Sigma]", " ", 
      SubscriptBox["n", "\[FormalJ]"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalJ]"], " ", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "+", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["x", "_"], "\[FormalI]"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]}], 
       ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        SubscriptBox[
         RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
        SubscriptBox[
         RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]], ",", 
    RowBox[{"{", 
     RowBox[{"\[FormalJ]", ",", 
      RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
    RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.857432554038672*^9, 3.857432588788053*^9, 
  3.857435500895547*^9, 3.857435596436123*^9, 3.85748104414713*^9},
 CellLabel->
  "(Local 2) Out[24]=",ExpressionUUID->"831cebd8-cd2a-4299-b275-10397279a3e1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "x_", "]"}], ":=", 
   RowBox[{"x", "^", "2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8574355979118967`*^9, 3.857435606246388*^9}},
 CellLabel->
  "(Local 2) In[23]:=",ExpressionUUID->"9148d86e-9a9e-4d88-b2b3-babe7181b513"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Distribute", "[", 
    RowBox[{"gaussianIntegral", "[", 
     RowBox[{
      RowBox[{"tmp", "/.", "UnfactorSums"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox[
         OverscriptBox["x", "_"], "\[FormalI]"], ",", 
        SubscriptBox[
         RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "}"}]}], "]"}], 
    "]"}], "/.", 
   RowBox[{"gaussianIntegral", "->", "GaussianIntegral"}]}], "/.", 
  RowBox[{
   RowBox[{"OverBar", "[", "var_", "]"}], "->", "var"}]}]], "Input",
 CellChangeTimes->{{3.857435625073906*^9, 3.857435633477145*^9}},
 CellLabel->
  "(Local 2) In[25]:=",ExpressionUUID->"2992a63c-e071-4764-b383-8a602b82052d"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["x", "\[FormalI]", "2"], "+", 
  SubscriptBox[
   RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
  RowBox[{"Sum", "[", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "\[FormalI]"], "-", 
            SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "+", 
            SubscriptBox[
             RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
            SubscriptBox[
             RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]]}]], 
      " ", "\[Sigma]", " ", 
      SubscriptBox["n", "\[FormalJ]"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "\[FormalJ]"], " ", 
         SubscriptBox[
          RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"]}], "+", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox[
            RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}]}]}], 
       ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        SubscriptBox[
         RowBox[{"Var", "[", "x", "]"}], "\[FormalI]"], "+", 
        SubscriptBox[
         RowBox[{"Var", "[", "x", "]"}], "\[FormalJ]"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]], ",", 
    RowBox[{"{", 
     RowBox[{"\[FormalJ]", ",", 
      RowBox[{"\[ScriptCapitalN]", "[", "n", "]"}]}], "}"}], ",", 
    RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]}]], "Output",\

 CellChangeTimes->{{3.85743561569886*^9, 3.857435637488592*^9}},
 CellLabel->
  "(Local 2) Out[25]=",ExpressionUUID->"67f391b2-518f-49f2-8cb6-3cc680ca141f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["from MSE", "Section",
 CellChangeTimes->{{3.859904489130254*^9, 
  3.8599044902632637`*^9}},ExpressionUUID->"21059e37-b3cd-46a4-b0ef-\
a91f81951802"],

Cell["\<\
<https://mathematica.stackexchange.com/questions/6845/how-to-deal-with-\
complicated-gaussian-integrals-in-mathematica>\
\>", "Text",
 CellChangeTimes->{{3.8599043309925537`*^9, 
  3.8599043316735067`*^9}},ExpressionUUID->"ff91e138-f5d2-498d-9b11-\
07f8ec70b9d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "AsymptoticIntegrate"}]], "Input",
 CellChangeTimes->{{3.839021553337118*^9, 3.839021561838971*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"57391481-107d-43a8-b290-c8ce7660e390"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/AsymptoticIntegrate",
              ButtonNote->"paclet:ref/AsymptoticIntegrate"],
             "\"paclet:ref/AsymptoticIntegrate\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"AsymptoticIntegrate\\\", \\\"[\
\\\", RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"x\\\", \
\\\"TI\\\"], \\\",\\\", RowBox[{StyleBox[\\\"x\\\", \\\"TI\\\"], \
\\\"\[Rule]\\\", SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"0\
\\\", \\\"TR\\\"]]}]}], \\\"]\\\"}]\\) computes an asymptotic approximation \
of the indefinite integral \\!\\(\\*RowBox[{\\\"\[Integral]\\\", \
RowBox[{RowBox[{\\\"f\\\", \\\"(\\\", \\\"x\\\", \\\")\\\"}], RowBox[{\\\"\
\[DifferentialD]\\\", \\\"x\\\"}]}]}]\\) for \\!\\(\\*StyleBox[\\\"x\\\", \
\\\"TI\\\"]\\) centered at \\!\\(\\*SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\
\"], StyleBox[\\\"0\\\", \
\\\"TR\\\"]]\\).\\n\\!\\(\\*RowBox[{\\\"AsymptoticIntegrate\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{StyleBox[\\\"x\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"a\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"b\\\", \\\"TI\\\"]}], \\\"}\\\"}], \\\",\
\\\", RowBox[{StyleBox[\\\"\[Alpha]\\\", \\\"TR\\\"], \\\"\[Rule]\\\", \
SubscriptBox[StyleBox[\\\"\[Alpha]\\\", \\\"TR\\\"], StyleBox[\\\"0\\\", \
\\\"TR\\\"]]}]}], \\\"]\\\"}]\\) computes an asymptotic approximation of the \
definite integral \\!\\(\\*RowBox[{SubsuperscriptBox[\\\"\[Integral]\\\", \
RowBox[{\\\"a\\\", \\\"(\\\", \\\"\[Alpha]\\\", \\\")\\\"}], \
RowBox[{\\\"b\\\", \\\"(\\\", \\\"\[Alpha]\\\", \\\")\\\"}]], \
RowBox[{RowBox[{\\\"f\\\", \\\"(\\\", RowBox[{\\\"x\\\", \\\",\\\", \\\"\
\[Alpha]\\\"}], \\\")\\\"}], RowBox[{\\\"\[DifferentialD]\\\", \
\\\"x\\\"}]}]}]\\) for \\!\\(\\*StyleBox[\\\"\[Alpha]\\\", \\\"TR\\\"]\\) \
centered at \\!\\(\\*SubscriptBox[StyleBox[\\\"\[Alpha]\\\", \\\"TR\\\"], \
StyleBox[\\\"0\\\", \
\\\"TR\\\"]]\\).\\n\\!\\(\\*RowBox[{\\\"AsymptoticIntegrate\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{StyleBox[\\\"\[Xi]\\\", \\\"TR\\\"], \\\",\\\", \
SubscriptBox[StyleBox[\\\"\[Xi]\\\", \\\"TR\\\"], StyleBox[\\\"0\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"]}], \\\"}\\\"}]}], \\\
\"]\\\"}]\\) computes the asymptotic approximation to order \
\\!\\(\\*StyleBox[\\\"n\\\", \\\"TI\\\"]\\). \"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", 
                    "paclet:ref/AsymptoticIntegrate", 
                    "paclet:ref/AsymptoticIntegrate", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"], "\"  \"", 
                    StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False], 
                    "\"  \"", 
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/\
AsymptoticIntegrate.html"], None}, 
                    "http://reference.wolfram.com/language/ref/\
AsymptoticIntegrate.html", "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", 
                    RowBox[{"Protected", ",", "ReadProtected"}], "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`AsymptoticIntegrate\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{16., {5., 11.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{16., {5., 11.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/AsymptoticIntegrate",
              ButtonNote->"paclet:ref/AsymptoticIntegrate"],
             "\"paclet:ref/AsymptoticIntegrate\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"AsymptoticIntegrate\\\", \\\"[\
\\\", RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"x\\\", \
\\\"TI\\\"], \\\",\\\", RowBox[{StyleBox[\\\"x\\\", \\\"TI\\\"], \
\\\"\[Rule]\\\", SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"0\
\\\", \\\"TR\\\"]]}]}], \\\"]\\\"}]\\) computes an asymptotic approximation \
of the indefinite integral \\!\\(\\*RowBox[{\\\"\[Integral]\\\", \
RowBox[{RowBox[{\\\"f\\\", \\\"(\\\", \\\"x\\\", \\\")\\\"}], RowBox[{\\\"\
\[DifferentialD]\\\", \\\"x\\\"}]}]}]\\) for \\!\\(\\*StyleBox[\\\"x\\\", \
\\\"TI\\\"]\\) centered at \\!\\(\\*SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\
\"], StyleBox[\\\"0\\\", \
\\\"TR\\\"]]\\).\\n\\!\\(\\*RowBox[{\\\"AsymptoticIntegrate\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{StyleBox[\\\"x\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"a\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"b\\\", \\\"TI\\\"]}], \\\"}\\\"}], \\\",\
\\\", RowBox[{StyleBox[\\\"\[Alpha]\\\", \\\"TR\\\"], \\\"\[Rule]\\\", \
SubscriptBox[StyleBox[\\\"\[Alpha]\\\", \\\"TR\\\"], StyleBox[\\\"0\\\", \
\\\"TR\\\"]]}]}], \\\"]\\\"}]\\) computes an asymptotic approximation of the \
definite integral \\!\\(\\*RowBox[{SubsuperscriptBox[\\\"\[Integral]\\\", \
RowBox[{\\\"a\\\", \\\"(\\\", \\\"\[Alpha]\\\", \\\")\\\"}], \
RowBox[{\\\"b\\\", \\\"(\\\", \\\"\[Alpha]\\\", \\\")\\\"}]], \
RowBox[{RowBox[{\\\"f\\\", \\\"(\\\", RowBox[{\\\"x\\\", \\\",\\\", \\\"\
\[Alpha]\\\"}], \\\")\\\"}], RowBox[{\\\"\[DifferentialD]\\\", \
\\\"x\\\"}]}]}]\\) for \\!\\(\\*StyleBox[\\\"\[Alpha]\\\", \\\"TR\\\"]\\) \
centered at \\!\\(\\*SubscriptBox[StyleBox[\\\"\[Alpha]\\\", \\\"TR\\\"], \
StyleBox[\\\"0\\\", \
\\\"TR\\\"]]\\).\\n\\!\\(\\*RowBox[{\\\"AsymptoticIntegrate\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{StyleBox[\\\"\[Xi]\\\", \\\"TR\\\"], \\\",\\\", \
SubscriptBox[StyleBox[\\\"\[Xi]\\\", \\\"TR\\\"], StyleBox[\\\"0\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"n\\\", \\\"TI\\\"]}], \\\"}\\\"}]}], \\\
\"]\\\"}]\\) computes the asymptotic approximation to order \
\\!\\(\\*StyleBox[\\\"n\\\", \\\"TI\\\"]\\). \"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {2., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{13., {2., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"AsymptoticIntegrate\", \"[\", RowBox[{StyleBox[\"f\", \
\"TI\"], \",\", StyleBox[\"x\", \"TI\"], \",\", RowBox[{StyleBox[\"x\", \
\"TI\"], \"\[Rule]\", SubscriptBox[StyleBox[\"x\", \"TI\"], StyleBox[\"0\", \
\"TR\"]]}]}], \"]\"}]\) computes an asymptotic approximation of the \
indefinite integral \!\(\*RowBox[{\"\[Integral]\", RowBox[{RowBox[{\"f\", \"(\
\", \"x\", \")\"}], RowBox[{\"\[DifferentialD]\", \"x\"}]}]}]\) for \
\!\(\*StyleBox[\"x\", \"TI\"]\) centered at \
\!\(\*SubscriptBox[StyleBox[\"x\", \"TI\"], StyleBox[\"0\", \"TR\"]]\).\n\!\(\
\*RowBox[{\"AsymptoticIntegrate\", \"[\", RowBox[{StyleBox[\"f\", \"TI\"], \
\",\", RowBox[{\"{\", RowBox[{StyleBox[\"x\", \"TI\"], \",\", StyleBox[\"a\", \
\"TI\"], \",\", StyleBox[\"b\", \"TI\"]}], \"}\"}], \",\", \
RowBox[{StyleBox[\"\[Alpha]\", \"TR\"], \"\[Rule]\", SubscriptBox[StyleBox[\"\
\[Alpha]\", \"TR\"], StyleBox[\"0\", \"TR\"]]}]}], \"]\"}]\) computes an \
asymptotic approximation of the definite integral \
\!\(\*RowBox[{SubsuperscriptBox[\"\[Integral]\", RowBox[{\"a\", \"(\", \"\
\[Alpha]\", \")\"}], RowBox[{\"b\", \"(\", \"\[Alpha]\", \")\"}]], \
RowBox[{RowBox[{\"f\", \"(\", RowBox[{\"x\", \",\", \"\[Alpha]\"}], \")\"}], \
RowBox[{\"\[DifferentialD]\", \"x\"}]}]}]\) for \!\(\*StyleBox[\"\[Alpha]\", \
\"TR\"]\) centered at \!\(\*SubscriptBox[StyleBox[\"\[Alpha]\", \"TR\"], \
StyleBox[\"0\", \"TR\"]]\).\n\!\(\*RowBox[{\"AsymptoticIntegrate\", \"[\", \
RowBox[{StyleBox[\"f\", \"TI\"], \",\", StyleBox[\"\[Ellipsis]\", \"TR\"], \
\",\", RowBox[{\"{\", RowBox[{StyleBox[\"\[Xi]\", \"TR\"], \",\", \
SubscriptBox[StyleBox[\"\[Xi]\", \"TR\"], StyleBox[\"0\", \"TR\"]], \",\", \
StyleBox[\"n\", \"TI\"]}], \"}\"}]}], \"]\"}]\) computes the asymptotic \
approximation to order \!\(\*StyleBox[\"n\", \"TI\"]\). ", 
    "Documentation" -> <|
     "Local" -> "paclet:ref/AsymptoticIntegrate", "Web" -> 
      "http://reference.wolfram.com/language/ref/AsymptoticIntegrate.html"|>, 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> None, 
    "SubValues" -> None, "DefaultValues" -> None, "NValues" -> None, 
    "FormatValues" -> None, "Options" -> None, 
    "Attributes" -> {Protected, ReadProtected}, "FullName" -> 
    "System`AsymptoticIntegrate"|>, False]]], "Output",
 CellChangeTimes->{3.8390215623498793`*^9},
 CellLabel->
  "Out[364]=",ExpressionUUID->"be960bef-284c-4a1e-b46b-4ad0b243cddd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "/", 
       RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[365]:=",ExpressionUUID->"72b2b114-2ef1-4a78-b9ce-edd7727a22ad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDF", "[", 
  RowBox[{"NormalDistribution", "[", 
   RowBox[{"x", ",", 
    RowBox[{"Sqrt", "[", "V", "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.839021727968927*^9, 3.839021736751328*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"584f949e-20aa-4d6e-9fff-9a7526689a44"],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"\[FormalX]", ",", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[FormalX]", "-", "x"}], ")"}], "2"], 
       RowBox[{"2", " ", "V"}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     SqrtBox["V"]}]]}], "]"}]], "Output",
 CellChangeTimes->{{3.839021730270829*^9, 3.839021737196164*^9}},
 CellLabel->
  "Out[367]=",ExpressionUUID->"c37f934c-0040-4aa2-8b3e-29c23587db9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticIntegrate", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[FormalX]", "-", "x"}], ")"}], "2"], 
       RowBox[{"2", " ", "V"}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     SqrtBox["V"]}]], ",", " ", 
   RowBox[{"{", 
    RowBox[{"\[FormalX]", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"V", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.839021663249907*^9, {3.839021741690587*^9, 3.839021829922995*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"fc78bac0-d315-4c93-81c4-4f7f36c95ea2"],

Cell[BoxData[
 RowBox[{"AsymptoticIntegrate", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[FormalX]", "-", "x"}], ")"}], "2"], 
       RowBox[{"2", " ", "V"}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     SqrtBox["V"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalX]", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"V", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8390217819400806`*^9, {3.839021826903575*^9, 3.839021850947357*^9}},
 CellLabel->
  "Out[370]=",ExpressionUUID->"4f0f4383-6ea3-4dcc-b6bb-6473a33a775c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussMoment", "[", 
   RowBox[{"fPre_", ",", "fExp_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coeff", ",", "dist", ",", "ai", ",", "\[Mu]", ",", "norm"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"coeff", "=", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{"fExp", ",", "vars", ",", 
        RowBox[{"\"\<Symmetric\>\"", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ai", "=", 
      RowBox[{"Inverse", "[", 
       RowBox[{"2", " ", 
        RowBox[{"coeff", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{"-", 
       RowBox[{"ai", ".", 
        RowBox[{"coeff", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dist", "=", 
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{"\[Mu]", ",", 
        RowBox[{"-", "ai"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"norm", "=", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"PDF", "[", 
         RowBox[{"dist", ",", "vars"}], "]"}]}], "/.", " ", 
       RowBox[{"Thread", "[", 
        RowBox[{"vars", "->", "\[Mu]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"norm", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{
           RowBox[{"coeff", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ".", "\[Mu]"}]}], "+", 
         RowBox[{"coeff", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
       RowBox[{"Distribute", "@", 
        RowBox[{"Expectation", "[", 
         RowBox[{"fPre", ",", 
          RowBox[{"vars", "\[Distributed]", "dist"}]}], "]"}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8390226464676437`*^9, 3.839022646473936*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"ec098952-806e-415d-93cb-91589a7cbd99"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussMoment", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"x1", ",", "x"}], "]"}], ",", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x1", "-", "x"}], ")"}], "2"], 
     RowBox[{"2", " ", "V"}]]}], ",", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.839022690140313*^9, 3.839022775453722*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"c5c9c8f4-f2e4-465c-82f8-bda597f3c6e5"],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]], " ", 
  SqrtBox["V"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox["1", 
     SqrtBox[
      FractionBox["V", 
       SuperscriptBox["\[Sigma]", "2"]]]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8390227383972397`*^9, 3.839022777236476*^9}},
 CellLabel->
  "Out[374]=",ExpressionUUID->"ea99c396-c04c-4cd4-a143-b03329fbf4d6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussianIntegral", "[", 
   RowBox[{"expr_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "coeff", ",", "exp", ",", "\[Mu]", ",", "a", ",", "b", ",", "c", ",", 
      "rul", ",", "factor", ",", "\[Sigma]", ",", "moment"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coeff", ",", "exp"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"expr", "/", 
           RowBox[{"Exp", "[", "#", "]"}]}], ",", "#"}], "}"}], "&"}], "[", 
       RowBox[{"Plus", "@@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"FactorList", "[", "expr", "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"E", "^", "x_"}], ",", "p_"}], "}"}], ":>", 
           RowBox[{"p", " ", "x"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{"exp", ",", "vars", ",", 
        RowBox[{"\"\<Symmetric\>\"", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{
       RowBox[{"LinearSolve", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rul", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"#", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"EvenQ", "@", 
            RowBox[{"Total", "@", 
             RowBox[{"First", "[", "x", "]"}]}]}]}]}], "]"}], "&"}], "@", 
       RowBox[{"CoefficientRules", "[", 
        RowBox[{
         RowBox[{"coeff", "/.", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"vars", "->", 
            RowBox[{"vars", "-", "\[Mu]"}]}], "]"}]}], ",", "vars"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rul", "==", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"factor", "=", 
      RowBox[{
       RowBox[{"\[Pi]", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "vars", "]"}], "/", "2"}], ")"}]}], " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"c", "-", 
          RowBox[{
           RowBox[{"\[Mu]", ".", "b"}], "/", "2"}]}], "]"}], "/", 
        RowBox[{"Sqrt", "@", 
         RowBox[{"Det", "[", 
          RowBox[{"-", "a"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"rul", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ".."}], "}"}], "->", "_"}], "}"}]}], "]"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"rul", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "factor"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Inverse", "[", "a", "]"}]}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"moment", "[", 
       RowBox[{"{", 
        RowBox[{"0", "..."}], "}"}], "]"}], "=", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"moment", "[", "x_List", "]"}], "/;", 
       RowBox[{
        RowBox[{"Total", "[", "x", "]"}], "==", "2"}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "==", "1"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "&"}], 
       "@", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"x", ",", 
          RowBox[{"y_", "?", "Positive"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"moment", "[", "x_List", "]"}], ":=", 
      RowBox[{
       RowBox[{"moment", "[", "x", "]"}], "=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "=", 
            RowBox[{
             RowBox[{"LengthWhile", "[", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"#", "==", "0"}], "&"}]}], "]"}], "+", "1"}]}], ",", 
           RowBox[{"x2", "=", "x"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "--"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ">", "0"}], ",", 
              RowBox[{
               RowBox[{"x2", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
               RowBox[{"moment", "@", 
                RowBox[{"MapAt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "-", "1"}], "&"}], ",", "x2", ",", "j"}], 
                 "]"}]}]}], ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "i", ",", 
              RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#2", " ", 
          RowBox[{"moment", "[", "#1", "]"}]}], "&"}], "@@@", "rul"}], "]"}], 
      " ", "factor"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.839022846949445*^9, 3.839022846951334*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"f1f97781-d8ff-4964-883a-618cc3c3a4af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussianIntegral", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "^", "2"}], " ", "+", " ", 
      RowBox[{"x", "^", "4"}], " ", "+", " ", 
      RowBox[{"x", "^", "6"}]}], ")"}], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", " ", "-", " ", "1"}], ")"}], "^", "2"}]}], "]"}]}], ",", 
   " ", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.839022853742684*^9, 3.839022853744244*^9}},
 CellLabel->
  "In[376]:=",ExpressionUUID->"5f27ccc6-8e38-4eb6-b7f8-2098f243f70d"],

Cell[BoxData[
 FractionBox[
  RowBox[{"223", " ", 
   SqrtBox["\[Pi]"]}], "8"]], "Output",
 CellChangeTimes->{3.83902285633919*^9},
 CellLabel->
  "Out[376]=",ExpressionUUID->"90465d08-0c1d-4528-aa89-b2dafdfa33e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussianIntegral", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"x1", ",", "x"}], "]"}], " ", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x"}], ")"}], "2"], 
        RowBox[{"2", " ", "V"}]]}]], 
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", 
      SqrtBox["V"]}]]}], ",", " ", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[381]:=",ExpressionUUID->"1da3b12f-e1ae-4462-8272-74e7b1536f69"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["x1", "2"], 
      RowBox[{"2", " ", "V"}]]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "x1", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["x1", "V"], "+", 
       FractionBox["x1", 
        SuperscriptBox["\[Sigma]", "2"]]}], ")"}]}], "-", 
    FractionBox[
     SuperscriptBox["x1", "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["\[Sigma]", "2"]}]]}]], 
  RowBox[{
   SqrtBox["2"], " ", 
   SqrtBox["V"], " ", 
   SqrtBox[
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", "V"}]], "+", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Sigma]", "2"]}]]}]]}]]], "Output",
 CellChangeTimes->{3.8390229629518137`*^9, 3.839023228885151*^9},
 CellLabel->
  "Out[381]=",ExpressionUUID->"7459c0af-7dca-4ed9-a887-5070cea60ffd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"gaussianIntegral", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x1", ",", "x"}], "]"}], " ", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x2", "-", "x"}], ")"}], "2"], 
         RowBox[{"2", " ", "V"}]]}]], 
      RowBox[{
       SqrtBox[
        RowBox[{"2", " ", "\[Pi]"}]], " ", 
       SqrtBox["V"]}]]}], ",", " ", 
    RowBox[{"{", "x", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.839022863265786*^9, 3.839022947942561*^9}, {
  3.839023009297765*^9, 3.8390230093838673`*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"3abb9dad-b555-4ea3-8a27-ed6c2ac266a8"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"V", "+", 
        SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox["V"], " ", 
   SqrtBox[
    RowBox[{
     FractionBox["1", "V"], "+", 
     FractionBox["1", 
      SuperscriptBox["\[Sigma]", "2"]]}]]}]]], "Output",
 CellChangeTimes->{{3.839022924868043*^9, 3.83902294876252*^9}, 
   3.839023010059658*^9, 3.839023233700198*^9},
 CellLabel->
  "Out[382]=",ExpressionUUID->"510e4942-7fbc-4660-b2a9-b20029d3ba1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"gaussianIntegral", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"E", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "x"}], ")"}]}], " ", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x2", "-", "x"}], ")"}], "2"], 
          RowBox[{"2", " ", "V"}]]}]], 
       RowBox[{
        SqrtBox[
         RowBox[{"2", " ", "\[Pi]"}]], " ", 
        SqrtBox["V"]}]]}], ",", " ", 
     RowBox[{"{", "x", "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"V", ">", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.839023238937661*^9, 3.839023252089727*^9}},
 CellLabel->
  "In[384]:=",ExpressionUUID->"2f32e0ca-6f5b-4a06-a523-d1b2284edbe3"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"V", "-", "x2"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.8390232439327908`*^9, 3.839023252580997*^9}},
 CellLabel->
  "Out[384]=",ExpressionUUID->"edd2c3f6-155a-45e9-a8b0-1e873e12c2cf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["great expectations (Sum Procedural)", "Section",
 CellChangeTimes->{{3.8599046181244698`*^9, 
  3.8599046250156193`*^9}},ExpressionUUID->"d0a45264-4a8c-4b74-8d9f-\
1a230b4ecdd6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
      SubscriptBox["n", "\[FormalJ]"], 
      SubscriptBox["n", "\[FormalI]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
     RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["xav", "\[FormalI]"], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        SubscriptBox["var", "\[FormalI]"], "}"}], "}"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"1b9139c4-bcd0-4069-af4b-544c71223521"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], " ", 
      SubscriptBox["n", "\[FormalI]"], " ", 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["xav", "\[FormalI]"], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        SubscriptBox["var", "\[FormalI]"], "}"}], "}"}]}], "]"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.857232278549265*^9, 3.857232544155415*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"19b2ae1b-98cc-45cf-b151-92a060be8aa6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
      SubscriptBox["n", "\[FormalJ]"], 
      SubscriptBox["n", "\[FormalI]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
     RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      RowBox[{"Sqrt", "[", 
       SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.857232285469157*^9, 3.857232300324108*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"bb899152-6557-418c-ab74-4016026b16aa"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        SubscriptBox["x", "\[FormalI]"], ",", 
        SubscriptBox["x", "\[FormalJ]"]}], "]"}], " ", 
      SubscriptBox["n", "\[FormalI]"], " ", 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      SqrtBox[
       SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.857232346730485*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"db80e88d-8c35-4410-b841-be4869633fb2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      RowBox[{"Sqrt", "[", 
       SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.857232285469157*^9, 3.857232300324108*^9}, {
  3.857232517417589*^9, 3.8572325253760567`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b030586e-b8ab-4640-96d7-d1ba2480a558"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["n", "\[FormalI]"], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], " ", 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      SqrtBox[
       SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.857232973826989*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"ef78b153-7454-4b26-84fe-ae47634f7c5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", "3"}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      RowBox[{"Sqrt", "[", 
       SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.857232285469157*^9, 3.857232300324108*^9}, {
   3.857232517417589*^9, 3.8572325253760567`*^9}, 3.85723360832782*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"ff4d1d51-d7de-4ebd-a1c0-6c600c9e2500"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "1"]}], "]"}], " ", 
       SubscriptBox["n", "1"]}], "+", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "2"]}], "]"}], " ", 
       SubscriptBox["n", "2"]}], "+", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "3"]}], "]"}], " ", 
       SubscriptBox["n", "3"]}]}], ")"}], " ", 
    SubscriptBox["n", "\[FormalI]"]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      SqrtBox[
       SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.857233609840687*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"24d4f7f1-112b-41c5-87fa-954634df989d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "/", 
       RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"76c4fa5c-6fca-4c4c-afb2-87621d7ac103"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", "3"}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      RowBox[{"Sqrt", "[", 
       SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.857232285469157*^9, 3.857232300324108*^9}, {
   3.857232517417589*^9, 3.8572325253760567`*^9}, 3.85723360832782*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"c7139be1-9917-4782-8878-26e495f44686"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "1"], "-", 
            SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "+", 
            SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
      SubscriptBox["n", "1"]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "2"], "-", 
            SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "+", 
            SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
      SubscriptBox["n", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "3"], "-", 
            SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "+", 
            SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
      SubscriptBox["n", "3"]}]}], ")"}], " ", 
   SubscriptBox["n", "\[FormalI]"]}], 
  SqrtBox[
   RowBox[{"1", "+", 
    FractionBox[
     SubscriptBox["var", "\[FormalI]"], 
     SuperscriptBox["\[Sigma]", "2"]]}]]]], "Output",
 CellChangeTimes->{3.8572336375825644`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"6857c9cb-3c8c-4406-946a-221661483893"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      RowBox[{"Sqrt", "[", 
       SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.857232285469157*^9, 3.857232300324108*^9}, {
  3.857232517417589*^9, 3.8572325253760567`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"f2b0c5ba-93cb-43b9-ac13-d414864c2565"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["n", "\[FormalI]"], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "\[FormalI]"], "-", 
             SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      SqrtBox[
       SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.8572338182483063`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"6b06fdf0-a2b1-4549-8597-8a25e5413858"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}]}], "]"}], 
    SubscriptBox["n", "\[FormalI]"]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      RowBox[{"Sqrt", "[", 
       SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.857232285469157*^9, 3.857232300324108*^9}, {
   3.857232517417589*^9, 3.8572325253760567`*^9}, 3.8572338264904346`*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"26b395a3-6cbf-4dc6-b29a-a7516658fe0c"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["n", "\[FormalI]"], " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
      SubscriptBox["\[ScriptCapitalN]", "n"]], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "\[FormalI]"], "-", 
            SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
      SubscriptBox["n", "\[FormalJ]"]}]}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      SqrtBox[
       SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.85723401264639*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"b0c41c7b-1faa-4d9b-8dc6-1bbe31ef00fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         SubscriptBox["xav", "\[FormalI]"], ",", 
         RowBox[{"Sqrt", "[", 
          SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[FormalJ]", ",", 
      SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}]}], "]"}], 
  SubscriptBox["n", "\[FormalI]"]}]], "Input",
 CellChangeTimes->{{3.857232285469157*^9, 3.857232300324108*^9}, {
   3.857232517417589*^9, 3.8572325253760567`*^9}, 3.8572338264904346`*^9, {
   3.857234129794085*^9, 3.8572341527626743`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"ad243b3c-a4a2-4e75-b1c6-39a879f79df0"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["n", "\[FormalI]"], " ", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
    SubscriptBox["\[ScriptCapitalN]", "n"]], 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalJ]"], "-", 
           SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{"1", "+", 
      FractionBox[
       SubscriptBox["var", "\[FormalI]"], 
       SuperscriptBox["\[Sigma]", "2"]]}]]]}]}]], "Output",
 CellChangeTimes->{3.857234156117425*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"43c0b20f-d811-4c14-b093-e554a1419959"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"i", " ", "x"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "ni"}], "}"}], ",", 
   RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857239283499741*^9, 3.857239342882292*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"b19c5d44-a14e-4246-821b-02b569e860c3"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"i", " ", "x"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "ni"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8572392981252737`*^9, 3.857239343270399*^9}},
 CellLabel->"Out[72]=",ExpressionUUID->"0ee35e82-9a27-4236-80c4-9a16227a0f57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "ni"}], "}"}], ",", 
     RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], "x"}], "/.", 
  RowBox[{
   RowBox[{"pre_.", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{"func_", ",", "range_", ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"pre", " ", "func"}], ",", "range", ",", 
     RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.857239347722041*^9, 3.857239348602682*^9}, {
  3.857239531095097*^9, 3.857239599353998*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"1f1b7f6e-9439-45bd-b80b-d036c90a1537"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"i", " ", "x"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "ni"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.8572393490581703`*^9, 3.857239603618758*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"c8245a83-4230-4875-835a-2add5520d487"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          SubscriptBox["x", "\[FormalI]"], ",", 
          SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
        SubscriptBox["n", "\[FormalJ]"]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[FormalJ]", ",", 
         SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}]}], "]"}], 
     SubscriptBox["n", "\[FormalI]"]}], ",", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       SubscriptBox["xav", "\[FormalI]"], ",", 
       RowBox[{"Sqrt", "[", 
        SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"Expectation", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{"func_", ",", "range_"}], "]"}], ",", "dist_"}], "]"}], "->", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Expectation", "[", 
      RowBox[{"func", ",", "dist"}], "]"}], ",", "range"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8572346717411747`*^9, 3.8572347490262423`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"7ed3251c-181a-4b82-875e-5b5298c24232"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.857234764598465*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"45e62ff6-9fd0-406c-8677-267d27e2284a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       SubscriptBox["xav", "\[FormalI]"], ",", 
       RowBox[{"Sqrt", "[", 
        SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"Expectation", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{"func_", ",", "range_"}], "]"}], ",", "dist_"}], "]"}], ":>", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Expectation", "[", 
      RowBox[{"func", ",", "dist"}], "]"}], ",", "range"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8572346717411747`*^9, 3.857234771111627*^9}, {
  3.8572348294954357`*^9, 3.857234869390933*^9}, {3.857238280455937*^9, 
  3.857238280670395*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"389896b4-b66d-4b73-b603-04c1e4d6c53c"],

Cell[BoxData[
 RowBox[{
  UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
   SubscriptBox["\[ScriptCapitalN]", "n"]], 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox["x", "\[FormalJ]"]}], "]"}], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], ",", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       SubscriptBox["xav", "\[FormalI]"], ",", 
       SqrtBox[
        SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.8572347858760223`*^9, {3.857234841059896*^9, 3.857234870324332*^9}, 
   3.857238347295205*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"d3391952-48bc-4997-a453-75e195f0c553"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "/", 
       RowBox[{"\[Sigma]", "^", "2"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"f16ccbfa-9fbd-4d12-97c8-2c69a93512da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.58", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{
       SubscriptBox["x", "\[FormalI]"], ",", 
       SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
     SubscriptBox["n", "\[FormalJ]"]}], ",", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       SubscriptBox["xav", "\[FormalI]"], ",", 
       RowBox[{"Sqrt", "[", 
        SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8572416143393593`*^9, 
  3.857241647850745*^9}},ExpressionUUID->"1968cdd8-5e6a-4b89-8657-\
8da20adaf73d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "\[FormalJ]"], "-", 
         SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]", "2"], "+", 
         SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
   SubscriptBox["n", "\[FormalJ]"]}], 
  SqrtBox[
   RowBox[{"1", "+", 
    FractionBox[
     SubscriptBox["var", "\[FormalI]"], 
     SuperscriptBox["\[Sigma]", "2"]]}]]]], "Output",
 CellChangeTimes->{3.857241637718437*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"75458bd9-31c4-4f68-856e-fdb9711df49a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"165", "s"}], " ", "-", " ", "fails"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[FormalJ]", ",", 
        SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       SubscriptBox["xav", "\[FormalI]"], ",", 
       RowBox[{"Sqrt", "[", 
        SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.857241591842492*^9, 
  3.857241598539816*^9}},ExpressionUUID->"992a12e3-da62-4f8f-b986-\
f42a5fb09b75"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "\[FormalI]"], "-", 
            SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[FormalJ]", ",", 
       SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      SubscriptBox["xav", "\[FormalI]"], ",", 
      SqrtBox[
       SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.857241585611717*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"8104a9f1-fe41-4703-89da-2d0fef93e639"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"185", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Expectation", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          SubscriptBox["x", "\[FormalI]"], ",", 
          SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
        SubscriptBox["n", "\[FormalJ]"]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[FormalJ]", ",", 
         SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        SubscriptBox["xav", "\[FormalI]"], ",", 
        RowBox[{"Sqrt", "[", 
         SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
      "dist_"}], "]"}], ":>", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Expectation", "[", 
       RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8572346717411747`*^9, 3.857234771111627*^9}, {
  3.8572348294954357`*^9, 3.857234869390933*^9}, {3.857238280455937*^9, 
  3.857238280670395*^9}, {3.857239822926581*^9, 3.857239836146326*^9}, {
  3.857240046489875*^9, 3.8572400504436207`*^9}, {3.857240400968306*^9, 
  3.857240410182555*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"4693c279-c9f9-4db7-88cc-f08b807b10f8"],

Cell[BoxData[
 RowBox[{
  UnderoverscriptBox["\[Sum]", "\[FormalJ]", 
   SubscriptBox["\[ScriptCapitalN]", "n"]], 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["x", "\[FormalJ]"], "-", 
          SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "2"], "+", 
          SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
    SubscriptBox["n", "\[FormalJ]"]}], 
   SqrtBox[
    RowBox[{"1", "+", 
     FractionBox[
      SubscriptBox["var", "\[FormalI]"], 
      SuperscriptBox["\[Sigma]", "2"]]}]]]}]], "Output",
 CellChangeTimes->{3.857238558145273*^9, 3.857240022588176*^9, 
  3.857240596471727*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"1b542c6a-e8b3-4d24-b1b3-a259e717e724"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"166", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Expectation", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          SubscriptBox["x", "\[FormalI]"], ",", 
          SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
        SubscriptBox["n", "\[FormalJ]"]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[FormalJ]", ",", 
         SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        SubscriptBox["xav", "\[FormalI]"], ",", 
        RowBox[{"Sqrt", "[", 
         SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
      "dist_"}], "]"}], ":>", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Expectation", "[", 
       RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8572346717411747`*^9, 3.857234771111627*^9}, {
   3.8572348294954357`*^9, 3.857234869390933*^9}, {3.857238280455937*^9, 
   3.857238280670395*^9}, {3.857238721018652*^9, 3.85723874373428*^9}, {
   3.8572400600696907`*^9, 3.8572400676893272`*^9}, 3.857240447520134*^9, {
   3.857240798361938*^9, 3.857240798578898*^9}, {3.857241214570827*^9, 
   3.857241246850822*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7683fc8c-1db8-441c-b0bf-7b8c9f2e72f1"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalJ]"], "-", 
           SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{"1", "+", 
      FractionBox[
       SubscriptBox["var", "\[FormalI]"], 
       SuperscriptBox["\[Sigma]", "2"]]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.857238910712974*^9, 3.857240394241538*^9, 3.857240792535043*^9, {
   3.857241222159361*^9, 3.857241231812664*^9}, 3.857241413299066*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"34ce97a6-df41-4bc0-8f90-3419e53bc32d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.53", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         SubscriptBox["x", "\[FormalI]"], ",", 
         SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
       SubscriptBox["n", "\[FormalJ]"]}], ",", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         SubscriptBox["xav", "\[FormalI]"], ",", 
         RowBox[{"Sqrt", "[", 
          SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[FormalJ]", ",", 
      SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
    RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.857239031242639*^9, 3.8572390396443043`*^9}, {
  3.8572408082563343`*^9, 3.857240810850124*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"401dc140-18aa-4dd2-9c9a-bde48c92fdc9"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalJ]"], "-", 
           SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{"1", "+", 
      FractionBox[
       SubscriptBox["var", "\[FormalI]"], 
       SuperscriptBox["\[Sigma]", "2"]]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.85723904073536*^9, {3.8572408048256903`*^9, 3.857240812436924*^9}},
 CellLabel->"Out[82]=",ExpressionUUID->"f9c72af4-69a9-4669-a4c7-7921d57755ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.02", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"expectation", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          SubscriptBox["x", "\[FormalI]"], ",", 
          SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
        SubscriptBox["n", "\[FormalJ]"]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[FormalJ]", ",", 
         SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        SubscriptBox["xav", "\[FormalI]"], ",", 
        RowBox[{"Sqrt", "[", 
         SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
      "dist_"}], "]"}], ":>", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"expectation", "[", 
       RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8572346717411747`*^9, 3.857234771111627*^9}, {
  3.8572348294954357`*^9, 3.857234869390933*^9}, {3.857238280455937*^9, 
  3.857238280670395*^9}, {3.857238721018652*^9, 3.85723874373428*^9}, {
  3.857239060145864*^9, 3.857239065299283*^9}, {3.857241067673149*^9, 
  3.8572410727348747`*^9}, {3.857241156995429*^9, 3.8572411616740093`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"805b24ef-d036-4891-9376-3c54663f6520"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"expectation", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "\[FormalI]"], "-", 
            SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        SubscriptBox["xav", "\[FormalI]"], ",", 
        SqrtBox[
         SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8572390671524763`*^9, 3.8572410733568563`*^9, {3.8572411543876677`*^9, 
   3.8572411621624002`*^9}},
 CellLabel->"Out[92]=",ExpressionUUID->"4eb4bf5e-df53-494a-949c-344382505223"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.62", "s"}], " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], ",", 
           SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
         SubscriptBox["n", "\[FormalJ]"]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[FormalJ]", ",", 
          SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         SubscriptBox["xav", "\[FormalI]"], ",", 
         RowBox[{"Sqrt", "[", 
          SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], "/.", 
    
    RowBox[{
     RowBox[{"expectation", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
       "dist_"}], "]"}], ":>", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"expectation", "[", 
        RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
      "]"}]}]}], "/.", 
   RowBox[{"expectation", "->", "Expectation"}]}]}]], "Input",
 CellChangeTimes->{{3.8572390783865623`*^9, 3.857239083506834*^9}, {
  3.857241095345172*^9, 3.857241103596588*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"908f5043-bfd1-4e28-aeeb-5efae5f68ec5"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalJ]"], "-", 
           SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{"1", "+", 
      FractionBox[
       SubscriptBox["var", "\[FormalI]"], 
       SuperscriptBox["\[Sigma]", "2"]]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.857239084377681*^9, {3.857241096525812*^9, 3.8572411051355143`*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"da2da491-7f8d-4afb-87e9-511751218ed0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["stackexchange \tq", "Section",
 CellChangeTimes->{{3.8572417885211267`*^9, 
  3.8572417948746157`*^9}},ExpressionUUID->"f992fd5b-4436-408f-ad5f-\
21679ddd77e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "/", 
       RowBox[{"\[Sigma]a", "^", "2"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.857242189090331*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"f4cc0a8b-1ef8-4a2f-b24b-475cc36d29ff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.62", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{
      RowBox[{"x", "[", "i", "]"}], ",", 
      RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       RowBox[{"xav", "[", "i", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8572416143393593`*^9, 3.857241647850745*^9}, {
  3.857241875426619*^9, 3.85724191907397*^9}, {3.8572419771163063`*^9, 
  3.857242011320888*^9}, {3.85724207723978*^9, 3.857242098507373*^9}, {
  3.857242195132869*^9, 3.857242195436059*^9}, {3.8573014761219053`*^9, 
  3.8573014796064587`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"e69625a2-53e9-4efa-91dd-aea8e52c9d76"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "[", "j", "]"}], "-", 
        RowBox[{"xav", "[", "i", "]"}]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]a", "2"], "+", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["\[Sigma]a", "2"]], "+", 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]]}]], " ", 
   RowBox[{"\[Sigma]", "[", "i", "]"}]}]]], "Output",
 CellChangeTimes->{
  3.857241637718437*^9, 3.857241903249288*^9, {3.857241992353787*^9, 
   3.857242012170135*^9}, {3.857242079063884*^9, 3.857242107014131*^9}, 
   3.857242196722062*^9, 3.857252723747724*^9, 3.857301486620689*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"47a51776-4dc0-4b46-997b-7542daeea3a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"165", "s"}], " ", "-", " ", "fails"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "n"}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       RowBox[{"xav", "[", "i", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.857241591842492*^9, 3.857241598539816*^9}, {
  3.8572419589594097`*^9, 3.857241961124716*^9}, {3.857242021605732*^9, 
  3.857242023590358*^9}, {3.8572420565160418`*^9, 3.8572420938067417`*^9}, {
  3.857242208318821*^9, 3.857242208670972*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"afd9f0b9-47e5-4c6f-af45-ea98954df86a"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "-", 
           RowBox[{"x", "[", "j", "]"}]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]a", "2"]}]]}]], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "n"}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      RowBox[{"xav", "[", "i", "]"}], ",", 
      RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.857241585611717*^9, 3.857242103422418*^9, 
  3.8572421907064342`*^9, 3.857242379763286*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"77a1a3fd-4649-4c43-85ac-ef46a1bce82c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.5", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"xav", "[", "i", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "n"}], "}"}], ",", 
    RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.857239031242639*^9, 3.8572390396443043`*^9}, {
   3.8572408082563343`*^9, 3.857240810850124*^9}, {3.857242157315089*^9, 
   3.857242186546537*^9}, 3.857242616920912*^9, {3.857242736664966*^9, 
   3.857242738784004*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"7856fdcd-9455-408b-a732-9dc6900008fd"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "[", "j", "]"}], "-", 
          RowBox[{"xav", "[", "i", "]"}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]a", "2"], "+", 
          SuperscriptBox[
           RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]}], ")"}]}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["\[Sigma]a", "2"]], "+", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]]}]], " ", 
     RowBox[{"\[Sigma]", "[", "i", "]"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "n"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.85723904073536*^9, {3.8572408048256903`*^9, 3.857240812436924*^9}, 
   3.857242612807315*^9, {3.8572427844477377`*^9, 3.857242791185286*^9}, 
   3.85725273000179*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"076c60c1-0f0b-4bc9-920e-bbd1236e3658"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"166", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Expectation", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], ",", 
         RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"xav", "[", "i", "]"}], ",", 
        RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
      "dist_"}], "]"}], ":>", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Expectation", "[", 
       RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8572346717411747`*^9, 3.857234771111627*^9}, {
   3.8572348294954357`*^9, 3.857234869390933*^9}, {3.857238280455937*^9, 
   3.857238280670395*^9}, {3.857239822926581*^9, 3.857239836146326*^9}, {
   3.857240046489875*^9, 3.8572400504436207`*^9}, {3.857240400968306*^9, 
   3.857240410182555*^9}, 3.8572421380691442`*^9, {3.857242599776842*^9, 
   3.85724259993519*^9}, {3.857242812788457*^9, 3.8572428129984713`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"5db62e8e-d654-4180-af3d-85450e315f77"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "[", "j", "]"}], "-", 
          RowBox[{"xav", "[", "i", "]"}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]a", "2"], "+", 
          SuperscriptBox["\[Sigma]i", "2"]}], ")"}]}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["\[Sigma]a", "2"]], "+", 
       FractionBox["1", 
        SuperscriptBox["\[Sigma]i", "2"]]}]], " ", "\[Sigma]i"}]], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "n"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.857238558145273*^9, 3.857240022588176*^9, 
  3.857240596471727*^9, 3.857242585955844*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"07ea4484-31b5-4777-8e5f-9899981be6f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Bob", " ", "Hanlon"}], " ", "\[Dash]", " ", 
    RowBox[{
     RowBox[{"8.23", "s"}], " ", "-", " ", 
     RowBox[{"but", " ", "not", " ", 
      RowBox[{"right", "?", "!"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Sigma]a", ">", "0"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{"n", ",", "PositiveIntegers"}], "]"}]}], "}"}], ",", 
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"xav", "[", "i", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.857252734622761*^9, 3.857252773638918*^9}, {
  3.857254695168652*^9, 3.857254698158345*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"b2b6dd47-4f74-4aee-99a0-186143bb0a94"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", "j", "]"}], "-", 
         RowBox[{"xav", "[", "i", "]"}]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]a", "2"], "+", 
         SuperscriptBox[
          RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]}], ")"}]}]]}]], " ", "n", 
   " ", "\[Sigma]a"}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]a", "2"], "+", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]}]]]], "Output",
 CellChangeTimes->{{3.8572527668160067`*^9, 3.857252783509426*^9}, 
   3.857254707489386*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"56025d7c-d64a-4ee5-a20c-503bbff835d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"fails", " ", "after", " ", "500", "s"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Sigma]a", ">", "0"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{"n", ",", "PositiveIntegers"}], "]"}]}], "}"}], ",", 
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"xav", "[", "i", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.857252734622761*^9, 3.857252787064453*^9}, {
  3.857253299320261*^9, 
  3.857253308242631*^9}},ExpressionUUID->"157b8845-a872-49bc-b185-\
33a9241ee18d"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "-", 
           RowBox[{"x", "[", "j", "]"}]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]a", "2"]}]]}]], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "n"}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      RowBox[{"xav", "[", "i", "]"}], ",", 
      RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.857253284622802*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"0f7a5de0-632d-4f10-8a9c-a360065c5812"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sum", "/:", 
   RowBox[{"Expectation", "[", 
    RowBox[{
     RowBox[{"sum", "[", 
      RowBox[{"a_", ",", "b__"}], "]"}], ",", "c___"}], "]"}], ":=", 
   RowBox[{"sum", "[", 
    RowBox[{
     RowBox[{"Expectation", "[", 
      RowBox[{"a", ",", "c"}], "]"}], ",", "b"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"sum", "->", "Sum"}], "]"}], "@", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Sum", "=", "sum"}], "}"}], ",", 
     RowBox[{"Expectation", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}], ",", 
         RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{
          RowBox[{"xav", "[", "i", "]"}], ",", 
          RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
  "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.85730094684896*^9, 3.8573009468522377`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"404894a6-8dc6-4773-94f7-c05540f8aead"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.38642`", ",", 
   RowBox[{"Sum", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", "j", "]"}], "-", 
            RowBox[{"xav", "[", "i", "]"}]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Sigma]a", "2"], "+", 
            SuperscriptBox[
             RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]}], ")"}]}]]}]], 
      RowBox[{
       SqrtBox[
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["\[Sigma]a", "2"]], "+", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]]}]], " ", 
       RowBox[{"\[Sigma]", "[", "i", "]"}]}]], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "n"}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.857300952470191*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"f0abaa90-0f1e-43b1-81f3-e4e18e12845d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.35", "s"}], " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "i", "]"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"xav", "[", "i", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "i", "]"}]}], "]"}]}]}], "]"}], "/.", 
    RowBox[{
     RowBox[{"expectation", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
       "dist_"}], "]"}], ":>", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"expectation", "[", 
        RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
      "]"}]}]}], "/.", 
   RowBox[{"expectation", "->", "Expectation"}]}]}]], "Input",
 CellChangeTimes->{{3.8572390783865623`*^9, 3.857239083506834*^9}, {
  3.857241095345172*^9, 3.857241103596588*^9}, {3.857254571680197*^9, 
  3.857254579646673*^9}, {3.8572547782117443`*^9, 
  3.857254778278821*^9}},ExpressionUUID->"faf6560a-a3ef-44a5-967e-\
9a86abce4a21"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "[", "j", "]"}], "-", 
          RowBox[{"xav", "[", "i", "]"}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]a", "2"], "+", 
          SuperscriptBox[
           RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]}], ")"}]}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["\[Sigma]a", "2"]], "+", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "i", "]"}], "2"]]}]], " ", 
     RowBox[{"\[Sigma]", "[", "i", "]"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "n"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.85725458210674*^9, 3.857254774962419*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"52edb2c7-10d8-4287-9b49-8395d64cb23a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.02", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"expectation", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          SubscriptBox["x", "\[FormalI]"], ",", 
          SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
        SubscriptBox["n", "\[FormalJ]"]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[FormalJ]", ",", 
         SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        SubscriptBox["xav", "\[FormalI]"], ",", 
        RowBox[{"Sqrt", "[", 
         SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
      "dist_"}], "]"}], ":>", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"expectation", "[", 
       RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8572346717411747`*^9, 3.857234771111627*^9}, {
  3.8572348294954357`*^9, 3.857234869390933*^9}, {3.857238280455937*^9, 
  3.857238280670395*^9}, {3.857238721018652*^9, 3.85723874373428*^9}, {
  3.857239060145864*^9, 3.857239065299283*^9}, {3.857241067673149*^9, 
  3.8572410727348747`*^9}, {3.857241156995429*^9, 3.8572411616740093`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"c02d2508-4732-4d35-9e3a-92b405390fda"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"expectation", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "\[FormalI]"], "-", 
            SubscriptBox["x", "\[FormalJ]"]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]]}]], " ", 
      SubscriptBox["n", "\[FormalJ]"]}], ",", 
     RowBox[{
      RowBox[{"{", 
       SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        SubscriptBox["xav", "\[FormalI]"], ",", 
        SqrtBox[
         SubscriptBox["var", "\[FormalI]"]]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8572390671524763`*^9, 3.8572410733568563`*^9, {3.8572411543876677`*^9, 
   3.8572411621624002`*^9}},
 CellLabel->"Out[92]=",ExpressionUUID->"28f8e4cd-4ddc-4475-ac6f-1482fad18a46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.62", "s"}], " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{
           SubscriptBox["x", "\[FormalI]"], ",", 
           SubscriptBox["x", "\[FormalJ]"]}], "]"}], 
         SubscriptBox["n", "\[FormalJ]"]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[FormalJ]", ",", 
          SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["x", "\[FormalI]"], "}"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         SubscriptBox["xav", "\[FormalI]"], ",", 
         RowBox[{"Sqrt", "[", 
          SubscriptBox["var", "\[FormalI]"], "]"}]}], "]"}]}]}], "]"}], "/.", 
    
    RowBox[{
     RowBox[{"expectation", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
       "dist_"}], "]"}], ":>", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"expectation", "[", 
        RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
      "]"}]}]}], "/.", 
   RowBox[{"expectation", "->", "Expectation"}]}]}]], "Input",
 CellChangeTimes->{{3.8572390783865623`*^9, 3.857239083506834*^9}, {
  3.857241095345172*^9, 3.857241103596588*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"7ccf72fd-87dd-4165-9276-a451329c78c7"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["x", "\[FormalJ]"], "-", 
           SubscriptBox["xav", "\[FormalI]"]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Sigma]", "2"], "+", 
           SubscriptBox["var", "\[FormalI]"]}], ")"}]}]]}]], " ", 
     SubscriptBox["n", "\[FormalJ]"]}], 
    SqrtBox[
     RowBox[{"1", "+", 
      FractionBox[
       SubscriptBox["var", "\[FormalI]"], 
       SuperscriptBox["\[Sigma]", "2"]]}]]], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalJ]", ",", 
     SubscriptBox["\[ScriptCapitalN]", "n"]}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.857239084377681*^9, {3.857241096525812*^9, 3.8572411051355143`*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"fb1e072e-7e89-46d3-b3e0-33064d9d87f2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["stackexchange \tq redux", "Section",
 CellChangeTimes->{{3.8572417885211267`*^9, 3.8572417948746157`*^9}, {
  3.85730149394312*^9, 
  3.857301495085019*^9}},ExpressionUUID->"4c953b24-7180-4983-8f5c-\
89e8007573ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi_", ",", "xj_"}], "]"}], ":=", 
   RowBox[{"E", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", "-", "xj"}], ")"}], "^", "2"}], "/", 
       RowBox[{"\[Sigma]a", "^", "2"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.857242189090331*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"8a8a3f2c-ab78-4648-a677-a0f88722e895"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.62", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{
      RowBox[{"x", "[", "i", "]"}], ",", 
      RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       RowBox[{"xav", "[", "j", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8572416143393593`*^9, 3.857241647850745*^9}, {
  3.857241875426619*^9, 3.85724191907397*^9}, {3.8572419771163063`*^9, 
  3.857242011320888*^9}, {3.85724207723978*^9, 3.857242098507373*^9}, {
  3.857242195132869*^9, 3.857242195436059*^9}, {3.8573014761219053`*^9, 
  3.8573014796064587`*^9}, {3.857301523295825*^9, 3.857301526575121*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"f1269ddf-3768-4558-b499-356b63342f5d"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], "-", 
        RowBox[{"xav", "[", "j", "]"}]}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]a", "2"], "+", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["\[Sigma]a", "2"]], "+", 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]]}]], " ", 
   RowBox[{"\[Sigma]", "[", "j", "]"}]}]]], "Output",
 CellChangeTimes->{
  3.857241637718437*^9, 3.857241903249288*^9, {3.857241992353787*^9, 
   3.857242012170135*^9}, {3.857242079063884*^9, 3.857242107014131*^9}, 
   3.857242196722062*^9, 3.857252723747724*^9, 3.857301486620689*^9, 
   3.857301527475594*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"d0d2e7f2-7edc-4212-9dce-5ed7721b59f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"30", "s"}], " ", "-", " ", "fails"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "n"}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       RowBox[{"xav", "[", "j", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.857241591842492*^9, 3.857241598539816*^9}, {
  3.8572419589594097`*^9, 3.857241961124716*^9}, {3.857242021605732*^9, 
  3.857242023590358*^9}, {3.8572420565160418`*^9, 3.8572420938067417`*^9}, {
  3.857242208318821*^9, 3.857242208670972*^9}, {3.8573015394049997`*^9, 
  3.857301543901889*^9}, {3.857301585064089*^9, 
  3.857301585108322*^9}},ExpressionUUID->"15935cfe-ec12-4fb9-858f-\
ee22e04fcc8d"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "-", 
           RowBox[{"x", "[", "j", "]"}]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]a", "2"]}]]}]], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "n"}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      RowBox[{"xav", "[", "j", "]"}], ",", 
      RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.857241585611717*^9, 3.857242103422418*^9, 
  3.8572421907064342`*^9, 3.857242379763286*^9, 3.857301576270114*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"4c304d9a-3cf6-4c23-827f-c938e2b86b90"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"0.5", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"xav", "[", "j", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "n"}], "}"}], ",", 
    RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.857239031242639*^9, 3.8572390396443043`*^9}, {
   3.8572408082563343`*^9, 3.857240810850124*^9}, {3.857242157315089*^9, 
   3.857242186546537*^9}, 3.857242616920912*^9, {3.857242736664966*^9, 
   3.857242738784004*^9}, {3.857301589310997*^9, 3.857301592852759*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"6643b34c-1b7c-4425-8248-34a2d951e63a"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], "-", 
          RowBox[{"xav", "[", "j", "]"}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]a", "2"], "+", 
          SuperscriptBox[
           RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]}], ")"}]}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["\[Sigma]a", "2"]], "+", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]]}]], " ", 
     RowBox[{"\[Sigma]", "[", "j", "]"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "n"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.85723904073536*^9, {3.8572408048256903`*^9, 3.857240812436924*^9}, 
   3.857242612807315*^9, {3.8572427844477377`*^9, 3.857242791185286*^9}, 
   3.85725273000179*^9, 3.857301597285016*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"d2e97bbc-e314-44e8-8f5f-08c763571932"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"30", "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Expectation", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], ",", 
         RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
      RowBox[{"NormalDistribution", "[", 
       RowBox[{
        RowBox[{"xav", "[", "j", "]"}], ",", 
        RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
      "dist_"}], "]"}], ":>", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Expectation", "[", 
       RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8572346717411747`*^9, 3.857234771111627*^9}, {
   3.8572348294954357`*^9, 3.857234869390933*^9}, {3.857238280455937*^9, 
   3.857238280670395*^9}, {3.857239822926581*^9, 3.857239836146326*^9}, {
   3.857240046489875*^9, 3.8572400504436207`*^9}, {3.857240400968306*^9, 
   3.857240410182555*^9}, 3.8572421380691442`*^9, {3.857242599776842*^9, 
   3.85724259993519*^9}, {3.857242812788457*^9, 3.8572428129984713`*^9}, {
   3.857301619190157*^9, 3.857301622502491*^9}, {3.857301663560194*^9, 
   3.857301663587866*^9}},ExpressionUUID->"0d5c94af-0e16-46d2-9fd9-\
927b48cbc478"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], "-", 
          RowBox[{"xav", "[", "j", "]"}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]a", "2"], "+", 
          SuperscriptBox[
           RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]}], ")"}]}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["\[Sigma]a", "2"]], "+", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]]}]], " ", 
     RowBox[{"\[Sigma]", "[", "j", "]"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "n"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.857238558145273*^9, 3.857240022588176*^9, 
  3.857240596471727*^9, 3.857242585955844*^9, 3.857301654974123*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"bfc11b04-c78c-4cd5-b5bc-ae6c76bacd97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Bob", " ", "Hanlon"}], " ", "\[Dash]", " ", 
    RowBox[{
     RowBox[{"8.23", "s"}], " ", "-", " ", 
     RowBox[{"but", " ", "not", " ", 
      RowBox[{"right", "?", "!"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Sigma]a", ">", "0"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{"n", ",", "PositiveIntegers"}], "]"}]}], "}"}], ",", 
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"xav", "[", "j", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.857252734622761*^9, 3.857252773638918*^9}, {
  3.857254695168652*^9, 3.857254698158345*^9}, {3.857301678438073*^9, 
  3.8573016814287233`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"a1161b87-74ce-495e-8db6-9cc8f490e558"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], "-", 
         RowBox[{"xav", "[", "j", "]"}]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Sigma]a", "2"], "+", 
         SuperscriptBox[
          RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]}], ")"}]}]]}]], " ", "n", 
   " ", "\[Sigma]a"}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["\[Sigma]a", "2"], "+", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]}]]]], "Output",
 CellChangeTimes->{{3.8572527668160067`*^9, 3.857252783509426*^9}, 
   3.857254707489386*^9, 3.857301683530163*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"93d3ff6c-d448-419f-a585-d3d54ce2a898"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"fails", " ", "after", " ", "90", "s"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Sigma]a", ">", "0"}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{"n", ",", "PositiveIntegers"}], "]"}]}], "}"}], ",", 
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"xav", "[", "j", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.857252734622761*^9, 3.857252787064453*^9}, {
   3.857253299320261*^9, 3.857253308242631*^9}, 3.857301696861862*^9, {
   3.85730188370675*^9, 3.857301891497404*^9}, {3.857302645004228*^9, 
   3.857302647623599*^9}},ExpressionUUID->"f8e56b10-77d3-4b7f-911b-\
cc544bc913ff"],

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "-", 
           RowBox[{"x", "[", "j", "]"}]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Sigma]a", "2"]}]]}]], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "n"}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      RowBox[{"xav", "[", "j", "]"}], ",", 
      RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.857302272112752*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"b04d9061-9ff9-4085-b09b-773f38876e8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"kglr", " ", "-", " ", 
    RowBox[{"0.57", "s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"sum", "/:", 
    RowBox[{"Expectation", "[", 
     RowBox[{
      RowBox[{"sum", "[", 
       RowBox[{"a_", ",", "b__"}], "]"}], ",", "c___"}], "]"}], ":=", 
    RowBox[{"sum", "[", 
     RowBox[{
      RowBox[{"Expectation", "[", 
       RowBox[{"a", ",", "c"}], "]"}], ",", "b"}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"sum", "->", "Sum"}], "]"}], "@", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Sum", "=", "sum"}], "}"}], ",", 
       RowBox[{"Expectation", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], ",", 
             RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "n"}], "}"}], ",", 
           RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{
            RowBox[{"xav", "[", "j", "]"}], ",", 
            RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}]}], 
      "]"}]}], "//", "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.85730094684896*^9, 3.8573009468522377`*^9}, {
  3.857301705071723*^9, 3.8573017489049807`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"0f6c90e1-dbec-4342-bebc-ad8a3a89c4e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.627291`", ",", 
   RowBox[{"Sum", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", "i", "]"}], "-", 
            RowBox[{"xav", "[", "j", "]"}]}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Sigma]a", "2"], "+", 
            SuperscriptBox[
             RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]}], ")"}]}]]}]], 
      RowBox[{
       SqrtBox[
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["\[Sigma]a", "2"]], "+", 
         FractionBox["1", 
          SuperscriptBox[
           RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]]}]], " ", 
       RowBox[{"\[Sigma]", "[", "j", "]"}]}]], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "n"}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.857300952470191*^9, {3.85730169897059*^9, 3.857301709585084*^9}, 
   3.857301744077035*^9, 3.8573018363023453`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"bc5966ae-8ecd-4590-9a47-b01cf25f0990"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"me", " ", "-", " ", 
    RowBox[{"0.55", "s"}]}], " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"expectation", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "n"}], "}"}], ",", 
        RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"x", "[", "j", "]"}], "\[Distributed]", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"xav", "[", "j", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "j", "]"}]}], "]"}]}]}], "]"}], "/.", 
    RowBox[{
     RowBox[{"expectation", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"func_", ",", "range_", ",", "opts___"}], "]"}], ",", 
       "dist_"}], "]"}], ":>", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"expectation", "[", 
        RowBox[{"func", ",", "dist"}], "]"}], ",", "range", ",", "opts"}], 
      "]"}]}]}], "/.", 
   RowBox[{"expectation", "->", "Expectation"}]}]}]], "Input",
 CellChangeTimes->{{3.8572390783865623`*^9, 3.857239083506834*^9}, {
  3.857241095345172*^9, 3.857241103596588*^9}, {3.857254571680197*^9, 
  3.857254579646673*^9}, {3.8572547782117443`*^9, 3.857254778278821*^9}, {
  3.857301842635818*^9, 3.857301858352908*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"2a6a7aa7-a0d7-4f98-b15b-728f6b107d49"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], "-", 
          RowBox[{"xav", "[", "j", "]"}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]a", "2"], "+", 
          SuperscriptBox[
           RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]}], ")"}]}]]}]], 
    RowBox[{
     SqrtBox[
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["\[Sigma]a", "2"]], "+", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"\[Sigma]", "[", "j", "]"}], "2"]]}]], " ", 
     RowBox[{"\[Sigma]", "[", "j", "]"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "n"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.85725458210674*^9, 3.857254774962419*^9, 
  3.857301849990953*^9, 3.857302721380665*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"91755abc-ff61-4a89-9609-20cd0eacf640"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"me", " ", "-", " ", 
    RowBox[{"0.55", "s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "n"}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<Procedural\>\""}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"x", "[", "_", "]"}], "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       RowBox[{"xav", "[", "_", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "_", "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8572390783865623`*^9, 3.857239083506834*^9}, {
  3.857241095345172*^9, 3.857241103596588*^9}, {3.857254571680197*^9, 
  3.857254579646673*^9}, {3.8572547782117443`*^9, 3.857254778278821*^9}, {
  3.857301842635818*^9, 3.857301858352908*^9}, {3.857302733571369*^9, 
  3.857302756043017*^9}},ExpressionUUID->"19bcd6fb-4a66-4cf9-b6fd-\
9a39613b6611"],

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], "-", 
         RowBox[{"x", "[", "j", "]"}]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Sigma]a", "2"]}]]}]], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "n"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\<\"Procedural\"\>"}]}], "]"}]], "Output",
 CellChangeTimes->{3.85730275234947*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"885e7c1c-f318-4e2e-8d1a-bde06fe5b800"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["old", "Section",
 CellChangeTimes->{{3.8572184429938507`*^9, 
  3.857218443205484*^9}},ExpressionUUID->"aba2f5ee-adba-4e13-8c75-\
8a7b3c477c3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianIntegral", "[", 
   RowBox[{"func_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "mean_", ",", "var_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Expectation", "[", 
   RowBox[{"func", ",", 
    RowBox[{"x", "\[Distributed]", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"mean", ",", 
       RowBox[{"Sqrt", "[", "var", "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.833559947884481*^9, 3.833560035396982*^9}, {
  3.833560150688438*^9, 3.833560166918799*^9}, {3.833560234529353*^9, 
  3.833560254183783*^9}, {3.83356037319212*^9, 3.833560374480625*^9}, {
  3.833572473849465*^9, 3.8335724751821613`*^9}, {3.833572518215828*^9, 
  3.8335725313349667`*^9}, {3.8335734732936068`*^9, 3.8335734767389097`*^9}, {
  3.833577850772245*^9, 3.833577851020166*^9}},
 CellLabel->
  "(Local 2) In[1]:=",ExpressionUUID->"e10a92f1-b622-4a78-ba26-e61fb055b877"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaussianIntegralApprox", "[", 
   RowBox[{"func_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "mean_", ",", "var_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"func", "+", 
     RowBox[{
      RowBox[{"var", "/", "2"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{"func", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], "/.", 
   RowBox[{"x", "->", "mean"}]}]}]], "Input",
 CellChangeTimes->{{3.8335778743002033`*^9, 3.8335779238167133`*^9}, {
  3.8335779614673862`*^9, 3.833577966210826*^9}, {3.833578021925475*^9, 
  3.833578024772565*^9}},
 CellLabel->
  "(Local 2) In[2]:=",ExpressionUUID->"e6a0c38f-17e1-4eec-879d-95103a4d4b2d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GaussianIntegralApprox", "[", 
  RowBox[{
   RowBox[{"x\[Prime]", "^", "4"}], ",", 
   RowBox[{"{", 
    RowBox[{"x\[Prime]", ",", "x", ",", "varx"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8572158436290503`*^9, 3.857215847785255*^9}},
 CellLabel->
  "(Local 2) In[45]:=",ExpressionUUID->"48ea4ba3-cd1e-498c-afc4-ba83c9313d08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"6", " ", "varx", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  SuperscriptBox["x", "4"]}]], "Output",
 CellChangeTimes->{3.857215848296191*^9},
 CellLabel->
  "(Local 2) Out[45]=",ExpressionUUID->"97934acf-a946-464f-9980-a9a05a25c429"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["asymptoticexpectation", "Section",
 CellChangeTimes->{{3.85722382290764*^9, 
  3.857223828238338*^9}},ExpressionUUID->"ba374f26-e590-499a-b3ba-\
c61696cf9f0a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "NExpectation"}]], "Input",
 CellChangeTimes->{{3.8572214465112877`*^9, 3.8572214479819393`*^9}},
 CellLabel->
  "(Local 2) In[23]:=",ExpressionUUID->"3f9d5b9f-105d-4791-97c4-f335a7fd5703"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/NExpectation",
              ButtonNote->"paclet:ref/NExpectation"],
             "\"paclet:ref/NExpectation\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"NExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", RowBox[{StyleBox[\\\"x\
\\\", \\\"TI\\\"], \\\"\[Distributed]\\\", StyleBox[\\\"dist\\\", \
\\\"TI\\\"]}]}], \\\"]\\\"}]\\) gives the numerical expectation of \
\\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\) under the assumption that \
\\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\) follows the probability \
distribution \\!\\(\\*StyleBox[\\\"dist\\\", \
\\\"TI\\\"]\\).\\n\\!\\(\\*RowBox[{\\\"NExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}], \\\"\[Distributed]\\\", StyleBox[\\\"dist\\\", \\\"TI\\\"]}]}], \\\"]\\\
\"}]\\) gives the numerical expectation of \\!\\(\\*StyleBox[\\\"expr\\\", \\\
\"TI\\\"]\\) under the assumption that \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\
\"TR\\\"]}], \\\"}\\\"}]\\) follows the multivariate distribution \
\\!\\(\\*StyleBox[\\\"dist\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"NExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\"\[Distributed]\\\", \
SubscriptBox[StyleBox[\\\"dist\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\
\"]]}], \\\",\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\"\[Distributed]\\\", \
SubscriptBox[StyleBox[\\\"dist\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\
\"]]}], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \
StyleBox[\\\"}\\\", \\\"TR\\\"]}]}], \\\"]\\\"}]\\) gives the numerical \
expectation of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\) under the \
assumption that \\!\\(\\*SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]]\\), \
\\!\\(\\*SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \\\
\"TR\\\"]]\\), \\!\\(\\*StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]\\) are \
independent and follow the distributions \
\\!\\(\\*SubscriptBox[StyleBox[\\\"dist\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]]\\), \\!\\(\\*SubscriptBox[StyleBox[\\\"dist\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]\\), \\!\\(\\*StyleBox[\\\"\[Ellipsis]\\\", \
\\\"TR\\\"]\\). \\n\\!\\(\\*RowBox[{\\\"NExpectation\\\", \\\"[\\\", \
RowBox[{RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\"\[Conditioned]\\\", \
StyleBox[\\\"pred\\\", \\\"TI\\\"]}], \\\",\\\", \
StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"]\\\"}]\\) gives the \
numerical conditional expectation of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\
\"]\\) given \\!\\(\\*StyleBox[\\\"pred\\\", \\\"TI\\\"]\\).\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", "paclet:ref/NExpectation", 
                    "paclet:ref/NExpectation", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"], "\"  \"", 
                    StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False], 
                    "\"  \"", 
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/NExpectation.\
html"], None}, "http://reference.wolfram.com/language/ref/NExpectation.html", 
                    "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   PaneSelectorBox[{True->
                    ButtonBox[
                    PaneSelectorBox[{False->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "DownPointerOpener"]]},
                    "RowWithSeparators"], True->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "DownPointerOpenerHot"]]},
                    "RowWithSeparators"]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    FrameMargins->0,
                    ImageSize->Automatic],
                    Appearance->None,
                    BaseStyle->None,
                    
                    ButtonFunction:>(Part[System`InformationDump`open$$, 3] = 
                    False),
                    Evaluator->Automatic,
                    FrameMargins->0,
                    ImageMargins->0,
                    Method->"Preemptive"], False->
                    ButtonBox[
                    PaneSelectorBox[{False->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "RightPointerOpener"]]},
                    "RowWithSeparators"], True->
                    TemplateBox[{"\[ThickSpace]", "\"\[ThickSpace]\"", 
                    StyleBox[
                    "\"Options\"", "InformationRowLabel", StripOnInput -> 
                    False], 
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "RightPointerOpenerHot"]]},
                    "RowWithSeparators"]}, Dynamic[
                    CurrentValue["MouseOver"]],
                    FrameMargins->0,
                    ImageSize->Automatic],
                    Appearance->None,
                    BaseStyle->None,
                    
                    ButtonFunction:>(Part[System`InformationDump`open$$, 3] = 
                    True),
                    Evaluator->Automatic,
                    FrameMargins->0,
                    ImageMargins->0,
                    Method->"Preemptive"]}, Dynamic[
                    FEPrivate`Part[System`InformationDump`open$$, 3]]], 
                   PaneSelectorBox[{True->GridBox[{
                    {
                    RowBox[{"AccuracyGoal", "\[Rule]", "\[Infinity]"}]},
                    {
                    RowBox[{"Compiled", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"Method", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"PrecisionGoal", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{"TargetUnits", "\[Rule]", "Automatic"}]},
                    {
                    RowBox[{
                    "WorkingPrecision", "\[Rule]", "MachinePrecision"}]},
                    {
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[InvisibleSpace]\"", "6", "\" total)\""},
                    "RowDefault"], "InformationRowOpener",
                    StripOnInput->False]}
                    },
                    BaselinePosition->{Baseline, {1, 1}},
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{1.}}}], False->
                    RowBox[{
                    RowBox[{"AccuracyGoal", "\[Rule]", "\[Infinity]"}], 
                    "\[ThinSpace]", 
                    StyleBox["\<\"\[Ellipsis]\"\>", "InformationRowOpener",
                    StripOnInput->False], "\[ThinSpace]", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[InvisibleSpace]\"", "6", "\" total)\""},
                    "RowDefault"], "InformationRowOpener",
                    StripOnInput->False]}]}, Dynamic[
                    FEPrivate`Part[System`InformationDump`open$$, 3]],
                    BaselinePosition->Baseline,
                    ImageSize->Automatic]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", 
                    RowBox[{"Protected", ",", "ReadProtected"}], "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`NExpectation\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{16., {5., 11.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{16., {5., 11.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/NExpectation",
              ButtonNote->"paclet:ref/NExpectation"],
             "\"paclet:ref/NExpectation\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"NExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", RowBox[{StyleBox[\\\"x\
\\\", \\\"TI\\\"], \\\"\[Distributed]\\\", StyleBox[\\\"dist\\\", \
\\\"TI\\\"]}]}], \\\"]\\\"}]\\) gives the numerical expectation of \
\\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\) under the assumption that \
\\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\) follows the probability \
distribution \\!\\(\\*StyleBox[\\\"dist\\\", \
\\\"TI\\\"]\\).\\n\\!\\(\\*RowBox[{\\\"NExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}], \\\"\[Distributed]\\\", StyleBox[\\\"dist\\\", \\\"TI\\\"]}]}], \\\"]\\\
\"}]\\) gives the numerical expectation of \\!\\(\\*StyleBox[\\\"expr\\\", \\\
\"TI\\\"]\\) under the assumption that \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\
\"TR\\\"]}], \\\"}\\\"}]\\) follows the multivariate distribution \
\\!\\(\\*StyleBox[\\\"dist\\\", \\\"TI\\\"]\\). \
\\n\\!\\(\\*RowBox[{\\\"NExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\"\[Distributed]\\\", \
SubscriptBox[StyleBox[\\\"dist\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\
\"]]}], \\\",\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\"\[Distributed]\\\", \
SubscriptBox[StyleBox[\\\"dist\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \\\"TR\\\
\"]]}], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \
StyleBox[\\\"}\\\", \\\"TR\\\"]}]}], \\\"]\\\"}]\\) gives the numerical \
expectation of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\) under the \
assumption that \\!\\(\\*SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"1\\\", \\\"TR\\\"]]\\), \
\\!\\(\\*SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \\\
\"TR\\\"]]\\), \\!\\(\\*StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]\\) are \
independent and follow the distributions \
\\!\\(\\*SubscriptBox[StyleBox[\\\"dist\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]]\\), \\!\\(\\*SubscriptBox[StyleBox[\\\"dist\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]]\\), \\!\\(\\*StyleBox[\\\"\[Ellipsis]\\\", \
\\\"TR\\\"]\\). \\n\\!\\(\\*RowBox[{\\\"NExpectation\\\", \\\"[\\\", \
RowBox[{RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\"\[Conditioned]\\\", \
StyleBox[\\\"pred\\\", \\\"TI\\\"]}], \\\",\\\", \
StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"]\\\"}]\\) gives the \
numerical conditional expectation of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\
\"]\\) given \\!\\(\\*StyleBox[\\\"pred\\\", \\\"TI\\\"]\\).\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {2., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{13., {2., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"NExpectation\", \"[\", RowBox[{StyleBox[\"expr\", \
\"TI\"], \",\", RowBox[{StyleBox[\"x\", \"TI\"], \"\[Distributed]\", \
StyleBox[\"dist\", \"TI\"]}]}], \"]\"}]\) gives the numerical expectation of \
\!\(\*StyleBox[\"expr\", \"TI\"]\) under the assumption that \
\!\(\*StyleBox[\"x\", \"TI\"]\) follows the probability distribution \
\!\(\*StyleBox[\"dist\", \"TI\"]\).\n\!\(\*RowBox[{\"NExpectation\", \"[\", \
RowBox[{StyleBox[\"expr\", \"TI\"], \",\", RowBox[{RowBox[{\"{\", \
RowBox[{SubscriptBox[StyleBox[\"x\", \"TI\"], StyleBox[\"1\", \"TR\"]], \
\",\", SubscriptBox[StyleBox[\"x\", \"TI\"], StyleBox[\"2\", \"TR\"]], \",\", \
StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"}\"}], \"\[Distributed]\", \
StyleBox[\"dist\", \"TI\"]}]}], \"]\"}]\) gives the numerical expectation of \
\!\(\*StyleBox[\"expr\", \"TI\"]\) under the assumption that \
\!\(\*RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"x\", \"TI\"], \
StyleBox[\"1\", \"TR\"]], \",\", SubscriptBox[StyleBox[\"x\", \"TI\"], \
StyleBox[\"2\", \"TR\"]], \",\", StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"}\"}]\
\) follows the multivariate distribution \!\(\*StyleBox[\"dist\", \"TI\"]\). \
\n\!\(\*RowBox[{\"NExpectation\", \"[\", RowBox[{StyleBox[\"expr\", \"TI\"], \
\",\", RowBox[{\"{\", RowBox[{RowBox[{SubscriptBox[StyleBox[\"x\", \"TI\"], \
StyleBox[\"1\", \"TR\"]], \"\[Distributed]\", SubscriptBox[StyleBox[\"dist\", \
\"TI\"], StyleBox[\"1\", \"TR\"]]}], \",\", RowBox[{SubscriptBox[StyleBox[\"x\
\", \"TI\"], StyleBox[\"2\", \"TR\"]], \"\[Distributed]\", \
SubscriptBox[StyleBox[\"dist\", \"TI\"], StyleBox[\"2\", \"TR\"]]}], \",\", \
StyleBox[\"\[Ellipsis]\", \"TR\"]}], StyleBox[\"}\", \"TR\"]}]}], \"]\"}]\) \
gives the numerical expectation of \!\(\*StyleBox[\"expr\", \"TI\"]\) under \
the assumption that \!\(\*SubscriptBox[StyleBox[\"x\", \"TI\"], \
StyleBox[\"1\", \"TR\"]]\), \!\(\*SubscriptBox[StyleBox[\"x\", \"TI\"], \
StyleBox[\"2\", \"TR\"]]\), \!\(\*StyleBox[\"\[Ellipsis]\", \"TR\"]\) are \
independent and follow the distributions \
\!\(\*SubscriptBox[StyleBox[\"dist\", \"TI\"], StyleBox[\"1\", \"TR\"]]\), \!\
\(\*SubscriptBox[StyleBox[\"dist\", \"TI\"], StyleBox[\"2\", \"TR\"]]\), \!\(\
\*StyleBox[\"\[Ellipsis]\", \"TR\"]\). \n\!\(\*RowBox[{\"NExpectation\", \
\"[\", RowBox[{RowBox[{StyleBox[\"expr\", \"TI\"], \"\[Conditioned]\", \
StyleBox[\"pred\", \"TI\"]}], \",\", StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"]\
\"}]\) gives the numerical conditional expectation of \
\!\(\*StyleBox[\"expr\", \"TI\"]\) given \!\(\*StyleBox[\"pred\", \"TI\"]\).",
     "Documentation" -> <|
     "Local" -> "paclet:ref/NExpectation", "Web" -> 
      "http://reference.wolfram.com/language/ref/NExpectation.html"|>, 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> None, 
    "SubValues" -> None, "DefaultValues" -> None, "NValues" -> None, 
    "FormatValues" -> None, 
    "Options" -> {
     AccuracyGoal -> DirectedInfinity[1], Compiled -> Automatic, Method -> 
      Automatic, PrecisionGoal -> Automatic, TargetUnits -> Automatic, 
      WorkingPrecision -> MachinePrecision}, 
    "Attributes" -> {Protected, ReadProtected}, "FullName" -> 
    "System`NExpectation"|>, False]]], "Output",
 CellChangeTimes->{3.857221448508417*^9},
 CellLabel->
  "(Local 2) Out[23]=",ExpressionUUID->"bcb7257e-1aff-4f3b-8df8-5cfb9235b345"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "AsymptoticExpectation"}]], "Input",
 CellChangeTimes->{{3.857222580236883*^9, 3.857222595054291*^9}},
 CellLabel->
  "(Local 2) In[25]:=",ExpressionUUID->"87a99573-eef5-48cc-ba96-24ef1eea8e24"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/AsymptoticExpectation",
              ButtonNote->"paclet:ref/AsymptoticExpectation"],
             "\"paclet:ref/AsymptoticExpectation\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"AsymptoticExpectation\\\", \
\\\"[\\\", RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{StyleBox[\\\"x\\\", \\\"TI\\\"], \\\"\[Distributed]\\\", \
StyleBox[\\\"dist\\\", \\\"TI\\\"]}], \\\",\\\", RowBox[{StyleBox[\\\"a\\\", \
\\\"TI\\\"], \\\"\[Rule]\\\", SubscriptBox[StyleBox[\\\"a\\\", \\\"TI\\\"], \
StyleBox[\\\"0\\\", \\\"TR\\\"]]}]}], \\\"]\\\"}]\\) computes an asymptotic \
approximation for the expectation of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\
\"]\\) centered at \\!\\(\\*SubscriptBox[StyleBox[\\\"a\\\", \\\"TI\\\"], \
StyleBox[\\\"0\\\", \\\"TR\\\"]]\\), under the assumption that \
\\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\) follows the probability \
distribution \\!\\(\\*StyleBox[\\\"dist\\\", \
\\\"TI\\\"]\\).\\n\\!\\(\\*RowBox[{\\\"AsymptoticExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}], \\\"\[Distributed]\\\", StyleBox[\\\"dist\\\", \\\"TI\\\"]}], StyleBox[\
\\\",\\\", \\\"TI\\\"], RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \
StyleBox[\\\"\[Rule]\\\", \\\"TI\\\"], SubscriptBox[StyleBox[\\\"a\\\", \
\\\"TI\\\"], StyleBox[\\\"0\\\", \\\"TR\\\"]]}]}], \\\"]\\\"}]\\) computes an \
asymptotic approximation for the expectation of \
\\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\) centered at \
\\!\\(\\*SubscriptBox[StyleBox[\\\"a\\\", \\\"TI\\\"], StyleBox[\\\"0\\\", \\\
\"TR\\\"]]\\), under the assumption that \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\
\"TR\\\"]}], \\\"}\\\"}]\\) follows the multivariate distribution \
\\!\\(\\*StyleBox[\\\"dist\\\", \
\\\"TI\\\"]\\).\\n\\!\\(\\*RowBox[{\\\"AsymptoticExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"vars\\\", \
\\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\
\\\"], \\\",\\\", SubscriptBox[StyleBox[\\\"a\\\", \\\"TI\\\"], \
StyleBox[\\\"0\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"n\\\", \
\\\"TI\\\"]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) computes the asymptotic \
expectation to order \\!\\(\\*StyleBox[\\\"n\\\", \\\"TI\\\"]\\).\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", 
                    "paclet:ref/AsymptoticExpectation", 
                    "paclet:ref/AsymptoticExpectation", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"], "\"  \"", 
                    StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False], 
                    "\"  \"", 
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/\
AsymptoticExpectation.html"], None}, 
                    "http://reference.wolfram.com/language/ref/\
AsymptoticExpectation.html", "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", 
                    RowBox[{"Protected", ",", "ReadProtected"}], "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`AsymptoticExpectation\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{16., {5., 11.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{16., {5., 11.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/AsymptoticExpectation",
              ButtonNote->"paclet:ref/AsymptoticExpectation"],
             "\"paclet:ref/AsymptoticExpectation\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"AsymptoticExpectation\\\", \
\\\"[\\\", RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{StyleBox[\\\"x\\\", \\\"TI\\\"], \\\"\[Distributed]\\\", \
StyleBox[\\\"dist\\\", \\\"TI\\\"]}], \\\",\\\", RowBox[{StyleBox[\\\"a\\\", \
\\\"TI\\\"], \\\"\[Rule]\\\", SubscriptBox[StyleBox[\\\"a\\\", \\\"TI\\\"], \
StyleBox[\\\"0\\\", \\\"TR\\\"]]}]}], \\\"]\\\"}]\\) computes an asymptotic \
approximation for the expectation of \\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\
\"]\\) centered at \\!\\(\\*SubscriptBox[StyleBox[\\\"a\\\", \\\"TI\\\"], \
StyleBox[\\\"0\\\", \\\"TR\\\"]]\\), under the assumption that \
\\!\\(\\*StyleBox[\\\"x\\\", \\\"TI\\\"]\\) follows the probability \
distribution \\!\\(\\*StyleBox[\\\"dist\\\", \
\\\"TI\\\"]\\).\\n\\!\\(\\*RowBox[{\\\"AsymptoticExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \
\\\"TI\\\"], StyleBox[\\\"1\\\", \\\"TR\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"2\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"]}], \\\"}\\\
\"}], \\\"\[Distributed]\\\", StyleBox[\\\"dist\\\", \\\"TI\\\"]}], StyleBox[\
\\\",\\\", \\\"TI\\\"], RowBox[{StyleBox[\\\"a\\\", \\\"TI\\\"], \
StyleBox[\\\"\[Rule]\\\", \\\"TI\\\"], SubscriptBox[StyleBox[\\\"a\\\", \
\\\"TI\\\"], StyleBox[\\\"0\\\", \\\"TR\\\"]]}]}], \\\"]\\\"}]\\) computes an \
asymptotic approximation for the expectation of \
\\!\\(\\*StyleBox[\\\"expr\\\", \\\"TI\\\"]\\) centered at \
\\!\\(\\*SubscriptBox[StyleBox[\\\"a\\\", \\\"TI\\\"], StyleBox[\\\"0\\\", \\\
\"TR\\\"]]\\), under the assumption that \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\
\"TR\\\"]}], \\\"}\\\"}]\\) follows the multivariate distribution \
\\!\\(\\*StyleBox[\\\"dist\\\", \
\\\"TI\\\"]\\).\\n\\!\\(\\*RowBox[{\\\"AsymptoticExpectation\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"vars\\\", \
\\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"a\\\", \\\"TI\
\\\"], \\\",\\\", SubscriptBox[StyleBox[\\\"a\\\", \\\"TI\\\"], \
StyleBox[\\\"0\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"n\\\", \
\\\"TI\\\"]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) computes the asymptotic \
expectation to order \\!\\(\\*StyleBox[\\\"n\\\", \\\"TI\\\"]\\).\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {2., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{13., {2., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"AsymptoticExpectation\", \"[\", \
RowBox[{StyleBox[\"expr\", \"TI\"], \",\", RowBox[{StyleBox[\"x\", \"TI\"], \
\"\[Distributed]\", StyleBox[\"dist\", \"TI\"]}], \",\", RowBox[{StyleBox[\"a\
\", \"TI\"], \"\[Rule]\", SubscriptBox[StyleBox[\"a\", \"TI\"], \
StyleBox[\"0\", \"TR\"]]}]}], \"]\"}]\) computes an asymptotic approximation \
for the expectation of \!\(\*StyleBox[\"expr\", \"TI\"]\) centered at \
\!\(\*SubscriptBox[StyleBox[\"a\", \"TI\"], StyleBox[\"0\", \"TR\"]]\), under \
the assumption that \!\(\*StyleBox[\"x\", \"TI\"]\) follows the probability \
distribution \!\(\*StyleBox[\"dist\", \"TI\"]\).\n\
\!\(\*RowBox[{\"AsymptoticExpectation\", \"[\", RowBox[{StyleBox[\"expr\", \
\"TI\"], \",\", RowBox[{RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"x\", \
\"TI\"], StyleBox[\"1\", \"TR\"]], \",\", SubscriptBox[StyleBox[\"x\", \
\"TI\"], StyleBox[\"2\", \"TR\"]], \",\", StyleBox[\"\[Ellipsis]\", \
\"TR\"]}], \"}\"}], \"\[Distributed]\", StyleBox[\"dist\", \"TI\"]}], \
StyleBox[\",\", \"TI\"], RowBox[{StyleBox[\"a\", \"TI\"], \
StyleBox[\"\[Rule]\", \"TI\"], SubscriptBox[StyleBox[\"a\", \"TI\"], \
StyleBox[\"0\", \"TR\"]]}]}], \"]\"}]\) computes an asymptotic approximation \
for the expectation of \!\(\*StyleBox[\"expr\", \"TI\"]\) centered at \
\!\(\*SubscriptBox[StyleBox[\"a\", \"TI\"], StyleBox[\"0\", \"TR\"]]\), under \
the assumption that \!\(\*RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"x\", \
\"TI\"], StyleBox[\"1\", \"TR\"]], \",\", SubscriptBox[StyleBox[\"x\", \
\"TI\"], StyleBox[\"2\", \"TR\"]], \",\", StyleBox[\"\[Ellipsis]\", \
\"TR\"]}], \"}\"}]\) follows the multivariate distribution \
\!\(\*StyleBox[\"dist\", \"TI\"]\).\n\!\(\*RowBox[{\"AsymptoticExpectation\", \
\"[\", RowBox[{StyleBox[\"expr\", \"TI\"], \",\", StyleBox[\"vars\", \"TI\"], \
\",\", RowBox[{\"{\", RowBox[{StyleBox[\"a\", \"TI\"], \",\", \
SubscriptBox[StyleBox[\"a\", \"TI\"], StyleBox[\"0\", \"TR\"]], \",\", \
StyleBox[\"n\", \"TI\"]}], \"}\"}]}], \"]\"}]\) computes the asymptotic \
expectation to order \!\(\*StyleBox[\"n\", \"TI\"]\).", 
    "Documentation" -> <|
     "Local" -> "paclet:ref/AsymptoticExpectation", "Web" -> 
      "http://reference.wolfram.com/language/ref/AsymptoticExpectation.html"|>\
, "OwnValues" -> None, "UpValues" -> None, "DownValues" -> None, "SubValues" -> 
    None, "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {Protected, ReadProtected}, "FullName" -> 
    "System`AsymptoticExpectation"|>, False]]], "Output",
 CellChangeTimes->{{3.8572225843374357`*^9, 3.857222595576686*^9}},
 CellLabel->
  "(Local 2) Out[25]=",ExpressionUUID->"b9076500-f4ca-4535-9f5a-5ab8408e88e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi\[Prime]", ",", "xj\[Prime]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]j", "^", "2"}], "}"}], "}"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857222741402162*^9, 3.8572227444860277`*^9}},
 CellLabel->
  "(Local 2) In[31]:=",ExpressionUUID->"1d7e6260-0a4c-4145-b405-1c54bb60637f"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xi\[Prime]", "-", "xj"}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        SuperscriptBox["\[Sigma]j", "2"]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["\[Sigma]", "2"]], "+", 
     FractionBox["1", 
      SuperscriptBox["\[Sigma]j", "2"]]}]], " ", 
   SqrtBox[
    SuperscriptBox["\[Sigma]j", "2"]]}]]], "Output",
 CellChangeTimes->{3.857222745166716*^9},
 CellLabel->
  "(Local 2) Out[31]=",ExpressionUUID->"43da80bc-ea05-4e7b-b336-65451ee9fcae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"xi\[Prime]", ",", "xj\[Prime]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]j", "^", "2"}], "}"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"xj\[Prime]", ",", "xj", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857222614943507*^9, 3.857222736386649*^9}},
 CellLabel->
  "(Local 2) In[30]:=",ExpressionUUID->"9917c74a-a397-4c29-8640-d78dc10f4ff4"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"xi\[Prime]", "-", "xj"}], ")"}], "2"], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        SuperscriptBox["\[Sigma]j", "2"]}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["\[Sigma]", "2"]], "+", 
     FractionBox["1", 
      SuperscriptBox["\[Sigma]j", "2"]]}]], " ", 
   SqrtBox[
    SuperscriptBox["\[Sigma]j", "2"]]}]]], "Output",
 CellChangeTimes->{{3.857222693975638*^9, 3.8572227369769287`*^9}},
 CellLabel->
  "(Local 2) Out[30]=",ExpressionUUID->"9bd32e12-24e6-4a2a-b623-6673e754975b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"xj\[Prime]", "^", "4"}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]j", "^", "2"}], "}"}], "}"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.857222741402162*^9, 3.8572227444860277`*^9}, {
  3.857222887719736*^9, 3.857222894921959*^9}},
 CellLabel->
  "(Local 2) In[32]:=",ExpressionUUID->"31075be0-f3cd-45b1-b37c-d401e4758531"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["xj", "4"], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["xj", "2"], " ", 
   SuperscriptBox["\[Sigma]j", "2"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["\[Sigma]j", "4"]}]}]], "Output",
 CellChangeTimes->{3.857222895262179*^9},
 CellLabel->
  "(Local 2) Out[32]=",ExpressionUUID->"692b3eec-0202-4118-b301-83faf19a606d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"xj\[Prime]", "^", "4"}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]j", "^", "2"}], "}"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"xj\[Prime]", ",", "xj", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857222614943507*^9, 3.857222736386649*^9}, {
  3.857222900756338*^9, 3.85722291207141*^9}},
 CellLabel->
  "(Local 2) In[34]:=",ExpressionUUID->"60ba7fe3-c595-4f20-89d9-a772824df1e9"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["xj", "4"], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["xj", "2"], " ", 
   SuperscriptBox["\[Sigma]j", "2"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["\[Sigma]j", "4"]}]}]], "Output",
 CellChangeTimes->{{3.857222902546007*^9, 3.85722291251608*^9}},
 CellLabel->
  "(Local 2) Out[34]=",ExpressionUUID->"d5759620-3680-4856-8d25-a56603f18a18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"xj\[Prime]", "^", "4"}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]j", "^", "2"}], "}"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"xj\[Prime]", "->", "xj"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857222995455909*^9, 3.8572230109729424`*^9}},
 CellLabel->
  "(Local 2) In[35]:=",ExpressionUUID->"71a19d0f-f8fd-484a-ab12-7590d6135240"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["xj", "4"], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["xj", "2"], " ", 
   SuperscriptBox["\[Sigma]j", "2"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["\[Sigma]j", "4"]}]}]], "Output",
 CellChangeTimes->{3.8572230113985*^9},
 CellLabel->
  "(Local 2) Out[35]=",ExpressionUUID->"5bf78a24-3277-4361-b4ba-b3de034ac0a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"xj\[Prime]", "^", "4"}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]j", "^", "2"}], "}"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"\[Sigma]j", "->", "0"}], ",", 
   RowBox[{"SeriesTermGoal", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8572230163332443`*^9, 3.8572230237231207`*^9}, {
  3.857223562487145*^9, 3.857223564563349*^9}},
 CellLabel->
  "(Local 2) In[45]:=",ExpressionUUID->"5564adcb-fb56-4449-a737-b297c5a3c04d"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["xj", "4"], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["xj", "2"], " ", 
   SuperscriptBox["\[Sigma]j", "2"]}]}]], "Output",
 CellChangeTimes->{{3.857223018863603*^9, 3.857223024017735*^9}, 
   3.857223565354681*^9},
 CellLabel->
  "(Local 2) Out[45]=",ExpressionUUID->"5b6a34ea-24c9-4981-9a2e-9841248cc379"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"xj\[Prime]", "^", "4"}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]j", "^", "2"}], "}"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"\[Sigma]j", "->", "1"}], ",", 
   RowBox[{"SeriesTermGoal", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{3.857223595420236*^9},
 CellLabel->
  "(Local 2) In[46]:=",ExpressionUUID->"f844674b-1278-4033-aefc-c3d57eb0d81d"],

Cell[BoxData[
 RowBox[{"9", "+", 
  SuperscriptBox["xj", "4"], "-", 
  RowBox[{"24", " ", "\[Sigma]j"}], "+", 
  RowBox[{"18", " ", 
   SuperscriptBox["\[Sigma]j", "2"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["xj", "2"], " ", 
   SuperscriptBox["\[Sigma]j", "2"]}]}]], "Output",
 CellChangeTimes->{3.8572235958444*^9},
 CellLabel->
  "(Local 2) Out[46]=",ExpressionUUID->"e837cb06-cf71-4c3a-aee5-155eec1b8889"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expectation", "[", 
  RowBox[{
   RowBox[{"xj\[Prime]", "^", "4"}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "1", "}"}], "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.85722361632685*^9, 3.8572236239905453`*^9}},
 CellLabel->
  "(Local 2) In[47]:=",ExpressionUUID->"f39074d0-de06-40c2-bf5e-b5e6b4bfdae2"],

Cell[BoxData[
 RowBox[{"3", "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["xj", "2"]}], "+", 
  SuperscriptBox["xj", "4"]}]], "Output",
 CellChangeTimes->{3.857223624725896*^9},
 CellLabel->
  "(Local 2) Out[47]=",ExpressionUUID->"5531627e-6c24-4e71-b114-5d12da71b4a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"xj\[Prime]", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", "xj\[Prime]"}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"{", "xj\[Prime]", "}"}], "\[Distributed]", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", "xj", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]j", "^", "2"}], "}"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"xj\[Prime]", "->", "xj"}], ",", 
   RowBox[{"SeriesTermGoal", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8572230667594223`*^9, 3.8572230740373363`*^9}},
 CellLabel->
  "(Local 2) In[39]:=",ExpressionUUID->"bdafc937-4133-4c0e-8c39-90fe7b090980"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.857223096267824*^9},
 CellLabel->
  "(Local 2) Out[39]=",ExpressionUUID->"4ee0b6e7-b98a-44fe-adda-95e55e34c5ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"f", "[", "x", "]"}], ",", 
   RowBox[{"x", "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"xj", ",", "\[Sigma]j"}], "]"}]}], ",", 
   RowBox[{"\[Sigma]j", "->", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857223696129448*^9, 3.857223697248417*^9}},
 CellLabel->
  "(Local 2) In[50]:=",ExpressionUUID->"32ed8e59-343a-4d5a-aad3-0949fc9167a2"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.857223799577079*^9},
 CellLabel->
  "(Local 2) Out[50]=",ExpressionUUID->"52fd7469-12e8-4f3d-8f4b-1f27ad354e41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"x", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}]}], ",", 
   RowBox[{"x", "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"xj", ",", "\[Sigma]j"}], "]"}]}], ",", 
   RowBox[{"\[Sigma]j", "->", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857223689195599*^9, 3.85722368934182*^9}},
 CellLabel->
  "(Local 2) In[49]:=",ExpressionUUID->"63547f43-d590-4d5f-bf05-f4f44a678da8"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.857223691176526*^9},
 CellLabel->
  "(Local 2) Out[49]=",ExpressionUUID->"fdb64f8d-f6a5-4bcd-99db-23ae48345f9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AsymptoticExpectation", "[", 
  RowBox[{
   RowBox[{"x", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}]}], ",", 
   RowBox[{"x", "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"xj", ",", "\[Sigma]j"}], "]"}]}], ",", 
   RowBox[{"\[Sigma]j", "->", "0"}], ",", 
   RowBox[{"SeriesTermGoal", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857223101399501*^9, 3.857223143752627*^9}, {
  3.857223646961925*^9, 3.857223653674018*^9}},
 CellLabel->
  "(Local 2) In[48]:=",ExpressionUUID->"66c95a19-af6e-43d4-9479-4aedf1dcedf3"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.857223123182605*^9, 3.857223136577694*^9}, 
   3.857223443501925*^9, 3.8572236846409283`*^9},
 CellLabel->
  "(Local 2) Out[48]=",ExpressionUUID->"99f22200-e4e5-48dc-b0a4-48464e4ec172"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NExpectation", "[", 
  RowBox[{
   RowBox[{"x", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}]}], ",", 
   RowBox[{"x", "\[Distributed]", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"2", ",", "2"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857223451494278*^9, 3.857223487166772*^9}},
 CellLabel->
  "(Local 2) In[44]:=",ExpressionUUID->"0c186a55-2d7c-4284-9808-91b756a8ae16"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", 2, 44, 5, 18133716256438914156, 
   "Local 2"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8572234668965273`*^9, 3.857223488176156*^9}},
 CellLabel->
  "During evaluation of (Local 2) \
In[44]:=",ExpressionUUID->"1d2783fc-0b79-4c21-ab62-760cc443b07d"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "ncvb", 
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"x\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"x\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"-\\\", \
\\\"1.4976094494573315`\\\"}], \\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"0.4651084686986197`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.26119441071337435`\\\"}]\\) for the integral and error \
estimates.\"", 2, 44, 6, 18133716256438914156, "Local 2"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8572234668965273`*^9, 3.85722348818042*^9}},
 CellLabel->
  "During evaluation of (Local 2) \
In[44]:=",ExpressionUUID->"00912ab6-2a22-41d8-925e-5dac1c759829"],

Cell[BoxData["0.4651084686986197`"], "Output",
 CellChangeTimes->{{3.857223466904235*^9, 3.857223488184243*^9}},
 CellLabel->
  "(Local 2) Out[44]=",ExpressionUUID->"8bb73409-476f-4222-a764-bf90703bd3cd"]
}, Open  ]]
}, Closed]]
},
WindowSize->{1285, 1330},
WindowMargins->{{79, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"820c3dec-c393-4b96-bce5-ee17590d3ca8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 147, 3, 84, "Section",ExpressionUUID->"554853e5-0d33-4eb5-9fc4-e2b55bf10581"],
Cell[730, 27, 503, 14, 51, "Input",ExpressionUUID->"5f0cfd65-e141-4b2c-a455-8ce72f7a4e01"],
Cell[1236, 43, 3287, 88, 234, "Input",ExpressionUUID->"18a34ef7-bac8-484e-9cc3-58e228d0bb4a"],
Cell[4526, 133, 1698, 47, 156, "Input",ExpressionUUID->"2e8637c6-e70b-4ac4-9c0a-f53064dfb57e"],
Cell[6227, 182, 493, 16, 51, "Input",ExpressionUUID->"81c5849c-d438-4102-b1c2-e5fe51119c65"],
Cell[CellGroupData[{
Cell[6745, 202, 529, 12, 51, "Input",ExpressionUUID->"56292ce7-4847-41a6-b73d-986ff6ab888c"],
Cell[7277, 216, 1065, 26, 115, "Output",ExpressionUUID->"94eace02-fb04-4462-aec1-8c95a2e7651b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8379, 247, 272, 6, 51, "Input",ExpressionUUID->"92ecbc5c-724f-4a9d-b34a-5c33ff424a08"],
Cell[8654, 255, 415, 8, 56, "Output",ExpressionUUID->"a79deef9-b810-4292-87ad-145ea0e97ccb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9106, 268, 425, 10, 51, "Input",ExpressionUUID->"d12f4432-4845-4633-bb60-6f7ee28eaf1d"],
Cell[9534, 280, 817, 22, 115, "Output",ExpressionUUID->"9e84f5f6-9db9-4a98-8c75-6830d2ca3f94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10388, 307, 538, 13, 51, "Input",ExpressionUUID->"2954e04d-6e4d-4b69-8f28-6e0b4a8ee4fc"],
Cell[10929, 322, 791, 23, 115, "Output",ExpressionUUID->"e03807a1-1dc4-438a-8482-9e6adee020e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11757, 350, 517, 13, 51, "Input",ExpressionUUID->"cfa60f23-8fac-43cf-97ac-70b54fc28611"],
Cell[12277, 365, 739, 22, 115, "Output",ExpressionUUID->"0f7e212d-e77d-4f4b-9408-0387a9cd8f09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13053, 392, 467, 11, 51, "Input",ExpressionUUID->"fe4a731a-4518-46b1-9e7a-a5615f07df5b"],
Cell[13523, 405, 301, 5, 56, "Output",ExpressionUUID->"229c0c08-234d-43bc-9a23-d4c9efe3227f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13861, 415, 462, 11, 51, "Input",ExpressionUUID->"fab5e232-2ee5-4570-93d9-59515291e52a"],
Cell[14326, 428, 321, 6, 56, "Output",ExpressionUUID->"45b21b42-bce7-43cb-b696-3065487692f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14684, 439, 461, 11, 51, "Input",ExpressionUUID->"b1fee1c7-ffbd-4050-bfc7-7bac4aac4cf7"],
Cell[15148, 452, 385, 8, 58, "Output",ExpressionUUID->"72c56f38-85e8-470c-afee-0e6817c2135a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15570, 465, 416, 11, 51, "Input",ExpressionUUID->"f7f5528b-770c-45bd-898d-a1bf2e54dcb6"],
Cell[15989, 478, 416, 10, 58, "Output",ExpressionUUID->"92cbb888-b9bc-4c2d-9fb0-53d3b5633569"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16442, 493, 386, 10, 51, "Input",ExpressionUUID->"8a31cffa-c940-4218-b2fc-358ddb52b1eb"],
Cell[16831, 505, 492, 12, 58, "Output",ExpressionUUID->"946f9745-a056-4b50-9431-9e79a182d385"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17360, 522, 820, 25, 53, "Input",ExpressionUUID->"5d1bc6b0-d3d3-41f2-b809-83df29f615bd"],
Cell[18183, 549, 283, 5, 56, "Output",ExpressionUUID->"83ac56eb-def0-4714-a7b5-e5cbf555e524"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18503, 559, 797, 25, 53, "Input",ExpressionUUID->"1c23353a-5401-4b30-93c8-34a18258b541"],
Cell[19303, 586, 299, 6, 56, "Output",ExpressionUUID->"d4c6623f-461b-466e-92b2-fb535125597a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19639, 597, 821, 26, 53, "Input",ExpressionUUID->"da6d2c2a-cb12-4bc8-9f5e-87d0868c2d73"],
Cell[20463, 625, 396, 10, 58, "Output",ExpressionUUID->"e26f267b-84c2-4af8-9c8c-de5b51c19f2f"]
}, Open  ]],
Cell[20874, 638, 829, 26, 51, "Input",ExpressionUUID->"f976ddaa-8b5a-4638-9c9e-9da01c6d6365"],
Cell[CellGroupData[{
Cell[21728, 668, 978, 29, 51, "Input",ExpressionUUID->"394ba93a-a5d8-4d11-a6cc-b17da3f5a8ec"],
Cell[22709, 699, 2321, 60, 119, "Output",ExpressionUUID->"664e0913-78da-4945-81e4-5e9621e933ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25067, 764, 1899, 50, 282, "Input",ExpressionUUID->"fe0ed2bb-12ed-44bb-bdbe-108ed88b4684"],
Cell[26969, 816, 1696, 46, 138, "Output",ExpressionUUID->"d2613e8b-77d4-471a-ad7d-984785fa79f6"]
}, Open  ]],
Cell[28680, 865, 647, 22, 78, "Input",ExpressionUUID->"5966fe6e-c58f-482a-963f-e1611eb9111c"],
Cell[CellGroupData[{
Cell[29352, 891, 693, 19, 57, "Input",ExpressionUUID->"d981d701-831c-4905-849a-d67ed73eb00f"],
Cell[30048, 912, 467, 13, 62, "Output",ExpressionUUID->"cbdee128-06bd-4ac9-ad03-d99cb9386729"]
}, Open  ]],
Cell[30530, 928, 464, 12, 51, "Input",ExpressionUUID->"e359571d-7920-4527-896e-9ca656228054"],
Cell[CellGroupData[{
Cell[31019, 944, 621, 17, 60, "Input",ExpressionUUID->"d1441c21-b391-4759-bd8a-7e693ce7b1a1"],
Cell[31643, 963, 718, 20, 112, "Output",ExpressionUUID->"bf862410-d376-455a-ba01-02f474756c57"]
}, Open  ]],
Cell[32376, 986, 1770, 37, 104, "Input",ExpressionUUID->"20829558-2407-4de2-a2f8-751ba2fec106"],
Cell[CellGroupData[{
Cell[34171, 1027, 596, 18, 60, "Input",ExpressionUUID->"726b3ae3-18f6-45fe-b993-325cde3cea0b"],
Cell[34770, 1047, 1169, 33, 142, "Output",ExpressionUUID->"1050b8c5-a1bb-4984-b181-44f71922c4c1"]
}, Open  ]],
Cell[35954, 1083, 2585, 61, 157, "Input",ExpressionUUID->"76038f19-1797-4b9f-8237-3ed3bedbc2f5"],
Cell[CellGroupData[{
Cell[38564, 1148, 596, 18, 60, "Input",ExpressionUUID->"4f21765b-2936-41e1-a3c9-5858659aeaf0"],
Cell[39163, 1168, 1194, 33, 142, "Output",ExpressionUUID->"d2d65219-9eaf-4b87-a11a-c33c79be08f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40394, 1206, 676, 18, 60, "Input",ExpressionUUID->"d2dba971-9c93-4ec3-b006-00b8855fd967"],
Cell[41073, 1226, 771, 20, 112, "Output",ExpressionUUID->"aa820a53-8f5a-428e-9688-fb7d2a5fe4a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41881, 1251, 672, 19, 60, "Input",ExpressionUUID->"e544634e-76fe-4259-9fc8-4405e1393375"],
Cell[42556, 1272, 1227, 35, 142, "Output",ExpressionUUID->"121c340c-4fec-4bf4-ae56-729f7ffeb291"]
}, Open  ]],
Cell[43798, 1310, 3103, 85, 173, "Input",ExpressionUUID->"79e776f8-5d55-42c7-9f7c-36239325751b"],
Cell[CellGroupData[{
Cell[46926, 1399, 670, 19, 60, "Input",ExpressionUUID->"5b6ede48-f3e7-4ecd-93bb-843cb361f62d"],
Cell[47599, 1420, 1456, 41, 142, "Output",ExpressionUUID->"34353891-f480-4a0a-8aa8-7516529fdce0"]
}, Open  ]],
Cell[49070, 1464, 1619, 42, 138, "Input",ExpressionUUID->"26e93dce-e2a7-4002-b538-bc7ba35e95dc"],
Cell[CellGroupData[{
Cell[50714, 1510, 604, 18, 60, "Input",ExpressionUUID->"da5f927b-df81-4a98-a1a4-457fda884d7e"],
Cell[51321, 1530, 1406, 39, 142, "Output",ExpressionUUID->"44387381-57aa-485a-94cc-489cdd6104c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52764, 1574, 923, 27, 61, "Input",ExpressionUUID->"e5c1536d-61e0-4ad5-bafa-b8b0e41641d8"],
Cell[53690, 1603, 1123, 33, 142, "Output",ExpressionUUID->"63960d81-c6c6-4cff-87ac-8786053e2c6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54850, 1641, 1321, 39, 61, "Input",ExpressionUUID->"a46eec44-6775-4743-9951-c972141d5818"],
Cell[56174, 1682, 1151, 34, 142, "Output",ExpressionUUID->"77b125d7-5427-45a7-b248-e3a7417884f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57362, 1721, 982, 28, 61, "Input",ExpressionUUID->"95786a3a-f664-43b7-8ae0-9801eab0caf1"],
Cell[58347, 1751, 1342, 37, 142, "Output",ExpressionUUID->"db8c084a-c61e-48f6-83b4-ca9e2c3b407e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59726, 1793, 1063, 30, 61, "Input",ExpressionUUID->"88a4c135-cc87-4230-bba4-b85068280d94"],
Cell[60792, 1825, 1393, 38, 142, "Output",ExpressionUUID->"a1516bbb-020a-4bbb-a5ae-91520162fb34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62222, 1868, 969, 28, 61, "Input",ExpressionUUID->"85665344-b85f-4ad3-8eac-297ff6533607"],
Cell[63194, 1898, 1123, 33, 142, "Output",ExpressionUUID->"d9a478cd-e796-452c-aeba-7f2848d1afc6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64354, 1936, 252, 7, 56, "Input",ExpressionUUID->"7c6c5bba-8e80-4d2f-8565-ec13c29e90c3"],
Cell[64609, 1945, 1403, 42, 141, "Output",ExpressionUUID->"5f5ede85-be9c-476a-8cd7-62c7a3038ef4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66049, 1992, 348, 10, 56, "Input",ExpressionUUID->"be92ecd5-cfc8-4fdf-8f0f-e47f1222208e"],
Cell[66400, 2004, 2705, 78, 209, "Output",ExpressionUUID->"19830707-1ff7-4e94-a1d1-7f41163e0c3e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69142, 2087, 388, 11, 56, "Input",ExpressionUUID->"5c954a6c-b7b8-4b11-b794-9aeda119dbee"],
Cell[69533, 2100, 1828, 52, 143, "Output",ExpressionUUID->"e68c31e7-60d7-4a46-9ebc-3e171a0a1ab4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71398, 2157, 841, 23, 60, "Input",ExpressionUUID->"960626d9-4ad8-49a0-99a5-7a7f742d01a7"],
Cell[72242, 2182, 904, 26, 112, "Output",ExpressionUUID->"274b57ef-5517-4010-849c-27bf8ba6ea54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73183, 2213, 274, 6, 51, "Input",ExpressionUUID->"c9a066fb-63c3-41c9-9c53-03b2935db47a"],
Cell[73460, 2221, 875, 25, 112, "Output",ExpressionUUID->"c9f5201c-22ec-4457-8c27-7da39d471f8e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74372, 2251, 204, 4, 51, "Input",ExpressionUUID->"bb04a0cb-01c6-4527-9e27-d2d2ca67c08b"],
Cell[74579, 2257, 14653, 331, 191, "Output",ExpressionUUID->"f16672f1-7921-44ae-8e94-bdcd848fbc19"]
}, Open  ]],
Cell[89247, 2591, 627, 15, 37, "Input",ExpressionUUID->"08563147-b2f3-4181-8458-bfb5b0b201f9"],
Cell[89877, 2608, 1043, 29, 64, "Input",ExpressionUUID->"121cd6bf-97bb-4c80-b9c7-26f8f8aea440"],
Cell[90923, 2639, 275, 6, 51, "Input",ExpressionUUID->"759a7238-e1f5-4e67-a9bc-6cab7cd6977b"],
Cell[CellGroupData[{
Cell[91223, 2649, 480, 14, 57, "Input",ExpressionUUID->"0cfa86d4-f913-47bc-aea1-45aabdb5de3a"],
Cell[91706, 2665, 269, 6, 56, "Output",ExpressionUUID->"018069cf-23c3-423b-895b-f91988d5c9d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92012, 2676, 551, 16, 57, "Input",ExpressionUUID->"cc251418-47a0-41bc-85d4-300753e6868f"],
Cell[92566, 2694, 211, 5, 56, "Output",ExpressionUUID->"34309187-42a5-4e53-b05c-4e5a87cbee4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92814, 2704, 220, 5, 51, "Input",ExpressionUUID->"9ee7effa-2255-403a-81e2-722af42238f1"],
Cell[93037, 2711, 1907, 51, 135, "Output",ExpressionUUID->"8ef5a49e-a247-46f0-b865-4f5ea8ede3a5"]
}, Open  ]],
Cell[94959, 2765, 234, 5, 51, "Input",ExpressionUUID->"41ef57ca-0475-4a3a-992c-369bedd1e7f9"],
Cell[95196, 2772, 3290, 89, 234, "Input",ExpressionUUID->"bc71189d-165e-4785-b0a1-3c0432a9c227"],
Cell[98489, 2863, 444, 13, 51, "Input",ExpressionUUID->"261413f0-a242-4ce8-8482-30428f1a9748"],
Cell[CellGroupData[{
Cell[98958, 2880, 192, 4, 51, "Input",ExpressionUUID->"d39ebaea-3616-47a9-82a7-c530a15df48e"],
Cell[99153, 2886, 850, 25, 112, "Output",ExpressionUUID->"ea911595-cb31-4f27-b41c-7203b7160ce8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100040, 2916, 228, 5, 51, "Input",ExpressionUUID->"66d83fb5-11da-404e-a29f-c7132c080330"],
Cell[100271, 2923, 827, 24, 112, "Output",ExpressionUUID->"12376e5c-abd5-4830-b119-fee15b5abb23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101135, 2952, 662, 18, 57, "Input",ExpressionUUID->"9b2b4e70-723c-4f1d-98d2-88b3b4f3e696"],
Cell[101800, 2972, 1510, 43, 112, "Output",ExpressionUUID->"4cd398bf-7624-4bbd-8025-5ae023374751"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103347, 3020, 1160, 33, 111, "Input",ExpressionUUID->"56a249e6-3ff3-41c3-bcd8-d5436c6afbd2"],
Cell[104510, 3055, 1475, 41, 93, "Output",ExpressionUUID->"eda5cb44-ef82-4d8c-8165-e6f8873a75d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106022, 3101, 613, 17, 57, "Input",ExpressionUUID->"0d8cdfd1-d8f2-49f9-b34d-21eb40ff01ab"],
Cell[106638, 3120, 172, 4, 56, "Output",ExpressionUUID->"cf286aca-cfc0-4218-865c-391d48a1056e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[106859, 3130, 157, 3, 65, "Section",ExpressionUUID->"1be9b2c9-c3b7-41d3-b462-d2c48b4c6d91"],
Cell[107019, 3135, 6515, 185, 428, "Input",ExpressionUUID->"4d1a5e2e-62c5-41c5-b4be-0bc48e3a1dc6"],
Cell[113537, 3322, 2046, 55, 194, "Input",ExpressionUUID->"045e8fa5-325d-4309-a457-5decebae6c81"],
Cell[115586, 3379, 477, 12, 37, "Input",ExpressionUUID->"6d6e8817-a0b9-45d5-af65-7ff62f906016"],
Cell[116066, 3393, 422, 12, 37, "Input",ExpressionUUID->"45ef531b-1765-4ef1-87cf-b41e5fe46eaa"],
Cell[116491, 3407, 3819, 109, 272, "Input",ExpressionUUID->"ae9cbb88-6b6a-421b-af96-24713960e0a0"],
Cell[120313, 3518, 480, 15, 37, "Input",ExpressionUUID->"b90189ee-5b91-49a2-8eb2-da70cc558a5a"],
Cell[120796, 3535, 304, 7, 37, "Input",ExpressionUUID->"ceb2a796-8629-468b-8619-1b823d1ea7b7"],
Cell[CellGroupData[{
Cell[121125, 3546, 346, 8, 37, "Input",ExpressionUUID->"9aba72ab-5a72-451f-a28b-d7f1db489ad6"],
Cell[121474, 3556, 687, 20, 101, "Output",ExpressionUUID->"24d14699-1d03-4685-9c1a-8b7aa4a726b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122198, 3581, 527, 12, 37, "Input",ExpressionUUID->"a155b74a-c7f1-4e49-91d0-54ed0acf19eb"],
Cell[122728, 3595, 775, 22, 101, "Output",ExpressionUUID->"ea5ef367-13ed-4571-87b3-692c541535da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123540, 3622, 281, 5, 37, "Input",ExpressionUUID->"4fc5a719-ba16-4838-9dc6-3ed93419cfcc"],
Cell[123824, 3629, 614, 17, 92, "Output",ExpressionUUID->"34129009-4865-46ed-9d78-4ddce8d8dd48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124475, 3651, 605, 17, 37, "Input",ExpressionUUID->"7f9fb8ed-09e0-424c-9d7f-8cc93da917fe"],
Cell[125083, 3670, 287, 6, 65, "Output",ExpressionUUID->"657ca382-49c0-479c-8cf2-3bcba1f4f25a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125407, 3681, 1163, 32, 89, "Input",ExpressionUUID->"111d358f-33b6-4eb5-8d69-0b7e77ac6c40"],
Cell[126573, 3715, 2980, 87, 165, "Output",ExpressionUUID->"a7917eee-711f-4778-8f35-06a6165db819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129590, 3807, 307, 7, 37, "Input",ExpressionUUID->"facb7990-5639-495c-8ca0-d387c822b27c"],
Cell[129900, 3816, 229, 5, 65, "Output",ExpressionUUID->"14b6529b-6d38-48e9-9745-b299953a7ccc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130166, 3826, 861, 23, 37, "Input",ExpressionUUID->"adc1f296-ee46-4626-b295-2b07f92eb5b5"],
Cell[131030, 3851, 2945, 87, 145, "Output",ExpressionUUID->"e3a6dcf3-adbf-43a0-ab6f-df2c992336e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134012, 3943, 281, 7, 37, "Input",ExpressionUUID->"610b4554-fe55-4cc6-832b-a5a09b52fddd"],
Cell[134296, 3952, 229, 5, 65, "Output",ExpressionUUID->"1135716c-5db7-4d3d-81bb-04b49e676f29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134562, 3962, 636, 17, 37, "Input",ExpressionUUID->"39c784ca-6c61-4f46-9d85-231363471a5c"],
Cell[135201, 3981, 576, 15, 60, "Output",ExpressionUUID->"7082f27c-2d36-4387-a0e5-c568eeddf686"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135814, 4001, 305, 7, 37, "Input",ExpressionUUID->"fe0a659d-e5a5-4ea6-8bec-bbe20c8b8156"],
Cell[136122, 4010, 262, 6, 65, "Output",ExpressionUUID->"4962f8b3-c7fc-445e-b23e-52401b9d1f0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136421, 4021, 397, 10, 37, "Input",ExpressionUUID->"0bcfc480-eeaf-4b29-81a8-869a0a7e88ff"],
Cell[136821, 4033, 2915, 88, 177, "Output",ExpressionUUID->"7d84f6e1-f987-4cc1-899c-0a8d1b2cb8b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139773, 4126, 426, 11, 37, "Input",ExpressionUUID->"8290ba41-426e-4706-ac09-54912b6004ff"],
Cell[140202, 4139, 552, 17, 59, "Output",ExpressionUUID->"89e3f81e-4b5e-4436-90cd-ee618633655e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140791, 4161, 668, 19, 89, "Input",ExpressionUUID->"35baa890-c96e-44ef-b2e6-445cd6cff8ed"],
Cell[141462, 4182, 335, 9, 87, "Output",ExpressionUUID->"e5044c4e-8fb4-4e7a-aa7b-f61fe9dc3fe3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141834, 4196, 363, 8, 37, "Input",ExpressionUUID->"d6eb67c4-26c5-4e64-9599-cfe3ad0dddce"],
Cell[142200, 4206, 4394, 128, 290, "Output",ExpressionUUID->"ae93e725-9349-403b-9f59-f288c3bd9271"]
}, Open  ]],
Cell[146609, 4337, 214, 6, 51, "Input",ExpressionUUID->"b1da47d4-04fa-4427-b1b0-fc94438a36b3"],
Cell[CellGroupData[{
Cell[146848, 4347, 390, 9, 51, "Input",ExpressionUUID->"8912e85d-e524-4160-a1d3-3f4c7387864c"],
Cell[147241, 4358, 241, 6, 57, "Output",ExpressionUUID->"19812d85-b43b-4328-b7e0-76dd83d35d06"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147519, 4369, 1024, 29, 111, "Input",ExpressionUUID->"845512b2-ab41-4c49-b548-756d1fb9f934"],
Cell[148546, 4400, 2115, 59, 142, "Output",ExpressionUUID->"adae10cf-e031-4bb3-ac46-ac0e313d0e19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150698, 4464, 648, 19, 60, "Input",ExpressionUUID->"ee33900b-7ab8-41a2-ac3c-fef45fa675b5"],
Cell[151349, 4485, 803, 22, 112, "Output",ExpressionUUID->"b229a221-3eb4-4854-93f0-e840297ad606"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152189, 4512, 559, 15, 57, "Input",ExpressionUUID->"134ee038-3360-4e35-bf06-2d85138c1b27"],
Cell[152751, 4529, 238, 4, 56, "Output",ExpressionUUID->"adbdb48b-2c67-48c2-be1b-72018a51057d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153026, 4538, 155, 3, 51, "Input",ExpressionUUID->"77b84ff8-9df1-41e5-baa1-9817d58179a8"],
Cell[153184, 4543, 801, 22, 112, "Output",ExpressionUUID->"29b09ec2-078d-4338-96c1-6c0d88fb4e81"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154022, 4570, 650, 17, 57, "Input",ExpressionUUID->"d4a24464-b2fd-4b93-86d7-46ced8ebdd69"],
Cell[154675, 4589, 2218, 62, 142, "Output",ExpressionUUID->"831cebd8-cd2a-4299-b275-10397279a3e1"]
}, Open  ]],
Cell[156908, 4654, 282, 7, 51, "Input",ExpressionUUID->"9148d86e-9a9e-4d88-b2b3-babe7181b513"],
Cell[CellGroupData[{
Cell[157215, 4665, 749, 20, 83, "Input",ExpressionUUID->"2992a63c-e071-4764-b383-8a602b82052d"],
Cell[157967, 4687, 1999, 57, 142, "Output",ExpressionUUID->"67f391b2-518f-49f2-8cb6-3cc680ca141f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[160015, 4750, 155, 3, 84, "Section",ExpressionUUID->"21059e37-b3cd-46a4-b0ef-a91f81951802"],
Cell[160173, 4755, 273, 6, 44, "Text",ExpressionUUID->"ff91e138-f5d2-498d-9b11-07f8ec70b9d0"],
Cell[CellGroupData[{
Cell[160471, 4765, 211, 4, 37, "Input",ExpressionUUID->"57391481-107d-43a8-b290-c8ce7660e390"],
Cell[160685, 4771, 18062, 377, 192, "Output",ExpressionUUID->"be960bef-284c-4a1e-b46b-4ad0b243cddd"]
}, Open  ]],
Cell[178762, 5151, 485, 16, 37, "Input",ExpressionUUID->"72b2b114-2ef1-4a78-b9ce-edd7727a22ad"],
Cell[CellGroupData[{
Cell[179272, 5171, 307, 7, 37, "Input",ExpressionUUID->"584f949e-20aa-4d6e-9fff-9a7526689a44"],
Cell[179582, 5180, 562, 17, 86, "Output",ExpressionUUID->"c37f934c-0040-4aa2-8b3e-29c23587db9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180181, 5202, 771, 23, 85, "Input",ExpressionUUID->"fc78bac0-d315-4c93-81c4-4f7f36c95ea2"],
Cell[180955, 5227, 769, 23, 86, "Output",ExpressionUUID->"4f0f4383-6ea3-4dcc-b6bb-6473a33a775c"]
}, Open  ]],
Cell[181739, 5253, 2050, 56, 194, "Input",ExpressionUUID->"ec098952-806e-415d-93cb-91589a7cbd99"],
Cell[CellGroupData[{
Cell[183814, 5313, 476, 14, 61, "Input",ExpressionUUID->"c5c9c8f4-f2e4-465c-82f8-bda597f3c6e5"],
Cell[184293, 5329, 409, 13, 101, "Output",ExpressionUUID->"ea99c396-c04c-4cd4-a143-b03329fbf4d6"]
}, Open  ]],
Cell[184717, 5345, 6520, 186, 428, "Input",ExpressionUUID->"f1f97781-d8ff-4964-883a-618cc3c3a4af"],
Cell[CellGroupData[{
Cell[191262, 5535, 607, 18, 37, "Input",ExpressionUUID->"5f27ccc6-8e38-4eb6-b7f8-2098f243f70d"],
Cell[191872, 5555, 214, 6, 65, "Output",ExpressionUUID->"90465d08-0c1d-4528-aa89-b2dafdfa33e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192123, 5566, 608, 20, 83, "Input",ExpressionUUID->"1da3b12f-e1ae-4462-8272-74e7b1536f69"],
Cell[192734, 5588, 920, 31, 102, "Output",ExpressionUUID->"7459c0af-7dca-4ed9-a887-5070cea60ffd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193691, 5624, 777, 23, 83, "Input",ExpressionUUID->"3abb9dad-b555-4ea3-8a27-ed6c2ac266a8"],
Cell[194471, 5649, 683, 22, 110, "Output",ExpressionUUID->"510e4942-7fbc-4660-b2a9-b20029d3ba1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195191, 5676, 859, 27, 83, "Input",ExpressionUUID->"2f32e0ca-6f5b-4a06-a523-d1b2284edbe3"],
Cell[196053, 5705, 289, 7, 43, "Output",ExpressionUUID->"edd2c3f6-155a-45e9-a8b0-1e873e12c2cf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196391, 5718, 184, 3, 84, "Section",ExpressionUUID->"d0a45264-4a8c-4b74-8d9f-1a230b4ecdd6"],
Cell[CellGroupData[{
Cell[196600, 5725, 952, 27, 46, "Input",ExpressionUUID->"1b9139c4-bcd0-4069-af4b-544c71223521"],
Cell[197555, 5754, 1032, 28, 52, "Output",ExpressionUUID->"19b2ae1b-98cc-45cf-b151-92a060be8aa6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198624, 5787, 963, 26, 46, "Input",ExpressionUUID->"bb899152-6557-418c-ab74-4016026b16aa"],
Cell[199590, 5815, 934, 25, 52, "Output",ExpressionUUID->"db80e88d-8c35-4410-b841-be4869633fb2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200561, 5845, 1038, 28, 46, "Input",ExpressionUUID->"b030586e-b8ab-4640-96d7-d1ba2480a558"],
Cell[201602, 5875, 958, 26, 52, "Output",ExpressionUUID->"ef78b153-7454-4b26-84fe-ae47634f7c5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202597, 5906, 1016, 27, 57, "Input",ExpressionUUID->"ff4d1d51-d7de-4ebd-a1c0-6c600c9e2500"],
Cell[203616, 5935, 1136, 34, 74, "Output",ExpressionUUID->"24d4f7f1-112b-41c5-87fa-954634df989d"]
}, Open  ]],
Cell[204767, 5972, 481, 15, 46, "Input",ExpressionUUID->"76c4fa5c-6fca-4c4c-afb2-87621d7ac103"],
Cell[CellGroupData[{
Cell[205273, 5991, 1016, 27, 57, "Input",ExpressionUUID->"c7139be1-9917-4782-8878-26e495f44686"],
Cell[206292, 6020, 1884, 57, 200, "Output",ExpressionUUID->"6857c9cb-3c8c-4406-946a-221661483893"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208213, 6082, 1038, 28, 57, "Input",ExpressionUUID->"f2b0c5ba-93cb-43b9-ac13-d414864c2565"],
Cell[209254, 6112, 1169, 32, 111, "Output",ExpressionUUID->"6b06fdf0-a2b1-4549-8597-8a25e5413858"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210460, 6149, 1003, 27, 57, "Input",ExpressionUUID->"26b395a3-6cbf-4dc6-b29a-a7516658fe0c"],
Cell[211466, 6178, 1035, 29, 134, "Output",ExpressionUUID->"b0c41c7b-1faa-4d9b-8dc6-1bbe31ef00fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212538, 6212, 1069, 27, 57, "Input",ExpressionUUID->"ad243b3c-a4a2-4e75-b1c6-39a879f79df0"],
Cell[213610, 6241, 962, 28, 171, "Output",ExpressionUUID->"43c0b20f-d811-4c14-b093-e554a1419959"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214609, 6274, 355, 8, 46, "Input",ExpressionUUID->"b19c5d44-a14e-4246-821b-02b569e860c3"],
Cell[214967, 6284, 363, 8, 69, "Output",ExpressionUUID->"0ee35e82-9a27-4236-80c4-9a16227a0f57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215367, 6297, 760, 19, 78, "Input",ExpressionUUID->"1f1b7f6e-9439-45bd-b80b-d036c90a1537"],
Cell[216130, 6318, 361, 8, 69, "Output",ExpressionUUID->"c8245a83-4230-4875-835a-2add5520d487"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216528, 6331, 1275, 36, 89, "Input",ExpressionUUID->"7ed3251c-181a-4b82-875e-5b5298c24232"],
Cell[217806, 6369, 156, 2, 69, "Output",ExpressionUUID->"45e62ff6-9fd0-406c-8677-267d27e2284a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217999, 6376, 1308, 36, 89, "Input",ExpressionUUID->"389896b4-b66d-4b73-b603-04c1e4d6c53c"],
Cell[219310, 6414, 848, 23, 115, "Output",ExpressionUUID->"d3391952-48bc-4997-a453-75e195f0c553"]
}, Open  ]],
Cell[220173, 6440, 481, 15, 46, "Input",ExpressionUUID->"f16ccbfa-9fbd-4d12-97c8-2c69a93512da"],
Cell[CellGroupData[{
Cell[220679, 6459, 789, 23, 88, "Input",ExpressionUUID->"1968cdd8-5e6a-4b89-8657-8da20adaf73d"],
Cell[221471, 6484, 761, 23, 171, "Output",ExpressionUUID->"75458bd9-31c4-4f68-856e-fdb9711df49a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222269, 6512, 1066, 31, 88, "Input",ExpressionUUID->"992a12e3-da62-4f8f-b986-f42a5fb09b75"],
Cell[223338, 6545, 1092, 30, 111, "Output",ExpressionUUID->"8104a9f1-fe41-4703-89da-2d0fef93e639"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224467, 6580, 1618, 42, 121, "Input",ExpressionUUID->"4693c279-c9f9-4db7-88cc-f08b807b10f8"],
Cell[226088, 6624, 932, 27, 171, "Output",ExpressionUUID->"1b542c6a-e8b3-4d24-b1b3-a259e717e724"]
}, Closed]],
Cell[CellGroupData[{
Cell[227057, 6656, 1756, 44, 113, "Input",ExpressionUUID->"7683fc8c-1db8-441c-b0bf-7b8c9f2e72f1"],
Cell[228816, 6702, 1135, 31, 171, "Output",ExpressionUUID->"34ce97a6-df41-4bc0-8f90-3419e53bc32d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229988, 6738, 1101, 28, 88, "Input",ExpressionUUID->"401dc140-18aa-4dd2-9c9a-bde48c92fdc9"],
Cell[231092, 6768, 1066, 30, 171, "Output",ExpressionUUID->"f9c72af4-69a9-4669-a4c7-7921d57755ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232195, 6803, 1727, 43, 121, "Input",ExpressionUUID->"805b24ef-d036-4891-9376-3c54663f6520"],
Cell[233925, 6848, 1183, 32, 111, "Output",ExpressionUUID->"4eb4bf5e-df53-494a-949c-344382505223"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235145, 6885, 1568, 43, 152, "Input",ExpressionUUID->"908f5043-bfd1-4e28-aeeb-5efae5f68ec5"],
Cell[236716, 6930, 1067, 30, 171, "Output",ExpressionUUID->"da2da491-7f8d-4afb-87e9-511751218ed0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[237832, 6966, 166, 3, 101, "Section",ExpressionUUID->"f992fd5b-4436-408f-ad5f-21679ddd77e5"],
Cell[238001, 6971, 523, 16, 46, "Input",ExpressionUUID->"f4cc0a8b-1ef8-4a2f-b24b-475cc36d29ff"],
Cell[CellGroupData[{
Cell[238549, 6991, 917, 21, 78, "Input",ExpressionUUID->"e69625a2-53e9-4efa-91dd-aea8e52c9d76"],
Cell[239469, 7014, 1031, 29, 144, "Output",ExpressionUUID->"47a51776-4dc0-4b46-997b-7542daeea3a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240537, 7048, 1095, 28, 78, "Input",ExpressionUUID->"afd9f0b9-47e5-4c6f-af45-ea98954df86a"],
Cell[241635, 7078, 992, 27, 98, "Output",ExpressionUUID->"77a1a3fd-4649-4c43-85ac-ef46a1bce82c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242664, 7110, 1031, 25, 78, "Input",ExpressionUUID->"7856fdcd-9455-408b-a732-9dc6900008fd"],
Cell[243698, 7137, 1200, 34, 144, "Output",ExpressionUUID->"076c60c1-0f0b-4bc9-920e-bbd1236e3658"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244935, 7176, 1614, 40, 109, "Input",ExpressionUUID->"5db62e8e-d654-4180-af3d-85450e315f77"],
Cell[246552, 7218, 1025, 30, 142, "Output",ExpressionUUID->"07ea4484-31b5-4777-8e5f-9899981be6f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247614, 7253, 1281, 35, 109, "Input",ExpressionUUID->"b2b6dd47-4f74-4aee-99a0-186143bb0a94"],
Cell[248898, 7290, 836, 25, 132, "Output",ExpressionUUID->"56025d7c-d64a-4ee5-a20c-503bbff835d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249771, 7320, 1175, 33, 109, "Input",ExpressionUUID->"157b8845-a872-49bc-b185-33a9241ee18d"],
Cell[250949, 7355, 916, 25, 98, "Output",ExpressionUUID->"0f7a5de0-632d-4f10-8a9c-a360065c5812"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251902, 7385, 1393, 39, 171, "Input",ExpressionUUID->"404894a6-8dc6-4773-94f7-c05540f8aead"],
Cell[253298, 7426, 1165, 34, 144, "Output",ExpressionUUID->"f0abaa90-0f1e-43b1-81f3-e4e18e12845d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254500, 7465, 1442, 39, 140, "Input",ExpressionUUID->"faf6560a-a3ef-44a5-967e-9a86abce4a21"],
Cell[255945, 7506, 1072, 31, 144, "Output",ExpressionUUID->"52edb2c7-10d8-4287-9b49-8395d64cb23a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[257054, 7542, 1727, 43, 121, "Input",ExpressionUUID->"c02d2508-4732-4d35-9e3a-92b405390fda"],
Cell[258784, 7587, 1183, 32, 111, "Output",ExpressionUUID->"28f8e4cd-4ddc-4475-ac6f-1482fad18a46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260004, 7624, 1568, 43, 152, "Input",ExpressionUUID->"7ccf72fd-87dd-4165-9276-a451329c78c7"],
Cell[261575, 7669, 1067, 30, 171, "Output",ExpressionUUID->"fb1e072e-7e89-46d3-b3e0-33064d9d87f2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[262691, 7705, 220, 4, 101, "Section",ExpressionUUID->"4c953b24-7180-4983-8f5c-89e8007573ee"],
Cell[262914, 7711, 523, 16, 46, "Input",ExpressionUUID->"8a8a3f2c-ab78-4648-a677-a0f88722e895"],
Cell[CellGroupData[{
Cell[263462, 7731, 963, 21, 78, "Input",ExpressionUUID->"f1269ddf-3768-4558-b499-356b63342f5d"],
Cell[264428, 7754, 1057, 30, 144, "Output",ExpressionUUID->"d0d2e7f2-7edc-4212-9dce-5ed7721b59f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265522, 7789, 1168, 29, 78, "Input",ExpressionUUID->"15935cfe-ec12-4fb9-858f-ee22e04fcc8d"],
Cell[266693, 7820, 1009, 26, 98, "Output",ExpressionUUID->"4c304d9a-3cf6-4c23-827f-c938e2b86b90"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267739, 7851, 1077, 25, 64, "Input",ExpressionUUID->"6643b34c-1b7c-4425-8248-34a2d951e63a"],
Cell[268819, 7878, 1222, 34, 112, "Output",ExpressionUUID->"d2e97bbc-e314-44e8-8f5f-08c763571932"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270078, 7917, 1687, 41, 90, "Input",ExpressionUUID->"0d5c94af-0e16-46d2-9fd9-927b48cbc478"],
Cell[271768, 7960, 1142, 32, 112, "Output",ExpressionUUID->"bfc11b04-c78c-4cd5-b5bc-ae6c76bacd97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[272947, 7997, 1332, 36, 64, "Input",ExpressionUUID->"a1161b87-74ce-495e-8db6-9cc8f490e558"],
Cell[274282, 8035, 858, 25, 101, "Output",ExpressionUUID->"93d3ff6c-d448-419f-a585-d3d54ce2a898"]
}, Open  ]],
Cell[CellGroupData[{
Cell[275177, 8065, 1293, 34, 90, "Input",ExpressionUUID->"f8e56b10-77d3-4b7f-911b-cc544bc913ff"],
Cell[276473, 8101, 917, 25, 69, "Output",ExpressionUUID->"b04d9061-9ff9-4085-b09b-773f38876e8e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277427, 8131, 1642, 44, 168, "Input",ExpressionUUID->"0f6c90e1-dbec-4342-bebc-ad8a3a89c4e3"],
Cell[279072, 8177, 1264, 36, 112, "Output",ExpressionUUID->"bc5966ae-8ecd-4590-9a47-b01cf25f0990"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280373, 8218, 1546, 40, 90, "Input",ExpressionUUID->"2a6a7aa7-a0d7-4f98-b15b-728f6b107d49"],
Cell[281922, 8260, 1120, 32, 112, "Output",ExpressionUUID->"91755abc-ff61-4a89-9609-20cd0eacf640"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283079, 8297, 1111, 27, 64, "Input",ExpressionUUID->"19bcd6fb-4a66-4cf9-b6fd-9a39613b6611"],
Cell[284193, 8326, 613, 17, 69, "Output",ExpressionUUID->"885e7c1c-f318-4e2e-8d1a-bde06fe5b800"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[284855, 8349, 150, 3, 84, "Section",ExpressionUUID->"aba2f5ee-adba-4e13-8c75-8a7b3c477c3a"],
Cell[285008, 8354, 910, 19, 51, "Input",ExpressionUUID->"e10a92f1-b622-4a78-ba26-e61fb055b877"],
Cell[285921, 8375, 738, 20, 51, "Input",ExpressionUUID->"e6a0c38f-17e1-4eec-879d-95103a4d4b2d"],
Cell[CellGroupData[{
Cell[286684, 8399, 360, 8, 51, "Input",ExpressionUUID->"48ea4ba3-cd1e-498c-afc4-ba83c9313d08"],
Cell[287047, 8409, 269, 7, 57, "Output",ExpressionUUID->"97934acf-a946-464f-9980-a9a05a25c429"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[287365, 8422, 165, 3, 65, "Section",ExpressionUUID->"ba374f26-e590-499a-b3ba-c61696cf9f0a"],
Cell[CellGroupData[{
Cell[287555, 8429, 217, 4, 51, "Input",ExpressionUUID->"3f9d5b9f-105d-4791-97c4-f335a7fd5703"],
Cell[287775, 8435, 25563, 523, 220, "Output",ExpressionUUID->"bcb7257e-1aff-4f3b-8df8-5cfb9235b345"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313375, 8963, 222, 4, 51, "Input",ExpressionUUID->"87a99573-eef5-48cc-ba96-24ef1eea8e24"],
Cell[313600, 8969, 19067, 391, 249, "Output",ExpressionUUID->"b9076500-f4ca-4535-9f5a-5ab8408e88e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332704, 9365, 591, 16, 51, "Input",ExpressionUUID->"1d7e6260-0a4c-4145-b405-1c54bb60637f"],
Cell[333298, 9383, 737, 24, 126, "Output",ExpressionUUID->"43da80bc-ea05-4e7b-b336-65451ee9fcae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[334072, 9412, 675, 17, 51, "Input",ExpressionUUID->"9917c74a-a397-4c29-8640-d78dc10f4ff4"],
Cell[334750, 9431, 763, 24, 126, "Output",ExpressionUUID->"9bd32e12-24e6-4a2a-b623-6673e754975b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335550, 9460, 601, 16, 51, "Input",ExpressionUUID->"31075be0-f3cd-45b1-b37c-d401e4758531"],
Cell[336154, 9478, 367, 10, 57, "Output",ExpressionUUID->"692b3eec-0202-4118-b301-83faf19a606d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336558, 9493, 684, 17, 51, "Input",ExpressionUUID->"60ba7fe3-c595-4f20-89d9-a772824df1e9"],
Cell[337245, 9512, 390, 10, 57, "Output",ExpressionUUID->"d5759620-3680-4856-8d25-a56603f18a18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[337672, 9527, 604, 15, 51, "Input",ExpressionUUID->"71a19d0f-f8fd-484a-ab12-7590d6135240"],
Cell[338279, 9544, 365, 10, 57, "Output",ExpressionUUID->"5bf78a24-3277-4361-b4ba-b3de034ac0a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[338681, 9559, 706, 17, 51, "Input",ExpressionUUID->"5564adcb-fb56-4449-a737-b297c5a3c04d"],
Cell[339390, 9578, 351, 9, 57, "Output",ExpressionUUID->"5b6a34ea-24c9-4981-9a2e-9841248cc379"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339778, 9592, 629, 16, 51, "Input",ExpressionUUID->"f844674b-1278-4033-aefc-c3d57eb0d81d"],
Cell[340410, 9610, 418, 11, 57, "Output",ExpressionUUID->"e837cb06-cf71-4c3a-aee5-155eec1b8889"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340865, 9626, 511, 13, 51, "Input",ExpressionUUID->"f39074d0-de06-40c2-bf5e-b5e6b4bfdae2"],
Cell[341379, 9641, 268, 7, 57, "Output",ExpressionUUID->"5531627e-6c24-4e71-b114-5d12da71b4a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[341684, 9653, 719, 18, 51, "Input",ExpressionUUID->"bdafc937-4133-4c0e-8c39-90fe7b090980"],
Cell[342406, 9673, 169, 3, 56, "Output",ExpressionUUID->"4ee0b6e7-b98a-44fe-adda-95e55e34c5ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[342612, 9681, 446, 10, 51, "Input",ExpressionUUID->"32ed8e59-343a-4d5a-aad3-0949fc9167a2"],
Cell[343061, 9693, 169, 3, 56, "Output",ExpressionUUID->"52fd7469-12e8-4f3d-8f4b-1f27ad354e41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343267, 9701, 491, 12, 51, "Input",ExpressionUUID->"63547f43-d590-4d5f-bf05-f4f44a678da8"],
Cell[343761, 9715, 169, 3, 56, "Output",ExpressionUUID->"fdb64f8d-f6a5-4bcd-99db-23ae48345f9c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343967, 9723, 594, 14, 51, "Input",ExpressionUUID->"66c95a19-af6e-43d4-9479-4aedf1dcedf3"],
Cell[344564, 9739, 243, 4, 56, "Output",ExpressionUUID->"99f22200-e4e5-48dc-b0a4-48464e4ec172"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344844, 9748, 431, 11, 51, "Input",ExpressionUUID->"0c186a55-2d7c-4284-9808-91b756a8ae16"],
Cell[345278, 9761, 521, 11, 35, "Message",ExpressionUUID->"1d2783fc-0b79-4c21-ab62-760cc443b07d"],
Cell[345802, 9774, 809, 15, 57, "Message",ExpressionUUID->"00912ab6-2a22-41d8-925e-5dac1c759829"],
Cell[346614, 9791, 204, 3, 56, "Output",ExpressionUUID->"8bb73409-476f-4222-a764-bf90703bd3cd"]
}, Open  ]]
}, Closed]]
}
]
*)

