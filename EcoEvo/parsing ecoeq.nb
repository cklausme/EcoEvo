(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    232443,       4690]
NotebookOptionsPosition[    224406,       4537]
NotebookOutlinePosition[    225982,       4576]
CellTagsIndexPosition[    225886,       4570]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["*EcoEq: SolveEcoEq / NSolveEcoEq / FindEcoEq", "Subsection",
 CellChangeTimes->{{3.6954006453555927`*^9, 3.6954006557460127`*^9}, {
   3.6962556239228687`*^9, 3.696255625343861*^9}, 3.699565737020871*^9},
 CellTags->{
  "1.7.0", "1.7.1"},ExpressionUUID->"00cd7117-b6cd-4a16-b559-b50803931bc0"],

Cell[CellGroupData[{

Cell["Usage", "Subsubsection",
 CellChangeTimes->{{3.769494692292095*^9, 
  3.769494692848196*^9}},ExpressionUUID->"d60e9445-48fe-419b-9155-\
c309298ab8ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EcoEq", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<EcoEq[] solves for ecological equilibria.\n\
EcoEq[\!\(\*StyleBox[\"init\", \"TI\"]\)] finds an ecological equilibrium \
using initial guess \!\(\*StyleBox[\"init\", \"TI\"]\).\n\
EcoEq[\!\(\*StyleBox[\"attributes\", \"TI\"]\)] uses trait values/interaction \
coefficients \!\(\*StyleBox[\"attributes\", \"TI\"]\).\nEcoEq[\!\(\*StyleBox[\
\"attributes\", \"TI\"]\), \!\(\*StyleBox[\"init\", \"TI\"]\)] uses trait \
values/interaction coefficients \!\(\*StyleBox[\"attributes\", \"TI\"]\) and \
initial guess \!\(\*StyleBox[\"init\", \"TI\"]\).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SolveEcoEq", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<SolveEcoEq[] solves for ecological equilibria.\n\
SolveEcoEq[\!\(\*StyleBox[\"vars\", \"TI\"]\)] solves for variables \
\!\(\*StyleBox[\"vars\", \"TI\"]\).\n\
SolveEcoEq[\!\(\*StyleBox[\"attributes\", \"TI\"]\)] uses trait \
values/interaction coefficients \!\(\*StyleBox[\"attributes\", \"TI\"]\).\n\
SolveEcoEq[\!\(\*StyleBox[\"attributes\", \"TI\"]\), \!\(\*StyleBox[\"vars\", \
\"TI\"]\)] solves for variables \!\(\*StyleBox[\"vars\", \"TI\"]\) using \
trait values/interaction coefficients \!\(\*StyleBox[\"attributes\", \
\"TI\"]\).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NSolveEcoEq", "::", "usage"}], " ", "=", " ", "\n", 
    "\"\<NSolveEcoEq[] numerically solves for ecological equilibria.\n\
NSolveEcoEq[\!\(\*StyleBox[\"vars\", \"TI\"]\)] numerically solves for \
variables \!\(\*StyleBox[\"vars\", \"TI\"]\).\n\
NSolveEcoEq[\!\(\*StyleBox[\"attributes\", \"TI\"]\)] uses \
traits/interactions \!\(\*StyleBox[\"attributes\", \"TI\"]\).\nNSolveEcoEq[\!\
\(\*StyleBox[\"attributes\", \"TI\"]\), \!\(\*StyleBox[\"vars\", \"TI\"]\)] \
numerically solves for variables \!\(\*StyleBox[\"vars\", \"TI\"]\) using \
trait values/interaction coefficients \!\(\*StyleBox[\"attributes\", \
\"TI\"]\).\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FindEcoEq", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<FindEcoEq[\!\(\*StyleBox[\"init\", \"TI\"]\)] finds an ecological \
equilibrium using initial guess / range \!\(\*StyleBox[\"init\", \"TI\"]\).\n\
FindEcoEq[\!\(\*StyleBox[\"attributes\", \"TI\"]\), \!\(\*StyleBox[\"init\", \
\"TI\"]\)] uses trait values/interaction coefficients \
\!\(\*StyleBox[\"attributes\", \"TI\"]\) and initial guess / range \
\!\(\*StyleBox[\"init\", \"TI\"]\).\>\""}], ";"}]}], "Code",
 CellChangeTimes->{{3.76948331462147*^9, 3.769483315463594*^9}, {
  3.807375225831135*^9, 3.807375269109378*^9}, {3.807375299950779*^9, 
  3.807375331109776*^9}, {3.807375372814131*^9, 3.807375394598486*^9}, {
  3.8073754723757067`*^9, 3.807375491334848*^9}, {3.8073761836229362`*^9, 
  3.807376252238955*^9}, {3.807378136944607*^9, 3.807378170459052*^9}, {
  3.872019832401194*^9, 
  3.8720198383532343`*^9}},ExpressionUUID->"a1423a8e-1bcd-477e-8f94-\
62c6e20605f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parser", "Subsubsection",
 CellChangeTimes->{{3.895575257543274*^9, 
  3.8955752603901043`*^9}},ExpressionUUID->"0175d95c-231e-49c4-8b45-\
8b8da1aef5cc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"EcoEq", "[", "in___", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"func", "=", "EcoEq"}], ",", "args", ",", "opts", ",", "rest",
         ",", "parameters", ",", "attributes", ",", "Gs", ",", "variables", 
        ",", "variableslist", ",", "\n", "vars"}], "}"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<in=\>\"", ",", "in"}], "]"}], ";", "\n", "\n", 
       RowBox[{"args", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"ExtractArgs", "[", 
          RowBox[{
           RowBox[{"{", "in", "}"}], ",", "func"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"opts", "=", 
        RowBox[{"ExtractOpts", "[", 
         RowBox[{
          RowBox[{"{", "in", "}"}], ",", "func"}], "]"}]}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<args=\>\"", ",", "args"}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<opts=\>\"", ",", "opts"}], "]"}], ";", "\n", "\n", 
       RowBox[{"parameters", "=", 
        RowBox[{"ExtractParameters", "[", "args", "]"}]}], ";", "\n", 
       RowBox[{"attributes", "=", 
        RowBox[{"ExtractAttributes", "[", "args", "]"}]}], ";", "\n", 
       RowBox[{"Gs", "=", 
        RowBox[{"ExtractVarCovs", "[", "args", "]"}]}], ";", "\n", 
       RowBox[{"variables", "=", 
        RowBox[{"ExtractVariables", "[", "args", "]"}]}], ";", "\n", 
       RowBox[{"variableslist", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"args", ",", "RuleListQ"}], "]"}], ",", "VariablesQ"}], 
         "]"}]}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<parameters=\>\"", ",", "parameters"}], "]"}], ";", "\n", 
       
       RowBox[{"Print", "[", 
        RowBox[{"\"\<attributes=\>\"", ",", "attributes"}], "]"}], ";", "\n", 
       
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<variables=\>\"", ",", "variables"}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<variableslist=\>\"", ",", "variableslist"}], "]"}], ";", 
       "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"ExtractArgs", "[", 
          RowBox[{
           RowBox[{"{", "in", "}"}], ",", "func"}], "]"}], "}"}], "]"}], ";", 
       "\n", 
       RowBox[{"rest", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ExtractArgs", "[", 
            RowBox[{
             RowBox[{"{", "in", "}"}], ",", "func"}], "]"}], "}"}], ",", 
          RowBox[{"{", "parameters", "}"}], ",", 
          RowBox[{"{", "attributes", "}"}], ",", 
          RowBox[{"{", "Gs", "}"}], ",", 
          RowBox[{"{", "variables", "}"}], ",", "variableslist", ",", 
          RowBox[{"{", "opts", "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<rest=\>\"", ",", "rest"}], "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rest", "!=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"vars", "=", 
          RowBox[{"rest", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"vars", "=", "All"}]}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<vars=\>\"", ",", "vars"}], "]"}], ";", "\n", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"variableslist", "==", 
          RowBox[{"{", "}"}]}], ",", "\n", "\t", 
         RowBox[{"iEcoEq", "[", 
          RowBox[{
          "parameters", ",", "attributes", ",", "Gs", ",", "variables", ",", 
           "vars", ",", "opts"}], "]"}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"iEcoEq", "[", 
            RowBox[{
            "parameters", ",", "attributes", ",", "Gs", ",", "#", ",", "vars",
              ",", "opts"}], "]"}], "&"}], "/@", "variableslist"}]}], "\n", 
        "]"}]}]}], "]"}]}], ";"}], "*)"}]], "Code",
 CellChangeTimes->{{3.7127802306821003`*^9, 3.71278023163732*^9}, {
   3.769860889371685*^9, 3.769860898625585*^9}, {3.890088762767192*^9, 
   3.8900887857559834`*^9}, {3.890088825582732*^9, 3.8900888418951406`*^9}, {
   3.8900889470940847`*^9, 3.890088957136177*^9}, {3.8901267099939337`*^9, 
   3.890126710376408*^9}, {3.89012675925627*^9, 3.89012677188067*^9}, {
   3.890147666024979*^9, 3.890147669484149*^9}, {3.895556083668763*^9, 
   3.895556095879417*^9}, 3.8955566991026297`*^9, {3.8955577669801817`*^9, 
   3.8955577681779213`*^9}, {3.8955622577005453`*^9, 3.895562258529551*^9}, 
   3.89556232631433*^9, {3.89556263361314*^9, 3.8955626472449636`*^9}, {
   3.895562842722169*^9, 3.895562849597785*^9}, {3.895563092493565*^9, 
   3.895563126066338*^9}, {3.895563181729741*^9, 3.89556321475914*^9}, {
   3.895565622997553*^9, 3.895565825215711*^9}, {3.895566197384026*^9, 
   3.8955663023293247`*^9}, {3.8955663794538603`*^9, 3.895566420626652*^9}, {
   3.895567028632929*^9, 3.895567029623745*^9}, {3.895567212564479*^9, 
   3.895567218896427*^9}, {3.895567272624502*^9, 3.895567274409018*^9}, {
   3.8955675907546473`*^9, 3.895567768041896*^9}, {3.895567851076992*^9, 
   3.895567855084454*^9}, {3.895567885960531*^9, 3.8955679150019197`*^9}, {
   3.8955680083366737`*^9, 3.895568008699531*^9}, {3.895568048854352*^9, 
   3.895568157442192*^9}, {3.895568229874014*^9, 3.895568253702044*^9}, {
   3.8955693854122*^9, 3.8955694265490522`*^9}, 3.895575272473558*^9, {
   3.895575467928422*^9, 3.8955755135470257`*^9}, 3.895575682651147*^9, 
   3.895578721564733*^9, 3.895579374206821*^9, {3.89557941527911*^9, 
   3.8955794329631166`*^9}, {3.8955794748472223`*^9, 3.895579478562263*^9}, {
   3.895579560992878*^9, 3.895579561228808*^9}, {3.8955796500246983`*^9, 
   3.8955796662780857`*^9}, {3.895579769850182*^9, 3.895579777141037*^9}, {
   3.895579856895706*^9, 3.8955798595931683`*^9}, 3.895588510289165*^9, {
   3.8955886111527357`*^9, 3.895588612849946*^9}, {3.895589347468148*^9, 
   3.895589379222314*^9}, 3.895589610715495*^9, {3.895590444412505*^9, 
   3.895590453519902*^9}, 3.895590508127524*^9, 3.8955905439582157`*^9, {
   3.895592440937796*^9, 3.895592532735264*^9}, {3.895592590752514*^9, 
   3.895592650561548*^9}, {3.8955927319425507`*^9, 3.895592749052278*^9}, {
   3.8955928168610477`*^9, 3.895592818217918*^9}, {3.895592874955657*^9, 
   3.895592877402446*^9}, {3.8955932689174023`*^9, 3.895593272134426*^9}, {
   3.8955933455504208`*^9, 3.895593351409342*^9}, {3.895593492152051*^9, 
   3.895593498259594*^9}, {3.8955937696317577`*^9, 3.895593822470418*^9}, {
   3.895594059820359*^9, 3.895594072801594*^9}, {3.895594137936792*^9, 
   3.895594145714094*^9}, {3.895594303461802*^9, 3.895594305709622*^9}, 
   3.895594386310108*^9, {3.895594605950818*^9, 3.895594668846685*^9}, 
   3.8955947205307293`*^9, {3.8955949418141413`*^9, 3.895594948532854*^9}, {
   3.895594990704443*^9, 3.895594992920826*^9}, {3.895595557746958*^9, 
   3.895595583989648*^9}, 3.895595615253611*^9, {3.895595728916885*^9, 
   3.895595737345203*^9}, {3.895596389418861*^9, 3.89559639595473*^9}, {
   3.895723271852386*^9, 3.8957232826615477`*^9}, {3.8957234998949127`*^9, 
   3.895723500200151*^9}, {3.8957242143085203`*^9, 3.895724217157454*^9}, {
   3.895724248060494*^9, 3.8957243588861322`*^9}, {3.89572449468648*^9, 
   3.895724523840683*^9}, 3.8957253216621437`*^9, {3.895725378768009*^9, 
   3.895725408595636*^9}, {3.8957259620756197`*^9, 3.895725965867037*^9}, 
   3.895728224448289*^9, 3.895728385634983*^9, {3.8957300332924833`*^9, 
   3.895730144758787*^9}, {3.8957301798778553`*^9, 3.895730182357575*^9}, {
   3.895730289538713*^9, 3.895730391101716*^9}, {3.895730526156761*^9, 
   3.895730532051901*^9}, {3.89573058065491*^9, 3.8957306458853292`*^9}, 
   3.895730712347293*^9, {3.895730770671678*^9, 3.8957308047917347`*^9}, {
   3.895730894218618*^9, 3.895730896210866*^9}, 3.895730996639587*^9, {
   3.895731039820635*^9, 3.895731053193363*^9}, {3.895731088006267*^9, 
   3.8957311912927027`*^9}, 3.895731256114368*^9, {3.895731355063397*^9, 
   3.895731359533929*^9}, {3.895731606212158*^9, 3.89573165236588*^9}, 
   3.895732191332889*^9, {3.895732243309506*^9, 3.895732244028244*^9}, {
   3.895733005810913*^9, 3.8957330070744953`*^9}, {3.895733079504335*^9, 
   3.8957330993229094`*^9}, {3.895733177048377*^9, 3.8957331856636963`*^9}, {
   3.895733261265317*^9, 3.8957333102784653`*^9}, {3.895733341083591*^9, 
   3.8957333617799177`*^9}},ExpressionUUID->"b5a09804-ad41-45c0-83ed-\
a967324e0b87"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"EcoEq", "[", 
     RowBox[{
      RowBox[{"in1___", "?", 
       RowBox[{"RuleListQ", ":", 
        RowBox[{"{", "}"}]}]}], ",", 
      RowBox[{"vars", ":", 
       RowBox[{"(", 
        RowBox[{"_List", "|", "All"}], ")"}], ":", "All"}], ",", 
      RowBox[{"in2___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"func", "=", "EcoEq"}], ",", "args", ",", "opts", ",", "rest",
         ",", "parameters", ",", "attributes", ",", "Gs", ",", "variables", 
        ",", "variableslist"}], "}"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<in1=\>\"", ",", "in1"}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<vars=\>\"", ",", "vars"}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<in2=\>\"", ",", "in2"}], "]"}], ";", "\n", "\n", 
       RowBox[{"args", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"ExtractArgs", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "in1", "}"}], ",", 
             RowBox[{"{", "in2", "}"}]}], "]"}], ",", "func"}], "]"}], 
         "]"}]}], ";", "\n", 
       RowBox[{"opts", "=", 
        RowBox[{"ExtractOpts", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "in1", "}"}], ",", 
            RowBox[{"{", "in2", "}"}]}], "]"}], ",", "func"}], "]"}]}], ";", 
       "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<args=\>\"", ",", "args"}], "]"}], ";", "\n", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<opts=\>\"", ",", "opts"}], "]"}], ";"}], "*)"}], "\n", 
       "\n", 
       RowBox[{"parameters", "=", 
        RowBox[{"ExtractParameters", "[", "args", "]"}]}], ";", "\n", 
       RowBox[{"attributes", "=", 
        RowBox[{"ExtractAttributes", "[", "args", "]"}]}], ";", "\n", 
       RowBox[{"Gs", "=", 
        RowBox[{"ExtractVarCovs", "[", "args", "]"}]}], ";", "\n", 
       RowBox[{"variables", "=", 
        RowBox[{"ExtractVariables", "[", "args", "]"}]}], ";", "\n", 
       RowBox[{"variableslist", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"args", ",", "RuleListQ"}], "]"}], ",", "VariablesQ"}], 
         "]"}]}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<parameters=\>\"", ",", "parameters"}], "]"}], ";", "\n", 
       
       RowBox[{"Print", "[", 
        RowBox[{"\"\<attributes=\>\"", ",", "attributes"}], "]"}], ";", "\n", 
       
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<variables=\>\"", ",", "variables"}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<variableslist=\>\"", ",", "variableslist"}], "]"}], ";", 
       "\n", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"variableslist", "==", 
          RowBox[{"{", "}"}]}], ",", "\n", "\t", 
         RowBox[{"iEcoEq", "[", 
          RowBox[{
          "parameters", ",", "attributes", ",", "Gs", ",", "variables", ",", 
           "vars", ",", "opts"}], "]"}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"iEcoEq", "[", 
            RowBox[{
            "parameters", ",", "attributes", ",", "Gs", ",", "#", ",", "vars",
              ",", "opts"}], "]"}], "&"}], "/@", "variableslist"}]}], "\n", 
        "]"}]}]}], "\n", "]"}]}], ";"}], "*)"}]], "Code",
 CellChangeTimes->{{3.7127802306821003`*^9, 3.71278023163732*^9}, {
   3.769860889371685*^9, 3.769860898625585*^9}, {3.890088762767192*^9, 
   3.8900887857559834`*^9}, {3.890088825582732*^9, 3.8900888418951406`*^9}, {
   3.8900889470940847`*^9, 3.890088957136177*^9}, {3.8901267099939337`*^9, 
   3.890126710376408*^9}, {3.89012675925627*^9, 3.89012677188067*^9}, {
   3.890147666024979*^9, 3.890147669484149*^9}, {3.895556083668763*^9, 
   3.895556095879417*^9}, 3.8955566991026297`*^9, {3.8955577669801817`*^9, 
   3.8955577681779213`*^9}, {3.8955622577005453`*^9, 3.895562258529551*^9}, 
   3.89556232631433*^9, {3.89556263361314*^9, 3.8955626472449636`*^9}, {
   3.895562842722169*^9, 3.895562849597785*^9}, {3.895563092493565*^9, 
   3.895563126066338*^9}, {3.895563181729741*^9, 3.89556321475914*^9}, {
   3.895565622997553*^9, 3.895565825215711*^9}, {3.895566197384026*^9, 
   3.8955663023293247`*^9}, {3.8955663794538603`*^9, 3.895566420626652*^9}, {
   3.895567028632929*^9, 3.895567029623745*^9}, {3.895567212564479*^9, 
   3.895567218896427*^9}, {3.895567272624502*^9, 3.895567274409018*^9}, {
   3.8955675907546473`*^9, 3.895567768041896*^9}, {3.895567851076992*^9, 
   3.895567855084454*^9}, {3.895567885960531*^9, 3.8955679150019197`*^9}, {
   3.8955680083366737`*^9, 3.895568008699531*^9}, {3.895568048854352*^9, 
   3.895568157442192*^9}, {3.895568229874014*^9, 3.895568253702044*^9}, {
   3.8955693854122*^9, 3.8955694265490522`*^9}, 3.895575272473558*^9, {
   3.895575467928422*^9, 3.8955755135470257`*^9}, 3.895575682651147*^9, 
   3.895578721564733*^9, 3.895579374206821*^9, {3.89557941527911*^9, 
   3.8955794329631166`*^9}, {3.8955794748472223`*^9, 3.895579478562263*^9}, {
   3.895579560992878*^9, 3.895579561228808*^9}, {3.8955796500246983`*^9, 
   3.8955796662780857`*^9}, {3.895579769850182*^9, 3.895579777141037*^9}, {
   3.895579856895706*^9, 3.8955798595931683`*^9}, 3.895588510289165*^9, {
   3.8955886111527357`*^9, 3.895588612849946*^9}, {3.895589347468148*^9, 
   3.895589379222314*^9}, 3.895589610715495*^9, {3.895590444412505*^9, 
   3.895590453519902*^9}, 3.895590508127524*^9, 3.8955905439582157`*^9, {
   3.895592440937796*^9, 3.895592532735264*^9}, {3.895592590752514*^9, 
   3.895592650561548*^9}, {3.8955927319425507`*^9, 3.895592749052278*^9}, {
   3.8955928168610477`*^9, 3.895592818217918*^9}, {3.895592874955657*^9, 
   3.895592877402446*^9}, {3.8955932689174023`*^9, 3.895593272134426*^9}, {
   3.8955933455504208`*^9, 3.895593351409342*^9}, {3.895593492152051*^9, 
   3.895593498259594*^9}, {3.8955937696317577`*^9, 3.895593822470418*^9}, {
   3.895594059820359*^9, 3.895594072801594*^9}, {3.895594137936792*^9, 
   3.895594145714094*^9}, {3.895594303461802*^9, 3.895594305709622*^9}, 
   3.895594386310108*^9, {3.895594605950818*^9, 3.895594668846685*^9}, 
   3.8955947205307293`*^9, {3.8955949418141413`*^9, 3.895594948532854*^9}, {
   3.895594990704443*^9, 3.895594992920826*^9}, {3.895595557746958*^9, 
   3.895595583989648*^9}, 3.895595615253611*^9, {3.895595728916885*^9, 
   3.895595737345203*^9}, {3.895596389418861*^9, 3.89559639595473*^9}, {
   3.895723271852386*^9, 3.8957232826615477`*^9}, {3.8957234998949127`*^9, 
   3.895723500200151*^9}, {3.8957242143085203`*^9, 3.895724217157454*^9}, {
   3.895724248060494*^9, 3.8957243588861322`*^9}, {3.89572449468648*^9, 
   3.895724523840683*^9}, 3.8957253216621437`*^9, {3.895725378768009*^9, 
   3.895725408595636*^9}, {3.8957259620756197`*^9, 3.895725965867037*^9}, 
   3.895728224448289*^9, 3.895728385634983*^9, {3.8957300332924833`*^9, 
   3.895730144758787*^9}, {3.8957301798778553`*^9, 3.895730182357575*^9}, {
   3.895730289538713*^9, 3.895730391101716*^9}, {3.895730526156761*^9, 
   3.895730532051901*^9}, {3.89573058065491*^9, 3.8957306458853292`*^9}, 
   3.895730712347293*^9, {3.895730770671678*^9, 3.8957308047917347`*^9}, {
   3.895730894218618*^9, 3.895730896210866*^9}, 3.895730996639587*^9, {
   3.895731039820635*^9, 3.895731053193363*^9}, {3.895731088006267*^9, 
   3.8957311912927027`*^9}, 3.895731256114368*^9, {3.895731355063397*^9, 
   3.895731359533929*^9}, {3.895731606212158*^9, 3.89573165236588*^9}, 
   3.895732191332889*^9, {3.895732243309506*^9, 3.895732244028244*^9}, {
   3.895733005810913*^9, 3.8957330070744953`*^9}, {3.895733079504335*^9, 
   3.8957330993229094`*^9}, {3.895733177048377*^9, 3.8957331856636963`*^9}, {
   3.895733261265317*^9, 3.8957333102784653`*^9}, {3.895733341083591*^9, 
   3.8957333617799177`*^9}, {3.895734880352162*^9, 3.895734976205459*^9}, {
   3.895735436010398*^9, 3.895735456374626*^9}, {3.8957361420121593`*^9, 
   3.8957361718643084`*^9}, {3.8957364523050756`*^9, 3.895736488507453*^9}, {
   3.895736523932914*^9, 3.8957365354267282`*^9}, {3.89573675047738*^9, 
   3.8957367566112013`*^9}, {3.8957368549635*^9, 3.895736864569398*^9}, {
   3.895737910286393*^9, 3.895737914400756*^9}, 3.895738005080303*^9, 
   3.895738094801167*^9, {3.895738219384956*^9, 3.8957382428401957`*^9}, {
   3.895738289885906*^9, 3.89573829020084*^9}, 3.895738654293597*^9, {
   3.895739078130471*^9, 
   3.8957390795268373`*^9}},ExpressionUUID->"4885417d-26f9-4722-be7e-\
b9fbf1aeffac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "[", "in___", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"func", "=", "EcoEq"}], ",", "args", ",", "opts", ",", "rest", 
       ",", "parameters", ",", "attributes", ",", "Gs", ",", "variables", ",",
        "variableslist", ",", "\n", "vars"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<in=\>\"", ",", "in"}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"args", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ExtractArgs", "[", 
         RowBox[{
          RowBox[{"{", "in", "}"}], ",", "func"}], "]"}], "]"}]}], ";", "\n", 
      
      RowBox[{"opts", "=", 
       RowBox[{"ExtractOpts", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", "func"}], "]"}]}], ";", "\n", 
      RowBox[{"vars", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "==", "Symbol"}], "&"}]}], 
           "]"}], "&"}]}], "]"}]}], ";", "\n", 
      RowBox[{"ranges", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", 
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vars", "==", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"vars", "=", "All"}], ",", 
        RowBox[{"vars", "=", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<args=\>\"", ",", "args"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<opts=\>\"", ",", "opts"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<vars=\>\"", ",", "vars"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<ranges=\>\"", ",", "ranges"}], "]"}], ";", "\n", "\n", 
      RowBox[{"parameters", "=", 
       RowBox[{"ExtractParameters", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"attributes", "=", 
       RowBox[{"ExtractAttributes", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"Gs", "=", 
       RowBox[{"ExtractVarCovs", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"variables", "=", 
       RowBox[{"ExtractVariables", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"variableslist", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"args", ",", "RuleListQ"}], "]"}], ",", "VariablesQ"}], 
        "]"}]}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<parameters=\>\"", ",", "parameters"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<attributes=\>\"", ",", "attributes"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<variables=\>\"", ",", "variables"}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<variableslist=\>\"", ",", "variableslist"}], "]"}], ";", 
      "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"variableslist", "==", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t", 
        RowBox[{"iEcoEq", "[", 
         RowBox[{
         "parameters", ",", "attributes", ",", "Gs", ",", "variables", ",", 
          "vars", ",", "opts"}], "]"}], ",", "\n", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"iEcoEq", "[", 
           RowBox[{
           "parameters", ",", "attributes", ",", "Gs", ",", "#", ",", "vars", 
            ",", "opts"}], "]"}], "&"}], "/@", "variableslist"}]}], "\n", 
       "]"}]}]}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.7127802306821003`*^9, 3.71278023163732*^9}, {
   3.769860889371685*^9, 3.769860898625585*^9}, {3.890088762767192*^9, 
   3.8900887857559834`*^9}, {3.890088825582732*^9, 3.8900888418951406`*^9}, {
   3.8900889470940847`*^9, 3.890088957136177*^9}, {3.8901267099939337`*^9, 
   3.890126710376408*^9}, {3.89012675925627*^9, 3.89012677188067*^9}, {
   3.890147666024979*^9, 3.890147669484149*^9}, {3.895556083668763*^9, 
   3.895556095879417*^9}, 3.8955566991026297`*^9, {3.8955577669801817`*^9, 
   3.8955577681779213`*^9}, {3.8955622577005453`*^9, 3.895562258529551*^9}, 
   3.89556232631433*^9, {3.89556263361314*^9, 3.8955626472449636`*^9}, {
   3.895562842722169*^9, 3.895562849597785*^9}, {3.895563092493565*^9, 
   3.895563126066338*^9}, {3.895563181729741*^9, 3.89556321475914*^9}, {
   3.895565622997553*^9, 3.895565825215711*^9}, {3.895566197384026*^9, 
   3.8955663023293247`*^9}, {3.8955663794538603`*^9, 3.895566420626652*^9}, {
   3.895567028632929*^9, 3.895567029623745*^9}, {3.895567212564479*^9, 
   3.895567218896427*^9}, {3.895567272624502*^9, 3.895567274409018*^9}, {
   3.8955675907546473`*^9, 3.895567768041896*^9}, {3.895567851076992*^9, 
   3.895567855084454*^9}, {3.895567885960531*^9, 3.8955679150019197`*^9}, {
   3.8955680083366737`*^9, 3.895568008699531*^9}, {3.895568048854352*^9, 
   3.895568157442192*^9}, {3.895568229874014*^9, 3.895568253702044*^9}, {
   3.8955693854122*^9, 3.8955694265490522`*^9}, 3.895575272473558*^9, {
   3.895575467928422*^9, 3.8955755135470257`*^9}, 3.895575682651147*^9, 
   3.895578721564733*^9, 3.895579374206821*^9, {3.89557941527911*^9, 
   3.8955794329631166`*^9}, {3.8955794748472223`*^9, 3.895579478562263*^9}, {
   3.895579560992878*^9, 3.895579561228808*^9}, {3.8955796500246983`*^9, 
   3.8955796662780857`*^9}, {3.895579769850182*^9, 3.895579777141037*^9}, {
   3.895579856895706*^9, 3.8955798595931683`*^9}, 3.895588510289165*^9, {
   3.8955886111527357`*^9, 3.895588612849946*^9}, {3.895589347468148*^9, 
   3.895589379222314*^9}, 3.895589610715495*^9, {3.895590444412505*^9, 
   3.895590453519902*^9}, 3.895590508127524*^9, 3.8955905439582157`*^9, {
   3.895592440937796*^9, 3.895592532735264*^9}, {3.895592590752514*^9, 
   3.895592650561548*^9}, {3.8955927319425507`*^9, 3.895592749052278*^9}, {
   3.8955928168610477`*^9, 3.895592818217918*^9}, {3.895592874955657*^9, 
   3.895592877402446*^9}, {3.8955932689174023`*^9, 3.895593272134426*^9}, {
   3.8955933455504208`*^9, 3.895593351409342*^9}, {3.895593492152051*^9, 
   3.895593498259594*^9}, {3.8955937696317577`*^9, 3.895593822470418*^9}, {
   3.895594059820359*^9, 3.895594072801594*^9}, {3.895594137936792*^9, 
   3.895594145714094*^9}, {3.895594303461802*^9, 3.895594305709622*^9}, 
   3.895594386310108*^9, {3.895594605950818*^9, 3.895594668846685*^9}, 
   3.8955947205307293`*^9, {3.8955949418141413`*^9, 3.895594948532854*^9}, {
   3.895594990704443*^9, 3.895594992920826*^9}, {3.895595557746958*^9, 
   3.895595583989648*^9}, 3.895595615253611*^9, {3.895595728916885*^9, 
   3.895595737345203*^9}, {3.895596389418861*^9, 3.89559639595473*^9}, {
   3.895723271852386*^9, 3.8957232826615477`*^9}, {3.8957234998949127`*^9, 
   3.895723500200151*^9}, {3.8957242143085203`*^9, 3.895724217157454*^9}, {
   3.895724248060494*^9, 3.8957243588861322`*^9}, {3.89572449468648*^9, 
   3.895724523840683*^9}, 3.8957253216621437`*^9, {3.895725378768009*^9, 
   3.895725408595636*^9}, {3.8957259620756197`*^9, 3.895725965867037*^9}, 
   3.895728224448289*^9, 3.895728385634983*^9, {3.8957300332924833`*^9, 
   3.895730144758787*^9}, {3.8957301798778553`*^9, 3.895730182357575*^9}, {
   3.895730289538713*^9, 3.895730391101716*^9}, {3.895730526156761*^9, 
   3.895730532051901*^9}, {3.89573058065491*^9, 3.8957306458853292`*^9}, 
   3.895730712347293*^9, {3.895730770671678*^9, 3.8957308047917347`*^9}, {
   3.895730894218618*^9, 3.895730896210866*^9}, 3.895730996639587*^9, {
   3.895731039820635*^9, 3.895731053193363*^9}, {3.895731088006267*^9, 
   3.8957311912927027`*^9}, 3.895731256114368*^9, {3.895731355063397*^9, 
   3.895731359533929*^9}, {3.895731606212158*^9, 3.89573165236588*^9}, 
   3.895732191332889*^9, {3.895732243309506*^9, 3.895732244028244*^9}, {
   3.895733005810913*^9, 3.8957330070744953`*^9}, {3.895733079504335*^9, 
   3.8957330993229094`*^9}, {3.895733177048377*^9, 3.8957331856636963`*^9}, {
   3.895733261265317*^9, 3.8957333102784653`*^9}, {3.895733341083591*^9, 
   3.8957333617799177`*^9}, {3.895739915028021*^9, 3.8957399168763523`*^9}, {
   3.895739956286934*^9, 3.895739960845393*^9}, {3.895740036353834*^9, 
   3.8957400475824833`*^9}, 3.895740267670516*^9, {3.895740363081471*^9, 
   3.895740370369906*^9}, {3.895740401135902*^9, 3.89574040209801*^9}, {
   3.8957405628990307`*^9, 3.8957405644202223`*^9}, {3.895740604411921*^9, 
   3.895740610039589*^9}, {3.895740755442668*^9, 3.8957407775015907`*^9}, {
   3.895740883555833*^9, 3.895740889820269*^9}, {3.895741220046998*^9, 
   3.895741223130054*^9}, {3.895741466079542*^9, 3.895741521576285*^9}, {
   3.8957415922179947`*^9, 
   3.895741593243791*^9}},ExpressionUUID->"2ce343f2-41ea-4110-b43a-\
91fa878f1c7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition", "Subsubsection",
 CellChangeTimes->{{3.7694936745853653`*^9, 
  3.769493676072991*^9}},ExpressionUUID->"27a7cec4-4ed5-474b-9c85-\
9892ad21c607"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iEcoEq", "[", 
    RowBox[{
    "pars_", ",", "attributesin_", ",", "Gsin_", ",", "init_", ",", "vars_", 
     ",", 
     RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{"(*", " ", "options", " ", "*)"}], "\n", 
      RowBox[{
      "method", ",", "solveopts", ",", "nsolveopts", ",", "findrootopts", ",",
        "findrootsopts", ",", "\n", "boundarydetection", ",", "time", ",", 
       "fixed", ",", "chop", ",", "qss", ",", "percapita", ",", "verbose", 
       ",", "ignorevar", ",", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"other", " ", "variables"}], " ", "*)"}], "\n", "attributes", 
       ",", "nonvars", ",", "nonfixedvars", ",", "fixedvars", ",", "Gs", ",", 
       "removets", ",", "eqns", ",", "unks", ",", "newunk", ",", "sol", ",", 
       "res"}], "}"}], ",", "\n", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[ScriptCapitalN]", ",", "verbosity", ",", 
         RowBox[{"func", "=", "\"\<EcoEq\>\""}]}], "}"}], ",", "\n", "\n", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"set", " ", "verbosity"}], " ", "*)"}], "\n", "\n", 
        RowBox[{"verbose", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Verbose", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Verbosity", "/.", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"opts", ",", 
                  RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
              "]"}]}], "]"}]}], ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Verbosity", "/.", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"opts", ",", 
                RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "Global`$verbosity", "]"}], ",", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"Global`$verbosity", ",", "verbosity"}], "]"}]}]}], "]"}],
         ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"handle", " ", "options"}], " ", "*)"}], "\n", "\n", 
        RowBox[{"method", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Method", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "===", "Automatic"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"init", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"method", "=", "\"\<FindRoot\>\""}], ",", 
            RowBox[{"method", "=", "\"\<Solve\>\""}]}], "]"}]}], "]"}], ";", 
        "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<method=\>\"", ",", "method"}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"solveopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"SolveOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"nsolveopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"NSolveOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"findrootopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"FindRootOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"findrootsopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"FindRootsOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"boundarydetection", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"BoundaryDetection", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"time", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Time", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"chop", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Chop", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"qss", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"QSS", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"fixed", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Fixed", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"percapita", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"PerCapita", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"ignorevar", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"IgnoreVar", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"EcoEq", " ", 
          RowBox[{"doesn", "'"}], "t", " ", "work", " ", "on", " ", 
          "Periodic", " ", "models"}], " ", "*)"}], "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"modelperiod", "=!=", "0"}], "&&", 
           RowBox[{"time", "===", "t"}], "&&", 
           RowBox[{"method", "\[Equal]", "\"\<FindRoot\>\""}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EcoEq", "::", "noneq"}], "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"fix", " ", "attributes"}], " ", "*)"}], "\n", 
        RowBox[{"attributes", "=", 
         RowBox[{"FixAttributes", "[", "attributesin", "]"}]}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "figure", " ", "out", " ", "number", " ", "of", " ", "species", " ", 
          "in", " ", "guilds"}], " ", "*)"}], "\n", 
        RowBox[{"Set\[ScriptCapitalN]", "[", "attributes", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<\[ScriptCapitalN]=\>\"", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"expand", " ", "Gs"}], " ", "*)"}], "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gsin=\>\"", ",", "Gsin"}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"method", "==", "\"\<FindRoot\>\""}], "||", 
           RowBox[{"method", "==", "\"\<FindRoots\>\""}]}], ",", "\n", "\t", 
          RowBox[{"If", "[", 
           RowBox[{"moments", ",", "\n", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Gsin", "===", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"Gs", "=", "ZeroGs"}], ",", 
              RowBox[{"Gs", "=", 
               RowBox[{"ExpandGs", "[", 
                RowBox[{"Gsin", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[FormalCapitalN]", "[", "gu", "]"}], "\[Rule]", 
                    
                    RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], 
                "]"}]}]}], "]"}], ",", "\n", "\t\t", 
            RowBox[{"Gs", "=", 
             RowBox[{"{", "}"}]}]}], "]"}], "\n", "\t", ",", "\n", "\t", 
          RowBox[{
           RowBox[{"Gs", "=", 
            RowBox[{"ExpandGs", "[", 
             RowBox[{"Gsin", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[FormalCapitalN]", "[", "gu", "]"}], "\[Rule]", 
                 RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}]}], 
           ";"}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vars", "===", "All"}], ",", "\n", "\t", 
          RowBox[{"nonvars", "=", 
           RowBox[{"{", "}"}]}], ",", "\n", "\t", 
          RowBox[{"nonvars", "=", 
           RowBox[{"OrderedComplement", "[", 
            RowBox[{"AllVariables", ",", "vars"}], "]"}]}]}], "\n", "]"}], 
        ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonvars=\>\"", ",", "nonvars"}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"qss", "\[Equal]", "False"}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "0"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "x"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<fixed=\>\"", ",", "fixed"}], "]"}], ";", "\n",
         "\n", 
        RowBox[{"fixedvars", "=", 
         RowBox[{"fixed", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        RowBox[{"nonfixedvars", "=", 
         RowBox[{"OrderedComplement", "[", 
          RowBox[{"AllVariables", ",", "fixedvars"}], "]"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonfixedvars=\>\"", ",", "nonfixedvars"}], 
         "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"set", " ", "eqns"}], " ", "*)"}], "\n", 
        RowBox[{"eqns", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"EcoEqns", "[", 
               RowBox[{"attributes", ",", 
                RowBox[{"Fixed", "\[Rule]", "fixed"}], ",", 
                RowBox[{"PerCapita", "\[Rule]", "percapita"}], ",", 
                RowBox[{"IgnoreVar", "->", "ignorevar"}]}], "]"}], "/.", 
              "Eq"}], "/.", 
             RowBox[{"t", "\[Rule]", "time"}]}], "/.", "fixed"}], "/.", 
           "attributes"}], "/.", "Gs"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<eqns=\>\"", ",", "eqns"}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"solve", " ", "it"}], " ", "*)"}], "\n", 
        RowBox[{"Which", "[", "\n", "\t", 
         RowBox[{
          StyleBox[
           RowBox[{"method", "\[Equal]", "\"\<Solve\>\""}],
           FontSize->16], 
          StyleBox[",",
           FontSize->16], "\n", "\t", 
          RowBox[{
           RowBox[{"unks", "=", "nonfixedvars"}], ";", "\n", "\t", 
           RowBox[{"VPrint", "[", 
            RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", 
           "\n", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"eqns", "=", "eqns"}], ",", 
                 RowBox[{"unks", "=", "unks"}], ",", 
                 RowBox[{"options", "=", 
                  RowBox[{"Sequence", "@@", "solveopts"}]}]}], "}"}], ",", 
               RowBox[{"PrintCall", "[", 
                RowBox[{"Global`sol", "=", 
                 RowBox[{"Solve", "[", 
                  RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
           RowBox[{"sol", "=", 
            RowBox[{"Solve", "[", 
             RowBox[{"eqns", ",", "unks", ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "solveopts"}], "]"}]}], "]"}]}], ";",
            "\n", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "sol", "]"}], "===", "Solve"}], ",", 
             RowBox[{"sol", "=", 
              RowBox[{"Solve", "[", 
               RowBox[{"eqns", ",", "unks", ",", "Reals", ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Sequence", "@@", "solveopts"}], "]"}]}], "]"}]}]}], 
            "]"}]}], "\n", "\t", ",", "\n", "\n", "\t", 
          StyleBox[
           RowBox[{"method", "\[Equal]", "\"\<NSolve\>\""}],
           FontSize->16], 
          StyleBox[",",
           FontSize->16], "\n", "\t", 
          RowBox[{
           RowBox[{"unks", "=", "nonfixedvars"}], ";", "\n", "\t", 
           RowBox[{"VPrint", "[", 
            RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", 
           "\n", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"eqns", "=", "eqns"}], ",", 
                 RowBox[{"unks", "=", "unks"}], ",", 
                 RowBox[{"options", "=", 
                  RowBox[{"Sequence", "@@", "nsolveopts"}]}]}], "}"}], ",", 
               RowBox[{"PrintCall", "[", 
                RowBox[{"Global`sol", "=", 
                 RowBox[{"NSolve", "[", 
                  RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
           RowBox[{"sol", "=", 
            RowBox[{"NSolve", "[", 
             RowBox[{"eqns", ",", "unks", ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "nsolveopts"}], "]"}]}], "]"}]}], 
           ";", "\n", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "sol", "]"}], "===", "NSolve"}], ",", 
             RowBox[{"sol", "=", 
              RowBox[{"NSolve", "[", 
               RowBox[{"eqns", ",", "unks", ",", "Reals", ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Sequence", "@@", "nsolveopts"}], "]"}]}], "]"}]}]}],
             "]"}]}], "\n", "\t", ",", "\n", "\n", "\t", 
          StyleBox[
           RowBox[{"method", "\[Equal]", "\"\<FindRoot\>\""}],
           FontSize->16], 
          StyleBox[",",
           FontSize->16], "\n", "\t", 
          RowBox[{
           RowBox[{"unks", "=", 
            RowBox[{"Table", "[", "\n", "\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"newunk", "=", 
                RowBox[{"{", 
                 RowBox[{"var", ",", 
                  RowBox[{"(", 
                   RowBox[{"var", "/.", 
                    RowBox[{"Append", "[", 
                    RowBox[{"init", ",", 
                    RowBox[{"var", "\[Rule]", "0"}]}], "]"}]}], ")"}]}], 
                 "}"}]}], ";", "\n", "\t\t", 
               RowBox[{"If", "[", 
                RowBox[{"boundarydetection", ",", 
                 RowBox[{"newunk", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"newunk", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"range", "[", "var", "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"range", "[", "var", "]"}], "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}], ";", "\n", "\t\t", "newunk"}], ",", 
              RowBox[{"{", 
               RowBox[{"var", ",", "nonfixedvars"}], "}"}]}], "]"}]}], ";", 
           "\n", "\t", 
           RowBox[{"VPrint", "[", 
            RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", 
           "\n", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"eqns", "=", "eqns"}], ",", 
                 RowBox[{"unks", "=", "unks"}], ",", 
                 RowBox[{"options", "=", 
                  RowBox[{"Sequence", "@@", "findrootopts"}]}]}], "}"}], ",", 
               
               RowBox[{"PrintCall", "[", 
                RowBox[{"Global`sol", "=", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
           RowBox[{"sol", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{"eqns", ",", "unks", ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "findrootopts"}], "]"}]}], "]"}]}]}],
           ",", "\n", "\n", "\t", 
          StyleBox[
           RowBox[{"method", "==", "\"\<FindRoots\>\""}],
           FontSize->16], 
          StyleBox[",",
           FontSize->16], "\n", "\t", 
          RowBox[{
           RowBox[{"unks", "=", "vars"}], ";", "\n", "\t", 
           RowBox[{"VPrint", "[", 
            RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", 
           "\n", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"eqns", "=", "eqns"}], ",", 
                 RowBox[{"unks", "=", "unks"}], ",", 
                 RowBox[{"options", "=", 
                  RowBox[{"Sequence", "@@", "findrootsopts"}]}]}], "}"}], ",", 
               RowBox[{"PrintCall", "[", 
                RowBox[{"Global`sol", "=", 
                 RowBox[{"FindRoots", "[", 
                  RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
           RowBox[{"sol", "=", 
            RowBox[{"FindRoots", "[", 
             RowBox[{"eqns", ",", "unks", ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "findrootsopts"}], "]"}]}], 
             "]"}]}]}], ",", "\n", "\t", "Else", ",", "\n", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EcoEq", "::", "badmtd"}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], "\n", "]"}], ";",
         "\n", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<sol=\>\"", ",", "sol"}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Solve", ",", "NSolve"}], "}"}], ",", 
            RowBox[{"Head", "[", "sol", "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"EcoEq", "::", "nosol"}], ",", 
             RowBox[{"Head", "[", "sol", "]"}]}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"add", " ", "in", " ", "Fixed", " ", "variables"}], " ", 
         "*)"}], "\n", 
        RowBox[{"Which", "[", "\n", "\t", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<Solve\>\"", ",", "\"\<NSolve\>\"", ",", 
              "\"\<FindRoots\>\""}], "}"}], ",", "method"}], "]"}], ",", "\n",
           "\t", 
          RowBox[{"res", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"fixed", ",", 
                 RowBox[{"var_", "\[Rule]", "var_"}]}], "]"}], ",", "#"}], 
              "]"}], "&"}], " ", "/@", " ", "sol"}]}], ",", "\n", "\t", 
          RowBox[{"method", "\[Equal]", "\"\<FindRoot\>\""}], ",", "\n", "\t", 
          RowBox[{"res", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"fixed", ",", 
               RowBox[{"var_", "\[Rule]", "var_"}]}], "]"}], ",", "sol"}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"chop", ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", 
              RowBox[{"Chop", "[", "res", "]"}], "]"}], ",", "AllVariables"}],
             "]"}], "]"}], ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", "res", "]"}], ",", "AllVariables"}], 
            "]"}], "]"}]}], "\n", "]"}], ";"}]}], "\n", "\n", "]"}]}], 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.687881450105945*^9, 3.6878814505620613`*^9}, {
   3.68857168476537*^9, 3.688571684934305*^9}, {3.6885717562075033`*^9, 
   3.688571756902958*^9}, {3.688571805445076*^9, 3.6885718054840527`*^9}, {
   3.6885777801299953`*^9, 3.688577821198338*^9}, {3.688578111707645*^9, 
   3.688578263696265*^9}, {3.688583189141659*^9, 3.688583201104134*^9}, {
   3.6885837935779333`*^9, 3.688583810589251*^9}, {3.688583857663521*^9, 
   3.688583866440373*^9}, 3.688584023610524*^9, {3.688584454327429*^9, 
   3.688584464134824*^9}, {3.6885851260336657`*^9, 3.6885852077551622`*^9}, 
   3.688685223038662*^9, {3.693593326673889*^9, 3.693593328006213*^9}, {
   3.693651209563744*^9, 3.693651212696253*^9}, {3.693651330751341*^9, 
   3.693651337237907*^9}, {3.693700342037077*^9, 3.6937003445534773`*^9}, {
   3.69961046687166*^9, 3.699610497623667*^9}, 3.709124896659213*^9, {
   3.709336699110145*^9, 3.709336699577385*^9}, {3.7101059510781393`*^9, 
   3.710105954644555*^9}, {3.710254347130986*^9, 3.710254357145165*^9}, {
   3.710254389172209*^9, 3.7102544454183407`*^9}, {3.710286418340989*^9, 
   3.710286419629771*^9}, 3.710286914350444*^9, 3.7127385346721067`*^9, {
   3.714088449593779*^9, 3.714088465042605*^9}, {3.714088783139654*^9, 
   3.714088791448407*^9}, {3.714088844203219*^9, 3.71408885600861*^9}, 
   3.714089170503827*^9, {3.7140892855105886`*^9, 3.7140893056027193`*^9}, {
   3.7146455898601007`*^9, 3.714645607554661*^9}, {3.714645833218658*^9, 
   3.714645878205338*^9}, {3.7146594716484127`*^9, 3.714659498519136*^9}, {
   3.714659560420806*^9, 3.714659597546504*^9}, {3.714661306250412*^9, 
   3.7146613128544407`*^9}, {3.7146613520466423`*^9, 3.714661374692927*^9}, {
   3.714661426985828*^9, 3.714661471021627*^9}, {3.714670952581798*^9, 
   3.7146709761045732`*^9}, {3.714673053941062*^9, 3.71467307388553*^9}, {
   3.714673325535184*^9, 3.7146733431977777`*^9}, {3.714673385822101*^9, 
   3.714673408156714*^9}, {3.7146763296033154`*^9, 3.714676349908175*^9}, {
   3.714676870217898*^9, 3.7146768813446712`*^9}, {3.714677005871266*^9, 
   3.7146770388481817`*^9}, {3.714677885477186*^9, 3.714677895396152*^9}, {
   3.7146815798359137`*^9, 3.71468158317702*^9}, {3.714686709068077*^9, 
   3.714686720449131*^9}, {3.714686780357995*^9, 3.714686847805605*^9}, {
   3.714686886251251*^9, 3.7146869069408197`*^9}, {3.7146904343318*^9, 
   3.714690435561199*^9}, {3.7146905887398357`*^9, 3.714690601923481*^9}, {
   3.714690631972337*^9, 3.714690933211876*^9}, {3.714691441205781*^9, 
   3.7146914443765163`*^9}, 3.714771558293874*^9, {3.71477345759927*^9, 
   3.714773544216226*^9}, {3.714773631881823*^9, 3.714773638759398*^9}, {
   3.7147737076976557`*^9, 3.714773768872843*^9}, {3.714773810344654*^9, 
   3.714773862655966*^9}, {3.714774175646474*^9, 3.714774238321686*^9}, {
   3.714774276778345*^9, 3.714774313756324*^9}, {3.714774363666697*^9, 
   3.714774431577939*^9}, {3.71477474128935*^9, 3.714774765274622*^9}, {
   3.714774824264062*^9, 3.7147748384112673`*^9}, {3.7147748942865953`*^9, 
   3.7147749226594543`*^9}, {3.7147749728240833`*^9, 
   3.7147749743011627`*^9}, {3.714777387544536*^9, 3.714777422944803*^9}, {
   3.715423204967746*^9, 3.715423247100832*^9}, {3.716851794553669*^9, 
   3.716851838573512*^9}, {3.716851923962669*^9, 3.71685195096766*^9}, {
   3.716852009532653*^9, 3.716852055393906*^9}, {3.716852216771632*^9, 
   3.71685231192962*^9}, {3.7168523670615377`*^9, 3.71685238929698*^9}, {
   3.7168524239048243`*^9, 3.716852506519627*^9}, {3.7168526119630947`*^9, 
   3.716852660342918*^9}, {3.720561423750366*^9, 3.720561426334433*^9}, {
   3.720561478834214*^9, 3.720561481166069*^9}, {3.721849189319437*^9, 
   3.72184920349916*^9}, {3.721849430040469*^9, 3.7218494327297087`*^9}, 
   3.7218496199026947`*^9, {3.722043437583398*^9, 3.722043661426222*^9}, {
   3.722083757551734*^9, 3.72208381655929*^9}, {3.725055711251069*^9, 
   3.725055715332081*^9}, 3.7251409579843616`*^9, 3.725141965221623*^9, {
   3.728485760884264*^9, 3.728485790162279*^9}, {3.728492488068541*^9, 
   3.728492510850383*^9}, {3.728493399302709*^9, 3.728493401619061*^9}, {
   3.7284934402687283`*^9, 3.728493443062832*^9}, {3.728495197386813*^9, 
   3.7284952624184313`*^9}, {3.728495727453259*^9, 3.7284957368624372`*^9}, {
   3.728495928466558*^9, 3.72849592873841*^9}, {3.731976096240344*^9, 
   3.7319762267049303`*^9}, {3.731976277432869*^9, 3.7319762780290833`*^9}, {
   3.7319768020188913`*^9, 3.731976803777299*^9}, {3.731976892921598*^9, 
   3.731976916165578*^9}, {3.731976959563902*^9, 3.731976962085402*^9}, {
   3.731977155942281*^9, 3.73197716443357*^9}, {3.731977195279862*^9, 
   3.7319772065728207`*^9}, {3.731977279507853*^9, 3.731977284166617*^9}, {
   3.731977461555399*^9, 3.731977465980788*^9}, {3.731978006012163*^9, 
   3.731978013040636*^9}, {3.731978082421216*^9, 3.731978094010425*^9}, {
   3.731979039353709*^9, 3.731979039363929*^9}, {3.731979598523592*^9, 
   3.73197961490341*^9}, {3.73197972820308*^9, 3.7319797289924088`*^9}, {
   3.731980249144205*^9, 3.73198026694471*^9}, 3.731980373788886*^9, {
   3.7319804050810537`*^9, 3.731980445644969*^9}, {3.731980548309566*^9, 
   3.731980566185113*^9}, {3.731980610588462*^9, 3.7319806369962673`*^9}, {
   3.731980738391506*^9, 3.731980763895586*^9}, {3.731980818773868*^9, 
   3.731980857708199*^9}, {3.731980943731715*^9, 3.731981000719969*^9}, 
   3.731981067123608*^9, {3.732221099817436*^9, 3.7322211073866863`*^9}, {
   3.732237132742322*^9, 3.73223714782172*^9}, {3.732237266376129*^9, 
   3.732237271289744*^9}, {3.732273382440886*^9, 3.73227340932165*^9}, {
   3.732273491519849*^9, 3.732273491669429*^9}, {3.732394286439495*^9, 
   3.732394371996009*^9}, 3.755182267229639*^9, 3.755184973022751*^9, {
   3.75582209648076*^9, 3.7558220982190313`*^9}, {3.7558225635660257`*^9, 
   3.7558225772644787`*^9}, {3.7585221898099403`*^9, 3.7585221899906693`*^9}, 
   3.759140406004279*^9, {3.75914072046175*^9, 3.759140778591229*^9}, {
   3.759141110454555*^9, 3.7591411170112877`*^9}, 3.759142070148613*^9, {
   3.759926864600369*^9, 3.759926908779594*^9}, {3.7599440817309227`*^9, 
   3.759944089031756*^9}, {3.7599442652749147`*^9, 3.7599442925085506`*^9}, {
   3.759944468213972*^9, 3.759944470421031*^9}, {3.759944509678103*^9, 
   3.759944625568841*^9}, {3.759944680926206*^9, 3.759944704050845*^9}, {
   3.759944777100625*^9, 3.759944777332377*^9}, {3.7599452123441133`*^9, 
   3.759945212472487*^9}, 3.761151167307536*^9, 3.7613779187363462`*^9, {
   3.769182368428945*^9, 3.7691823684332743`*^9}, {3.769182447225265*^9, 
   3.769182447229724*^9}, 3.7697607053790417`*^9, 3.770438265000821*^9, {
   3.770721434046843*^9, 3.770721434486648*^9}, {3.7746909735763407`*^9, 
   3.774690974277783*^9}, 3.786090308105297*^9, 3.7860903405306396`*^9, {
   3.7861697725876913`*^9, 3.7861697838397303`*^9}, {3.7861698579109*^9, 
   3.7861698645494623`*^9}, {3.786257005170101*^9, 3.786257029661643*^9}, {
   3.786259628183383*^9, 3.78625966453019*^9}, {3.7862596972230663`*^9, 
   3.7862597130857067`*^9}, {3.786260599076335*^9, 3.7862606519012136`*^9}, {
   3.786260711471278*^9, 3.7862607825400476`*^9}, {3.786262427305735*^9, 
   3.7862624297094097`*^9}, {3.786262672446123*^9, 3.7862626757022247`*^9}, {
   3.7941372405540857`*^9, 3.794137240568924*^9}, 3.798128132723709*^9, {
   3.798232559307932*^9, 3.798232607817318*^9}, 3.8002032936287107`*^9, {
   3.800228806267811*^9, 3.8002288701566067`*^9}, {3.800229240434243*^9, 
   3.8002292588092833`*^9}, {3.800230257115494*^9, 3.800230271819356*^9}, {
   3.800230689976359*^9, 3.800230696507571*^9}, {3.800230861506472*^9, 
   3.8002308853617268`*^9}, {3.800231148936945*^9, 3.8002311628361807`*^9}, {
   3.800269707014142*^9, 3.80026972050751*^9}, {3.8004654280139236`*^9, 
   3.8004654993620977`*^9}, {3.807369332962606*^9, 3.807369333743342*^9}, {
   3.807369626808475*^9, 3.807369633505528*^9}, {3.807376451767674*^9, 
   3.807376461724361*^9}, {3.8154778674250393`*^9, 3.8154778786474133`*^9}, {
   3.8154783955502*^9, 3.8154784000536633`*^9}, {3.815479106257626*^9, 
   3.815479107656157*^9}, {3.829315987079705*^9, 3.829316001463244*^9}, 
   3.833033078563163*^9, {3.833033108685328*^9, 3.833033148581917*^9}, 
   3.833038502668605*^9, 3.835030194667267*^9, {3.859148473878541*^9, 
   3.859148484706414*^9}, 3.8591503881615667`*^9, 3.8594808660648727`*^9, 
   3.8594809215028048`*^9, {3.859481010380721*^9, 3.859481014177998*^9}, {
   3.85948118066334*^9, 3.859481183379318*^9}, {3.859481298816181*^9, 
   3.859481315770236*^9}, {3.859481351730167*^9, 3.859481376563326*^9}, {
   3.8595884244545803`*^9, 3.859588479932879*^9}, {3.859588743998242*^9, 
   3.859588765495607*^9}, {3.859588806482554*^9, 3.859588926483329*^9}, {
   3.859589076697467*^9, 3.8595890862667627`*^9}, {3.859589141801827*^9, 
   3.859589247695283*^9}, {3.859589278802657*^9, 3.8595893184973927`*^9}, {
   3.859589355053155*^9, 3.859589394885363*^9}, {3.8595894565019217`*^9, 
   3.859589464785759*^9}, {3.859589499943409*^9, 3.8595895551048613`*^9}, {
   3.859589593067071*^9, 3.8595896843311996`*^9}, 3.859589915082026*^9, {
   3.859589979348977*^9, 3.8595899793771067`*^9}, {3.859590726243621*^9, 
   3.859590757603325*^9}, 3.859640095466408*^9, {3.859648360374277*^9, 
   3.859648389450727*^9}, {3.859649217444069*^9, 3.85964922877459*^9}, {
   3.859657651647107*^9, 3.859657715461317*^9}, {3.8597223431582127`*^9, 
   3.859722349203199*^9}, {3.870793309356901*^9, 3.870793309988036*^9}, 
   3.870810224016097*^9, {3.871909025974709*^9, 3.871909029201529*^9}, 
   3.8719101640474253`*^9, 3.8719116216008463`*^9, {3.8719117586639767`*^9, 
   3.8719117851224957`*^9}, {3.871911824020739*^9, 3.871911898782824*^9}, {
   3.8719119821779833`*^9, 3.871912009909605*^9}, {3.8719124337875853`*^9, 
   3.871912435171369*^9}, {3.8719131498057203`*^9, 3.871913180106717*^9}, {
   3.871913220456274*^9, 3.871913227902382*^9}, {3.8719134735780153`*^9, 
   3.871913509640698*^9}, {3.8719136888826103`*^9, 3.8719137381955547`*^9}, {
   3.871914277230426*^9, 3.871914282229678*^9}, {3.871917802088578*^9, 
   3.871917805074687*^9}, {3.8786729753409986`*^9, 3.878672995239841*^9}, {
   3.895730252940528*^9, 3.895730278366877*^9}, {3.8957303334834337`*^9, 
   3.895730334583846*^9}, 3.895730555648501*^9, {3.8957403869975033`*^9, 
   3.895740409874614*^9}, {3.8957405918184423`*^9, 
   3.895740593502267*^9}},ExpressionUUID->"18468973-76fd-4a55-a05d-\
338d246c3279"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",ExpressionUUID->"02f1735a-c9d7-4585-9cd6-06d84a031d10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "EcoEq", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "Automatic"}], ",", "\n", 
     RowBox[{"SolveOpts", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"NSolveOpts", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Method", "\[Rule]", "\"\<EndomorphismMatrix\>\""}], "}"}]}], 
     ",", 
     RowBox[{"FindRootOpts", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"FindRootsOpts", "->", 
      RowBox[{"{", "}"}]}], ",", "\n", 
     RowBox[{"PerCapita", "\[Rule]", "False"}], ",", 
     RowBox[{"Fixed", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Chop", "\[Rule]", "True"}], ",", 
     RowBox[{"QSS", "\[Rule]", "False"}], ",", 
     RowBox[{"Time", "\[Rule]", "t"}], ",", 
     RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
     RowBox[{"Verbosity", "->", "0"}], ",", 
     RowBox[{"IgnoreVar", "->", "False"}]}], "}"}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.68788145061252*^9, {3.6885716849598207`*^9, 3.688571685061096*^9}, 
   3.6998307192614937`*^9, {3.699830756047996*^9, 3.699830757855876*^9}, {
   3.7146768525874043`*^9, 3.714676860849709*^9}, {3.714771544699765*^9, 
   3.714771544916628*^9}, 3.725140957991322*^9, {3.755266321588594*^9, 
   3.755266324656404*^9}, 3.7553697389508457`*^9, 3.755370573729661*^9, 
   3.75994589946877*^9, 3.7701200065679617`*^9, {3.770645589515258*^9, 
   3.770645593339229*^9}, {3.7982325865648317`*^9, 3.798232589900823*^9}, {
   3.817979839496348*^9, 3.817979840182137*^9}, {3.817986745774179*^9, 
   3.817986747250039*^9}, 3.817986827594922*^9, 3.8293159782581778`*^9, {
   3.859588972329741*^9, 3.859588974605693*^9}, {3.859590467440824*^9, 
   3.859590470000128*^9}, {3.8708128961119843`*^9, 3.870812906654851*^9}, 
   3.870813046791561*^9, {3.8719137515576057`*^9, 
   3.871913757389619*^9}},ExpressionUUID->"78ce2824-75a7-4987-8d29-\
b91a275f217e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Aliases", "Subsubsection",
 CellChangeTimes->{{3.7085811611223593`*^9, 
  3.708581162674871*^9}},ExpressionUUID->"b5cbbcce-7db5-4aa3-ac37-\
3914d6d8eb2e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"SolveEcoEq", "[", "args___", "]"}], ":=", 
    RowBox[{"EcoEq", "[", 
     RowBox[{"args", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Solve\>\""}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NSolveEcoEq", "[", "args___", "]"}], ":=", 
    RowBox[{"EcoEq", "[", 
     RowBox[{"args", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<NSolve\>\""}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"FindEcoEq", "[", "args___", "]"}], ":=", 
    RowBox[{"EcoEq", "[", 
     RowBox[{"args", ",", 
      RowBox[{"Method", "->", "\"\<FR\>\""}]}], "]"}]}], ";"}], 
  "*)"}]], "Code",
 CellChangeTimes->{{3.6954002528825893`*^9, 3.6954002987471733`*^9}, {
   3.77011897906663*^9, 3.770118987277129*^9}, 3.770119020875732*^9, 
   3.7981288000399113`*^9, 3.8073693346470118`*^9, {3.81438990695761*^9, 
   3.8143899131000957`*^9}, {3.8143899746384087`*^9, 3.814389993292912*^9}, {
   3.814390186424676*^9, 3.81439019161605*^9}, 3.8708020739334593`*^9, 
   3.8708090047235937`*^9, 3.870809220595193*^9, {3.871908024647472*^9, 
   3.8719080284345627`*^9}, {3.871910702105624*^9, 3.871910728091806*^9}, {
   3.87191112702265*^9, 3.871911176782353*^9}, {3.871913764132082*^9, 
   3.871913764556017*^9}, {3.895731399497059*^9, 3.895731428343821*^9}, {
   3.895731510409684*^9, 3.895731532362254*^9}, {3.895741126865736*^9, 
   3.895741127147195*^9}, {3.8957411687521763`*^9, 3.895741172750937*^9}, {
   3.8957412067020063`*^9, 3.895741207017415*^9}, {3.89574157804467*^9, 
   3.895741579026875*^9}, 
   3.8957420320936737`*^9},ExpressionUUID->"68f89b0e-5fee-4fbf-9f15-\
6fcdde8e3abc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Messages", "Subsubsection",
 CellChangeTimes->{{3.7695018515541153`*^9, 
  3.769501852845079*^9}},ExpressionUUID->"a0633838-c88f-4d52-8b68-\
8e6888510716"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "::", "noneq"}], "=", "\n", 
   "\"\<Can't find equilibrium of periodically forced model with FindRoot.  \
Give Time option or try FindEcoCycle instead.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "::", "nosol"}], "=", 
   "\"\<`1` couldn't find a solution.  Try FindEcoEq instead.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "::", "badmtd"}], "=", 
   "\"\<Method is not known (\\\"Solve\\\",\\\"NSolve\\\",\\\"FindRoot\\\",\\\
\"FindRoots\\\").\>\""}], ";"}]}], "Code",
 CellChangeTimes->{{3.769501857001574*^9, 3.769501857579821*^9}, {
  3.8596474251654797`*^9, 3.859647429307817*^9}, {3.8719132863927526`*^9, 
  3.871913346568707*^9}},ExpressionUUID->"72ec5213-0fe9-432d-8057-\
8b6cf753af3e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SolveEcoEq", "Subsection",
 CellChangeTimes->{{3.895742022831253*^9, 
  3.895742024298085*^9}},ExpressionUUID->"ae80f2a0-faaf-421f-afa4-\
248fd0788fa1"],

Cell[CellGroupData[{

Cell["Parser", "Subsubsection",
 CellChangeTimes->{{3.895742132808029*^9, 
  3.895742135154181*^9}},ExpressionUUID->"f5a0d152-5c6a-4890-a8e0-\
323e332777f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SolveEcoEq", "[", "in___", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"func", "=", "SolveEcoEq"}], ",", "args", ",", "opts", ",", 
       "rest", ",", "parameters", ",", "attributes", ",", "Gs", ",", 
       "variables", ",", "variableslist", ",", "\n", "vars"}], "}"}], ",", 
     "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<in=\>\"", ",", "in"}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"args", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ExtractArgs", "[", 
         RowBox[{
          RowBox[{"{", "in", "}"}], ",", "func"}], "]"}], "]"}]}], ";", "\n", 
      
      RowBox[{"opts", "=", 
       RowBox[{"ExtractOpts", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", "func"}], "]"}]}], ";", "\n", 
      RowBox[{"vars", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "==", "Symbol"}], "&"}]}], 
           "]"}], "&"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vars", "==", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"vars", "=", "All"}], ",", 
        RowBox[{"vars", "=", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<args=\>\"", ",", "args"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<opts=\>\"", ",", "opts"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<vars=\>\"", ",", "vars"}], "]"}], ";"}], "*)"}], "\n", 
      "\n", 
      RowBox[{"parameters", "=", 
       RowBox[{"ExtractParameters", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"attributes", "=", 
       RowBox[{"ExtractAttributes", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"Gs", "=", 
       RowBox[{"ExtractVarCovs", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parameters=\>\"", ",", "parameters"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<attributes=\>\"", ",", "attributes"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"iSolveEcoEq", "[", 
       RowBox[{
       "parameters", ",", "attributes", ",", "Gs", ",", "vars", ",", "opts"}],
        "]"}]}]}], "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.7127802306821003`*^9, 3.71278023163732*^9}, {
   3.769860889371685*^9, 3.769860898625585*^9}, {3.890088762767192*^9, 
   3.8900887857559834`*^9}, {3.890088825582732*^9, 3.8900888418951406`*^9}, {
   3.8900889470940847`*^9, 3.890088957136177*^9}, {3.8901267099939337`*^9, 
   3.890126710376408*^9}, {3.89012675925627*^9, 3.89012677188067*^9}, {
   3.890147666024979*^9, 3.890147669484149*^9}, {3.895556083668763*^9, 
   3.895556095879417*^9}, 3.8955566991026297`*^9, {3.8955577669801817`*^9, 
   3.8955577681779213`*^9}, {3.8955622577005453`*^9, 3.895562258529551*^9}, 
   3.89556232631433*^9, {3.89556263361314*^9, 3.8955626472449636`*^9}, {
   3.895562842722169*^9, 3.895562849597785*^9}, {3.895563092493565*^9, 
   3.895563126066338*^9}, {3.895563181729741*^9, 3.89556321475914*^9}, {
   3.895565622997553*^9, 3.895565825215711*^9}, {3.895566197384026*^9, 
   3.8955663023293247`*^9}, {3.8955663794538603`*^9, 3.895566420626652*^9}, {
   3.895567028632929*^9, 3.895567029623745*^9}, {3.895567212564479*^9, 
   3.895567218896427*^9}, {3.895567272624502*^9, 3.895567274409018*^9}, {
   3.8955675907546473`*^9, 3.895567768041896*^9}, {3.895567851076992*^9, 
   3.895567855084454*^9}, {3.895567885960531*^9, 3.8955679150019197`*^9}, {
   3.8955680083366737`*^9, 3.895568008699531*^9}, {3.895568048854352*^9, 
   3.895568157442192*^9}, {3.895568229874014*^9, 3.895568253702044*^9}, {
   3.8955693854122*^9, 3.8955694265490522`*^9}, 3.895575272473558*^9, {
   3.895575467928422*^9, 3.8955755135470257`*^9}, 3.895575682651147*^9, 
   3.895578721564733*^9, 3.895579374206821*^9, {3.89557941527911*^9, 
   3.8955794329631166`*^9}, {3.8955794748472223`*^9, 3.895579478562263*^9}, {
   3.895579560992878*^9, 3.895579561228808*^9}, {3.8955796500246983`*^9, 
   3.8955796662780857`*^9}, {3.895579769850182*^9, 3.895579777141037*^9}, {
   3.895579856895706*^9, 3.8955798595931683`*^9}, 3.895588510289165*^9, {
   3.8955886111527357`*^9, 3.895588612849946*^9}, {3.895589347468148*^9, 
   3.895589379222314*^9}, 3.895589610715495*^9, {3.895590444412505*^9, 
   3.895590453519902*^9}, 3.895590508127524*^9, 3.8955905439582157`*^9, {
   3.895592440937796*^9, 3.895592532735264*^9}, {3.895592590752514*^9, 
   3.895592650561548*^9}, {3.8955927319425507`*^9, 3.895592749052278*^9}, {
   3.8955928168610477`*^9, 3.895592818217918*^9}, {3.895592874955657*^9, 
   3.895592877402446*^9}, {3.8955932689174023`*^9, 3.895593272134426*^9}, {
   3.8955933455504208`*^9, 3.895593351409342*^9}, {3.895593492152051*^9, 
   3.895593498259594*^9}, {3.8955937696317577`*^9, 3.895593822470418*^9}, {
   3.895594059820359*^9, 3.895594072801594*^9}, {3.895594137936792*^9, 
   3.895594145714094*^9}, {3.895594303461802*^9, 3.895594305709622*^9}, 
   3.895594386310108*^9, {3.895594605950818*^9, 3.895594668846685*^9}, 
   3.8955947205307293`*^9, {3.8955949418141413`*^9, 3.895594948532854*^9}, {
   3.895594990704443*^9, 3.895594992920826*^9}, {3.895595557746958*^9, 
   3.895595583989648*^9}, 3.895595615253611*^9, {3.895595728916885*^9, 
   3.895595737345203*^9}, {3.895596389418861*^9, 3.89559639595473*^9}, {
   3.895723271852386*^9, 3.8957232826615477`*^9}, {3.8957234998949127`*^9, 
   3.895723500200151*^9}, {3.8957242143085203`*^9, 3.895724217157454*^9}, {
   3.895724248060494*^9, 3.8957243588861322`*^9}, {3.89572449468648*^9, 
   3.895724523840683*^9}, 3.8957253216621437`*^9, {3.895725378768009*^9, 
   3.895725408595636*^9}, {3.8957259620756197`*^9, 3.895725965867037*^9}, 
   3.895728224448289*^9, 3.895728385634983*^9, {3.8957300332924833`*^9, 
   3.895730144758787*^9}, {3.8957301798778553`*^9, 3.895730182357575*^9}, {
   3.895730289538713*^9, 3.895730391101716*^9}, {3.895730526156761*^9, 
   3.895730532051901*^9}, {3.89573058065491*^9, 3.8957306458853292`*^9}, 
   3.895730712347293*^9, {3.895730770671678*^9, 3.8957308047917347`*^9}, {
   3.895730894218618*^9, 3.895730896210866*^9}, 3.895730996639587*^9, {
   3.895731039820635*^9, 3.895731053193363*^9}, {3.895731088006267*^9, 
   3.8957311912927027`*^9}, 3.895731256114368*^9, {3.895731355063397*^9, 
   3.895731359533929*^9}, {3.895731606212158*^9, 3.89573165236588*^9}, 
   3.895732191332889*^9, {3.895732243309506*^9, 3.895732244028244*^9}, {
   3.895733005810913*^9, 3.8957330070744953`*^9}, {3.895733079504335*^9, 
   3.8957330993229094`*^9}, {3.895733177048377*^9, 3.8957331856636963`*^9}, {
   3.895733261265317*^9, 3.8957333102784653`*^9}, {3.895733341083591*^9, 
   3.8957333617799177`*^9}, {3.895739915028021*^9, 3.8957399168763523`*^9}, {
   3.895739956286934*^9, 3.895739960845393*^9}, {3.895740036353834*^9, 
   3.8957400475824833`*^9}, 3.895740267670516*^9, {3.895740363081471*^9, 
   3.895740370369906*^9}, {3.895740401135902*^9, 3.89574040209801*^9}, {
   3.8957405628990307`*^9, 3.8957405644202223`*^9}, {3.895740604411921*^9, 
   3.895740610039589*^9}, {3.895740755442668*^9, 3.8957407775015907`*^9}, {
   3.895740883555833*^9, 3.895740889820269*^9}, {3.895741220046998*^9, 
   3.895741223130054*^9}, {3.895741466079542*^9, 3.895741521576285*^9}, {
   3.8957415922179947`*^9, 3.895741593243791*^9}, {3.895742043090199*^9, 
   3.895742105361751*^9}, {3.895746970312196*^9, 3.89574697476753*^9}, {
   3.895747703952667*^9, 3.895747706950245*^9}, {3.895747796836274*^9, 
   3.8957477997877274`*^9}},ExpressionUUID->"3af9ae23-d888-4499-a1dd-\
1f672ffa1a5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition", "Subsubsection",
 CellChangeTimes->{{3.7694936745853653`*^9, 
  3.769493676072991*^9}},ExpressionUUID->"3507ba4e-1157-438c-96bb-\
40fc633bc396"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iSolveEcoEq", "[", 
    RowBox[{"pars_", ",", "attributesin_", ",", "Gsin_", ",", "vars_", ",", 
     RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{"(*", " ", "options", " ", "*)"}], "\n", 
      RowBox[{
      "method", ",", "solveopts", ",", "\n", "boundarydetection", ",", "time",
        ",", "fixed", ",", "chop", ",", "qss", ",", "percapita", ",", 
       "verbose", ",", "ignorevar", ",", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"other", " ", "variables"}], " ", "*)"}], "\n", "attributes", 
       ",", "nonvars", ",", "nonfixedvars", ",", "fixedvars", ",", "Gs", ",", 
       "removets", ",", "eqns", ",", "unks", ",", "newunk", ",", "sol", ",", 
       "res"}], "}"}], ",", "\n", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[ScriptCapitalN]", ",", "verbosity", ",", 
         RowBox[{"func", "=", "\"\<SolveEcoEq\>\""}]}], "}"}], ",", "\n", 
       "\n", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"set", " ", "verbosity"}], " ", "*)"}], "\n", "\n", 
        RowBox[{"verbose", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Verbose", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Verbosity", "/.", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"opts", ",", 
                  RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
              "]"}]}], "]"}]}], ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Verbosity", "/.", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"opts", ",", 
                RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "Global`$verbosity", "]"}], ",", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"Global`$verbosity", ",", "verbosity"}], "]"}]}]}], "]"}],
         ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"handle", " ", "options"}], " ", "*)"}], "\n", "\n", 
        RowBox[{"method", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Method", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "===", "Automatic"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"init", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"method", "=", "\"\<FindRoot\>\""}], ",", 
            RowBox[{"method", "=", "\"\<Solve\>\""}]}], "]"}]}], "]"}], ";", 
        "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<method=\>\"", ",", "method"}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"solveopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"SolveOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"boundarydetection", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"BoundaryDetection", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"time", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Time", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"chop", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Chop", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"qss", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"QSS", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"fixed", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Fixed", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"percapita", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"PerCapita", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"ignorevar", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"IgnoreVar", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"fix", " ", "attributes"}], " ", "*)"}], "\n", 
        RowBox[{"attributes", "=", 
         RowBox[{"FixAttributes", "[", "attributesin", "]"}]}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "figure", " ", "out", " ", "number", " ", "of", " ", "species", " ", 
          "in", " ", "guilds"}], " ", "*)"}], "\n", 
        RowBox[{"Set\[ScriptCapitalN]", "[", "attributes", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<\[ScriptCapitalN]=\>\"", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"expand", " ", "Gs"}], " ", "*)"}], "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gsin=\>\"", ",", "Gsin"}], "]"}], ";", "\n", 
        RowBox[{"Gs", "=", 
         RowBox[{"ExpandGs", "[", 
          RowBox[{"Gsin", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[FormalCapitalN]", "[", "gu", "]"}], "\[Rule]", 
              RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}]}], ";", 
        "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vars", "===", "All"}], ",", "\n", "\t", 
          RowBox[{"nonvars", "=", 
           RowBox[{"{", "}"}]}], ",", "\n", "\t", 
          RowBox[{"nonvars", "=", 
           RowBox[{"OrderedComplement", "[", 
            RowBox[{"AllVariables", ",", "vars"}], "]"}]}]}], "\n", "]"}], 
        ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonvars=\>\"", ",", "nonvars"}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"qss", "\[Equal]", "False"}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "0"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "x"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<fixed=\>\"", ",", "fixed"}], "]"}], ";", "\n",
         "\n", 
        RowBox[{"fixedvars", "=", 
         RowBox[{"fixed", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        RowBox[{"nonfixedvars", "=", 
         RowBox[{"OrderedComplement", "[", 
          RowBox[{"AllVariables", ",", "fixedvars"}], "]"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonfixedvars=\>\"", ",", "nonfixedvars"}], 
         "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"set", " ", "eqns"}], " ", "*)"}], "\n", 
        RowBox[{"eqns", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"EcoEqns", "[", 
               RowBox[{"attributes", ",", 
                RowBox[{"Fixed", "\[Rule]", "fixed"}], ",", 
                RowBox[{"PerCapita", "\[Rule]", "percapita"}], ",", 
                RowBox[{"IgnoreVar", "->", "ignorevar"}]}], "]"}], "/.", 
              "Eq"}], "/.", 
             RowBox[{"t", "\[Rule]", "time"}]}], "/.", "fixed"}], "/.", 
           "attributes"}], "/.", "Gs"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<eqns=\>\"", ",", "eqns"}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"solve", " ", "it"}], " ", "*)"}], "\n", 
        RowBox[{"unks", "=", "nonfixedvars"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"eqns", "=", "eqns"}], ",", 
              RowBox[{"unks", "=", "unks"}], ",", 
              RowBox[{"options", "=", 
               RowBox[{"Sequence", "@@", "solveopts"}]}]}], "}"}], ",", 
            RowBox[{"PrintCall", "[", 
             RowBox[{"Global`sol", "=", 
              RowBox[{"Solve", "[", 
               RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
             "]"}]}], "]"}]}], "]"}], ";", "\n", 
        RowBox[{"sol", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{"eqns", ",", "unks", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", "solveopts"}], "]"}]}], "]"}]}], ";", 
        "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "sol", "]"}], "===", "Solve"}], ",", 
          RowBox[{"sol", "=", 
           RowBox[{"Solve", "[", 
            RowBox[{"eqns", ",", "unks", ",", "Reals", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Sequence", "@@", "solveopts"}], "]"}]}], "]"}]}]}], 
         "]"}], ";", "\n", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<sol=\>\"", ",", "sol"}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "sol", "]"}], "===", "\"\<Solve\>\""}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"EcoEq", "::", "nosol"}], ",", 
             RowBox[{"Head", "[", "sol", "]"}]}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"add", " ", "in", " ", "Fixed", " ", "variables"}], " ", 
         "*)"}], "\n", 
        RowBox[{"res", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"fixed", ",", 
               RowBox[{"var_", "\[Rule]", "var_"}]}], "]"}], ",", "#"}], 
            "]"}], "&"}], " ", "/@", " ", "sol"}]}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"chop", ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", 
              RowBox[{"Chop", "[", "res", "]"}], "]"}], ",", "AllVariables"}],
             "]"}], "]"}], ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", "res", "]"}], ",", "AllVariables"}], 
            "]"}], "]"}]}], "\n", "]"}], ";"}]}], "\n", "\n", "]"}]}], 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.687881450105945*^9, 3.6878814505620613`*^9}, {
   3.68857168476537*^9, 3.688571684934305*^9}, {3.6885717562075033`*^9, 
   3.688571756902958*^9}, {3.688571805445076*^9, 3.6885718054840527`*^9}, {
   3.6885777801299953`*^9, 3.688577821198338*^9}, {3.688578111707645*^9, 
   3.688578263696265*^9}, {3.688583189141659*^9, 3.688583201104134*^9}, {
   3.6885837935779333`*^9, 3.688583810589251*^9}, {3.688583857663521*^9, 
   3.688583866440373*^9}, 3.688584023610524*^9, {3.688584454327429*^9, 
   3.688584464134824*^9}, {3.6885851260336657`*^9, 3.6885852077551622`*^9}, 
   3.688685223038662*^9, {3.693593326673889*^9, 3.693593328006213*^9}, {
   3.693651209563744*^9, 3.693651212696253*^9}, {3.693651330751341*^9, 
   3.693651337237907*^9}, {3.693700342037077*^9, 3.6937003445534773`*^9}, {
   3.69961046687166*^9, 3.699610497623667*^9}, 3.709124896659213*^9, {
   3.709336699110145*^9, 3.709336699577385*^9}, {3.7101059510781393`*^9, 
   3.710105954644555*^9}, {3.710254347130986*^9, 3.710254357145165*^9}, {
   3.710254389172209*^9, 3.7102544454183407`*^9}, {3.710286418340989*^9, 
   3.710286419629771*^9}, 3.710286914350444*^9, 3.7127385346721067`*^9, {
   3.714088449593779*^9, 3.714088465042605*^9}, {3.714088783139654*^9, 
   3.714088791448407*^9}, {3.714088844203219*^9, 3.71408885600861*^9}, 
   3.714089170503827*^9, {3.7140892855105886`*^9, 3.7140893056027193`*^9}, {
   3.7146455898601007`*^9, 3.714645607554661*^9}, {3.714645833218658*^9, 
   3.714645878205338*^9}, {3.7146594716484127`*^9, 3.714659498519136*^9}, {
   3.714659560420806*^9, 3.714659597546504*^9}, {3.714661306250412*^9, 
   3.7146613128544407`*^9}, {3.7146613520466423`*^9, 3.714661374692927*^9}, {
   3.714661426985828*^9, 3.714661471021627*^9}, {3.714670952581798*^9, 
   3.7146709761045732`*^9}, {3.714673053941062*^9, 3.71467307388553*^9}, {
   3.714673325535184*^9, 3.7146733431977777`*^9}, {3.714673385822101*^9, 
   3.714673408156714*^9}, {3.7146763296033154`*^9, 3.714676349908175*^9}, {
   3.714676870217898*^9, 3.7146768813446712`*^9}, {3.714677005871266*^9, 
   3.7146770388481817`*^9}, {3.714677885477186*^9, 3.714677895396152*^9}, {
   3.7146815798359137`*^9, 3.71468158317702*^9}, {3.714686709068077*^9, 
   3.714686720449131*^9}, {3.714686780357995*^9, 3.714686847805605*^9}, {
   3.714686886251251*^9, 3.7146869069408197`*^9}, {3.7146904343318*^9, 
   3.714690435561199*^9}, {3.7146905887398357`*^9, 3.714690601923481*^9}, {
   3.714690631972337*^9, 3.714690933211876*^9}, {3.714691441205781*^9, 
   3.7146914443765163`*^9}, 3.714771558293874*^9, {3.71477345759927*^9, 
   3.714773544216226*^9}, {3.714773631881823*^9, 3.714773638759398*^9}, {
   3.7147737076976557`*^9, 3.714773768872843*^9}, {3.714773810344654*^9, 
   3.714773862655966*^9}, {3.714774175646474*^9, 3.714774238321686*^9}, {
   3.714774276778345*^9, 3.714774313756324*^9}, {3.714774363666697*^9, 
   3.714774431577939*^9}, {3.71477474128935*^9, 3.714774765274622*^9}, {
   3.714774824264062*^9, 3.7147748384112673`*^9}, {3.7147748942865953`*^9, 
   3.7147749226594543`*^9}, {3.7147749728240833`*^9, 
   3.7147749743011627`*^9}, {3.714777387544536*^9, 3.714777422944803*^9}, {
   3.715423204967746*^9, 3.715423247100832*^9}, {3.716851794553669*^9, 
   3.716851838573512*^9}, {3.716851923962669*^9, 3.71685195096766*^9}, {
   3.716852009532653*^9, 3.716852055393906*^9}, {3.716852216771632*^9, 
   3.71685231192962*^9}, {3.7168523670615377`*^9, 3.71685238929698*^9}, {
   3.7168524239048243`*^9, 3.716852506519627*^9}, {3.7168526119630947`*^9, 
   3.716852660342918*^9}, {3.720561423750366*^9, 3.720561426334433*^9}, {
   3.720561478834214*^9, 3.720561481166069*^9}, {3.721849189319437*^9, 
   3.72184920349916*^9}, {3.721849430040469*^9, 3.7218494327297087`*^9}, 
   3.7218496199026947`*^9, {3.722043437583398*^9, 3.722043661426222*^9}, {
   3.722083757551734*^9, 3.72208381655929*^9}, {3.725055711251069*^9, 
   3.725055715332081*^9}, 3.7251409579843616`*^9, 3.725141965221623*^9, {
   3.728485760884264*^9, 3.728485790162279*^9}, {3.728492488068541*^9, 
   3.728492510850383*^9}, {3.728493399302709*^9, 3.728493401619061*^9}, {
   3.7284934402687283`*^9, 3.728493443062832*^9}, {3.728495197386813*^9, 
   3.7284952624184313`*^9}, {3.728495727453259*^9, 3.7284957368624372`*^9}, {
   3.728495928466558*^9, 3.72849592873841*^9}, {3.731976096240344*^9, 
   3.7319762267049303`*^9}, {3.731976277432869*^9, 3.7319762780290833`*^9}, {
   3.7319768020188913`*^9, 3.731976803777299*^9}, {3.731976892921598*^9, 
   3.731976916165578*^9}, {3.731976959563902*^9, 3.731976962085402*^9}, {
   3.731977155942281*^9, 3.73197716443357*^9}, {3.731977195279862*^9, 
   3.7319772065728207`*^9}, {3.731977279507853*^9, 3.731977284166617*^9}, {
   3.731977461555399*^9, 3.731977465980788*^9}, {3.731978006012163*^9, 
   3.731978013040636*^9}, {3.731978082421216*^9, 3.731978094010425*^9}, {
   3.731979039353709*^9, 3.731979039363929*^9}, {3.731979598523592*^9, 
   3.73197961490341*^9}, {3.73197972820308*^9, 3.7319797289924088`*^9}, {
   3.731980249144205*^9, 3.73198026694471*^9}, 3.731980373788886*^9, {
   3.7319804050810537`*^9, 3.731980445644969*^9}, {3.731980548309566*^9, 
   3.731980566185113*^9}, {3.731980610588462*^9, 3.7319806369962673`*^9}, {
   3.731980738391506*^9, 3.731980763895586*^9}, {3.731980818773868*^9, 
   3.731980857708199*^9}, {3.731980943731715*^9, 3.731981000719969*^9}, 
   3.731981067123608*^9, {3.732221099817436*^9, 3.7322211073866863`*^9}, {
   3.732237132742322*^9, 3.73223714782172*^9}, {3.732237266376129*^9, 
   3.732237271289744*^9}, {3.732273382440886*^9, 3.73227340932165*^9}, {
   3.732273491519849*^9, 3.732273491669429*^9}, {3.732394286439495*^9, 
   3.732394371996009*^9}, 3.755182267229639*^9, 3.755184973022751*^9, {
   3.75582209648076*^9, 3.7558220982190313`*^9}, {3.7558225635660257`*^9, 
   3.7558225772644787`*^9}, {3.7585221898099403`*^9, 3.7585221899906693`*^9}, 
   3.759140406004279*^9, {3.75914072046175*^9, 3.759140778591229*^9}, {
   3.759141110454555*^9, 3.7591411170112877`*^9}, 3.759142070148613*^9, {
   3.759926864600369*^9, 3.759926908779594*^9}, {3.7599440817309227`*^9, 
   3.759944089031756*^9}, {3.7599442652749147`*^9, 3.7599442925085506`*^9}, {
   3.759944468213972*^9, 3.759944470421031*^9}, {3.759944509678103*^9, 
   3.759944625568841*^9}, {3.759944680926206*^9, 3.759944704050845*^9}, {
   3.759944777100625*^9, 3.759944777332377*^9}, {3.7599452123441133`*^9, 
   3.759945212472487*^9}, 3.761151167307536*^9, 3.7613779187363462`*^9, {
   3.769182368428945*^9, 3.7691823684332743`*^9}, {3.769182447225265*^9, 
   3.769182447229724*^9}, 3.7697607053790417`*^9, 3.770438265000821*^9, {
   3.770721434046843*^9, 3.770721434486648*^9}, {3.7746909735763407`*^9, 
   3.774690974277783*^9}, 3.786090308105297*^9, 3.7860903405306396`*^9, {
   3.7861697725876913`*^9, 3.7861697838397303`*^9}, {3.7861698579109*^9, 
   3.7861698645494623`*^9}, {3.786257005170101*^9, 3.786257029661643*^9}, {
   3.786259628183383*^9, 3.78625966453019*^9}, {3.7862596972230663`*^9, 
   3.7862597130857067`*^9}, {3.786260599076335*^9, 3.7862606519012136`*^9}, {
   3.786260711471278*^9, 3.7862607825400476`*^9}, {3.786262427305735*^9, 
   3.7862624297094097`*^9}, {3.786262672446123*^9, 3.7862626757022247`*^9}, {
   3.7941372405540857`*^9, 3.794137240568924*^9}, 3.798128132723709*^9, {
   3.798232559307932*^9, 3.798232607817318*^9}, 3.8002032936287107`*^9, {
   3.800228806267811*^9, 3.8002288701566067`*^9}, {3.800229240434243*^9, 
   3.8002292588092833`*^9}, {3.800230257115494*^9, 3.800230271819356*^9}, {
   3.800230689976359*^9, 3.800230696507571*^9}, {3.800230861506472*^9, 
   3.8002308853617268`*^9}, {3.800231148936945*^9, 3.8002311628361807`*^9}, {
   3.800269707014142*^9, 3.80026972050751*^9}, {3.8004654280139236`*^9, 
   3.8004654993620977`*^9}, {3.807369332962606*^9, 3.807369333743342*^9}, {
   3.807369626808475*^9, 3.807369633505528*^9}, {3.807376451767674*^9, 
   3.807376461724361*^9}, {3.8154778674250393`*^9, 3.8154778786474133`*^9}, {
   3.8154783955502*^9, 3.8154784000536633`*^9}, {3.815479106257626*^9, 
   3.815479107656157*^9}, {3.829315987079705*^9, 3.829316001463244*^9}, 
   3.833033078563163*^9, {3.833033108685328*^9, 3.833033148581917*^9}, 
   3.833038502668605*^9, 3.835030194667267*^9, {3.859148473878541*^9, 
   3.859148484706414*^9}, 3.8591503881615667`*^9, 3.8594808660648727`*^9, 
   3.8594809215028048`*^9, {3.859481010380721*^9, 3.859481014177998*^9}, {
   3.85948118066334*^9, 3.859481183379318*^9}, {3.859481298816181*^9, 
   3.859481315770236*^9}, {3.859481351730167*^9, 3.859481376563326*^9}, {
   3.8595884244545803`*^9, 3.859588479932879*^9}, {3.859588743998242*^9, 
   3.859588765495607*^9}, {3.859588806482554*^9, 3.859588926483329*^9}, {
   3.859589076697467*^9, 3.8595890862667627`*^9}, {3.859589141801827*^9, 
   3.859589247695283*^9}, {3.859589278802657*^9, 3.8595893184973927`*^9}, {
   3.859589355053155*^9, 3.859589394885363*^9}, {3.8595894565019217`*^9, 
   3.859589464785759*^9}, {3.859589499943409*^9, 3.8595895551048613`*^9}, {
   3.859589593067071*^9, 3.8595896843311996`*^9}, 3.859589915082026*^9, {
   3.859589979348977*^9, 3.8595899793771067`*^9}, {3.859590726243621*^9, 
   3.859590757603325*^9}, 3.859640095466408*^9, {3.859648360374277*^9, 
   3.859648389450727*^9}, {3.859649217444069*^9, 3.85964922877459*^9}, {
   3.859657651647107*^9, 3.859657715461317*^9}, {3.8597223431582127`*^9, 
   3.859722349203199*^9}, {3.870793309356901*^9, 3.870793309988036*^9}, 
   3.870810224016097*^9, {3.871909025974709*^9, 3.871909029201529*^9}, 
   3.8719101640474253`*^9, 3.8719116216008463`*^9, {3.8719117586639767`*^9, 
   3.8719117851224957`*^9}, {3.871911824020739*^9, 3.871911898782824*^9}, {
   3.8719119821779833`*^9, 3.871912009909605*^9}, {3.8719124337875853`*^9, 
   3.871912435171369*^9}, {3.8719131498057203`*^9, 3.871913180106717*^9}, {
   3.871913220456274*^9, 3.871913227902382*^9}, {3.8719134735780153`*^9, 
   3.871913509640698*^9}, {3.8719136888826103`*^9, 3.8719137381955547`*^9}, {
   3.871914277230426*^9, 3.871914282229678*^9}, {3.871917802088578*^9, 
   3.871917805074687*^9}, {3.8786729753409986`*^9, 3.878672995239841*^9}, {
   3.895730252940528*^9, 3.895730278366877*^9}, {3.8957303334834337`*^9, 
   3.895730334583846*^9}, 3.895730555648501*^9, {3.8957403869975033`*^9, 
   3.895740409874614*^9}, {3.8957405918184423`*^9, 3.895740593502267*^9}, {
   3.895742139599085*^9, 3.895742146600655*^9}, {3.895742192917769*^9, 
   3.8957422873612137`*^9}, {3.895744932974286*^9, 3.895744935474081*^9}, 
   3.895745537206855*^9},ExpressionUUID->"2d56be05-4f29-4333-8b30-\
1dd98d8288f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",ExpressionUUID->"891b5f7a-30c7-4cf3-8da9-bd641cdb7e6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SolveEcoEq", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "Automatic"}], ",", "\n", 
     RowBox[{"SolveOpts", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "}"}], "\n", "PerCapita"}], "\[Rule]", "False"}]}], ",", 
     
     RowBox[{"Fixed", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Chop", "\[Rule]", "True"}], ",", 
     RowBox[{"QSS", "\[Rule]", "False"}], ",", 
     RowBox[{"Time", "\[Rule]", "t"}], ",", 
     RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
     RowBox[{"Verbosity", "->", "0"}], ",", 
     RowBox[{"IgnoreVar", "->", "False"}]}], "}"}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.68788145061252*^9, {3.6885716849598207`*^9, 3.688571685061096*^9}, 
   3.6998307192614937`*^9, {3.699830756047996*^9, 3.699830757855876*^9}, {
   3.7146768525874043`*^9, 3.714676860849709*^9}, {3.714771544699765*^9, 
   3.714771544916628*^9}, 3.725140957991322*^9, {3.755266321588594*^9, 
   3.755266324656404*^9}, 3.7553697389508457`*^9, 3.755370573729661*^9, 
   3.75994589946877*^9, 3.7701200065679617`*^9, {3.770645589515258*^9, 
   3.770645593339229*^9}, {3.7982325865648317`*^9, 3.798232589900823*^9}, {
   3.817979839496348*^9, 3.817979840182137*^9}, {3.817986745774179*^9, 
   3.817986747250039*^9}, 3.817986827594922*^9, 3.8293159782581778`*^9, {
   3.859588972329741*^9, 3.859588974605693*^9}, {3.859590467440824*^9, 
   3.859590470000128*^9}, {3.8708128961119843`*^9, 3.870812906654851*^9}, 
   3.870813046791561*^9, {3.8719137515576057`*^9, 3.871913757389619*^9}, {
   3.895747746802123*^9, 
   3.89574775131499*^9}},ExpressionUUID->"1aaf3e11-1001-45f5-9932-\
8e40749524cd"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["NSolveEcoEq", "Subsection",
 CellChangeTimes->{{3.6954006453555927`*^9, 3.6954006557460127`*^9}, {
   3.6962556239228687`*^9, 3.696255625343861*^9}, 3.699565737020871*^9, {
   3.895745292484735*^9, 3.895745295175387*^9}},
 CellTags->{
  "1.7.0", "1.7.1"},ExpressionUUID->"e114b706-511f-4db9-b0ab-91b74f214f84"],

Cell[CellGroupData[{

Cell["Usage", "Subsubsection",
 CellChangeTimes->{{3.769494692292095*^9, 
  3.769494692848196*^9}},ExpressionUUID->"fbf17b3d-6457-42d5-82ab-\
af0c75dea668"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NSolveEcoEq", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<NSolveEcoEq[] numerically solves for ecological equilibria.\n\
NSolveEcoEq[\!\(\*StyleBox[\"vars\", \"TI\"]\)] numerically solves for \
variables \!\(\*StyleBox[\"vars\", \"TI\"]\).\n\
NSolveEcoEq[\!\(\*StyleBox[\"attributes\", \"TI\"]\)] uses \
traits/interactions \!\(\*StyleBox[\"attributes\", \"TI\"]\).\nNSolveEcoEq[\!\
\(\*StyleBox[\"attributes\", \"TI\"]\), \!\(\*StyleBox[\"vars\", \"TI\"]\)] \
numerically solves for variables \!\(\*StyleBox[\"vars\", \"TI\"]\) using \
trait values/interaction coefficients \!\(\*StyleBox[\"attributes\", \
\"TI\"]\).\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.76948331462147*^9, 3.769483315463594*^9}, {
  3.807375225831135*^9, 3.807375269109378*^9}, {3.807375299950779*^9, 
  3.807375331109776*^9}, {3.807375372814131*^9, 3.807375394598486*^9}, {
  3.8073754723757067`*^9, 3.807375491334848*^9}, {3.8073761836229362`*^9, 
  3.807376252238955*^9}, {3.807378136944607*^9, 3.807378170459052*^9}, {
  3.872019832401194*^9, 3.8720198383532343`*^9}, {3.895745307514551*^9, 
  3.895745309795554*^9}},ExpressionUUID->"2e74ce64-7c66-4e70-a4ef-\
67eaaac23cdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parser", "Subsubsection",
 CellChangeTimes->{{3.895575257543274*^9, 
  3.8955752603901043`*^9}},ExpressionUUID->"f37f2af6-eba9-4bb6-b6f4-\
629c73f9876d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NSolveEcoEq", "[", "in___", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"func", "=", "NSolveEcoEq"}], ",", "args", ",", "opts", ",", 
       "rest", ",", "parameters", ",", "attributes", ",", "Gs", ",", "\n", 
       "vars"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<in=\>\"", ",", "in"}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"args", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ExtractArgs", "[", 
         RowBox[{
          RowBox[{"{", "in", "}"}], ",", "func"}], "]"}], "]"}]}], ";", "\n", 
      
      RowBox[{"opts", "=", 
       RowBox[{"ExtractOpts", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", "func"}], "]"}]}], ";", "\n", 
      RowBox[{"vars", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "==", "Symbol"}], "&"}]}], 
           "]"}], "&"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vars", "==", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"vars", "=", "All"}], ",", 
        RowBox[{"vars", "=", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<args=\>\"", ",", "args"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<opts=\>\"", ",", "opts"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<vars=\>\"", ",", "vars"}], "]"}], ";"}], "*)"}], "\n", 
      "\n", 
      RowBox[{"parameters", "=", 
       RowBox[{"ExtractParameters", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"attributes", "=", 
       RowBox[{"ExtractAttributes", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"Gs", "=", 
       RowBox[{"ExtractVarCovs", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parameters=\>\"", ",", "parameters"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<attributes=\>\"", ",", "attributes"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"iNSolveEcoEq", "[", 
       RowBox[{
       "parameters", ",", "attributes", ",", "Gs", ",", "vars", ",", "opts"}],
        "]"}]}]}], "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.7127802306821003`*^9, 3.71278023163732*^9}, {
   3.769860889371685*^9, 3.769860898625585*^9}, {3.890088762767192*^9, 
   3.8900887857559834`*^9}, {3.890088825582732*^9, 3.8900888418951406`*^9}, {
   3.8900889470940847`*^9, 3.890088957136177*^9}, {3.8901267099939337`*^9, 
   3.890126710376408*^9}, {3.89012675925627*^9, 3.89012677188067*^9}, {
   3.890147666024979*^9, 3.890147669484149*^9}, {3.895556083668763*^9, 
   3.895556095879417*^9}, 3.8955566991026297`*^9, {3.8955577669801817`*^9, 
   3.8955577681779213`*^9}, {3.8955622577005453`*^9, 3.895562258529551*^9}, 
   3.89556232631433*^9, {3.89556263361314*^9, 3.8955626472449636`*^9}, {
   3.895562842722169*^9, 3.895562849597785*^9}, {3.895563092493565*^9, 
   3.895563126066338*^9}, {3.895563181729741*^9, 3.89556321475914*^9}, {
   3.895565622997553*^9, 3.895565825215711*^9}, {3.895566197384026*^9, 
   3.8955663023293247`*^9}, {3.8955663794538603`*^9, 3.895566420626652*^9}, {
   3.895567028632929*^9, 3.895567029623745*^9}, {3.895567212564479*^9, 
   3.895567218896427*^9}, {3.895567272624502*^9, 3.895567274409018*^9}, {
   3.8955675907546473`*^9, 3.895567768041896*^9}, {3.895567851076992*^9, 
   3.895567855084454*^9}, {3.895567885960531*^9, 3.8955679150019197`*^9}, {
   3.8955680083366737`*^9, 3.895568008699531*^9}, {3.895568048854352*^9, 
   3.895568157442192*^9}, {3.895568229874014*^9, 3.895568253702044*^9}, {
   3.8955693854122*^9, 3.8955694265490522`*^9}, 3.895575272473558*^9, {
   3.895575467928422*^9, 3.8955755135470257`*^9}, 3.895575682651147*^9, 
   3.895578721564733*^9, 3.895579374206821*^9, {3.89557941527911*^9, 
   3.8955794329631166`*^9}, {3.8955794748472223`*^9, 3.895579478562263*^9}, {
   3.895579560992878*^9, 3.895579561228808*^9}, {3.8955796500246983`*^9, 
   3.8955796662780857`*^9}, {3.895579769850182*^9, 3.895579777141037*^9}, {
   3.895579856895706*^9, 3.8955798595931683`*^9}, 3.895588510289165*^9, {
   3.8955886111527357`*^9, 3.895588612849946*^9}, {3.895589347468148*^9, 
   3.895589379222314*^9}, 3.895589610715495*^9, {3.895590444412505*^9, 
   3.895590453519902*^9}, 3.895590508127524*^9, 3.8955905439582157`*^9, {
   3.895592440937796*^9, 3.895592532735264*^9}, {3.895592590752514*^9, 
   3.895592650561548*^9}, {3.8955927319425507`*^9, 3.895592749052278*^9}, {
   3.8955928168610477`*^9, 3.895592818217918*^9}, {3.895592874955657*^9, 
   3.895592877402446*^9}, {3.8955932689174023`*^9, 3.895593272134426*^9}, {
   3.8955933455504208`*^9, 3.895593351409342*^9}, {3.895593492152051*^9, 
   3.895593498259594*^9}, {3.8955937696317577`*^9, 3.895593822470418*^9}, {
   3.895594059820359*^9, 3.895594072801594*^9}, {3.895594137936792*^9, 
   3.895594145714094*^9}, {3.895594303461802*^9, 3.895594305709622*^9}, 
   3.895594386310108*^9, {3.895594605950818*^9, 3.895594668846685*^9}, 
   3.8955947205307293`*^9, {3.8955949418141413`*^9, 3.895594948532854*^9}, {
   3.895594990704443*^9, 3.895594992920826*^9}, {3.895595557746958*^9, 
   3.895595583989648*^9}, 3.895595615253611*^9, {3.895595728916885*^9, 
   3.895595737345203*^9}, {3.895596389418861*^9, 3.89559639595473*^9}, {
   3.895723271852386*^9, 3.8957232826615477`*^9}, {3.8957234998949127`*^9, 
   3.895723500200151*^9}, {3.8957242143085203`*^9, 3.895724217157454*^9}, {
   3.895724248060494*^9, 3.8957243588861322`*^9}, {3.89572449468648*^9, 
   3.895724523840683*^9}, 3.8957253216621437`*^9, {3.895725378768009*^9, 
   3.895725408595636*^9}, {3.8957259620756197`*^9, 3.895725965867037*^9}, 
   3.895728224448289*^9, 3.895728385634983*^9, {3.8957300332924833`*^9, 
   3.895730144758787*^9}, {3.8957301798778553`*^9, 3.895730182357575*^9}, {
   3.895730289538713*^9, 3.895730391101716*^9}, {3.895730526156761*^9, 
   3.895730532051901*^9}, {3.89573058065491*^9, 3.8957306458853292`*^9}, 
   3.895730712347293*^9, {3.895730770671678*^9, 3.8957308047917347`*^9}, {
   3.895730894218618*^9, 3.895730896210866*^9}, 3.895730996639587*^9, {
   3.895731039820635*^9, 3.895731053193363*^9}, {3.895731088006267*^9, 
   3.8957311912927027`*^9}, 3.895731256114368*^9, {3.895731355063397*^9, 
   3.895731359533929*^9}, {3.895731606212158*^9, 3.89573165236588*^9}, 
   3.895732191332889*^9, {3.895732243309506*^9, 3.895732244028244*^9}, {
   3.895733005810913*^9, 3.8957330070744953`*^9}, {3.895733079504335*^9, 
   3.8957330993229094`*^9}, {3.895733177048377*^9, 3.8957331856636963`*^9}, {
   3.895733261265317*^9, 3.8957333102784653`*^9}, {3.895733341083591*^9, 
   3.8957333617799177`*^9}, {3.895739915028021*^9, 3.8957399168763523`*^9}, {
   3.895739956286934*^9, 3.895739960845393*^9}, {3.895740036353834*^9, 
   3.8957400475824833`*^9}, 3.895740267670516*^9, {3.895740363081471*^9, 
   3.895740370369906*^9}, {3.895740401135902*^9, 3.89574040209801*^9}, {
   3.8957405628990307`*^9, 3.8957405644202223`*^9}, {3.895740604411921*^9, 
   3.895740610039589*^9}, {3.895740755442668*^9, 3.8957407775015907`*^9}, {
   3.895740883555833*^9, 3.895740889820269*^9}, {3.895741220046998*^9, 
   3.895741223130054*^9}, {3.895741466079542*^9, 3.895741521576285*^9}, {
   3.8957415922179947`*^9, 3.895741593243791*^9}, {3.895745312180373*^9, 
   3.895745362251544*^9}, {3.8957455858586063`*^9, 3.895745585985281*^9}, {
   3.895746955058201*^9, 
   3.895746957930209*^9}},ExpressionUUID->"055269d3-de2d-4f05-90dd-\
b3f02eabd837"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition", "Subsubsection",
 CellChangeTimes->{{3.7694936745853653`*^9, 
  3.769493676072991*^9}},ExpressionUUID->"2fcc0a69-7a7d-4ff8-92ff-\
5bc542617877"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iNSolveEcoEq", "[", 
    RowBox[{"pars_", ",", "attributesin_", ",", "Gsin_", ",", "vars_", ",", 
     RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{"(*", " ", "options", " ", "*)"}], "\n", 
      RowBox[{
      "nsolveopts", ",", "\n", "boundarydetection", ",", "time", ",", "fixed",
        ",", "chop", ",", "qss", ",", "percapita", ",", "verbose", ",", 
       "ignorevar", ",", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"other", " ", "variables"}], " ", "*)"}], "\n", "attributes", 
       ",", "nonvars", ",", "nonfixedvars", ",", "fixedvars", ",", "Gs", ",", 
       "removets", ",", "eqns", ",", "unks", ",", "newunk", ",", "sol", ",", 
       "res"}], "}"}], ",", "\n", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[ScriptCapitalN]", ",", "verbosity", ",", 
         RowBox[{"func", "=", "\"\<NSolveEcoEq\>\""}]}], "}"}], ",", "\n", 
       "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "verbosity"}], " ", "*)"}], "\n", "\n", 
       RowBox[{
        RowBox[{"verbose", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Verbose", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Verbosity", "/.", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"opts", ",", 
                  RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
              "]"}]}], "]"}]}], ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Verbosity", "/.", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"opts", ",", 
                RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "Global`$verbosity", "]"}], ",", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"Global`$verbosity", ",", "verbosity"}], "]"}]}]}], "]"}],
         ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"handle", " ", "options"}], " ", "*)"}], "\n", "\n", 
        RowBox[{"nsolveopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"NSolveOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"boundarydetection", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"BoundaryDetection", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"time", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Time", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"chop", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Chop", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"qss", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"QSS", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"fixed", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Fixed", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"percapita", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"PerCapita", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"ignorevar", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"IgnoreVar", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"fix", " ", "attributes"}], " ", "*)"}], "\n", 
        RowBox[{"attributes", "=", 
         RowBox[{"FixAttributes", "[", "attributesin", "]"}]}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "figure", " ", "out", " ", "number", " ", "of", " ", "species", " ", 
          "in", " ", "guilds"}], " ", "*)"}], "\n", 
        RowBox[{"Set\[ScriptCapitalN]", "[", "attributes", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<\[ScriptCapitalN]=\>\"", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"expand", " ", "Gs"}], " ", "*)"}], "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gsin=\>\"", ",", "Gsin"}], "]"}], ";", "\n", 
        RowBox[{"Gs", "=", 
         RowBox[{"ExpandGs", "[", 
          RowBox[{"Gsin", ",", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[FormalCapitalN]", "[", "gu", "]"}], "\[Rule]", 
               RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}], ";"}]}], "\n", 
          "]"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vars", "===", "All"}], ",", "\n", "\t", 
          RowBox[{"nonvars", "=", 
           RowBox[{"{", "}"}]}], ",", "\n", "\t", 
          RowBox[{"nonvars", "=", 
           RowBox[{"OrderedComplement", "[", 
            RowBox[{"AllVariables", ",", "vars"}], "]"}]}]}], "\n", "]"}], 
        ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonvars=\>\"", ",", "nonvars"}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"qss", "\[Equal]", "False"}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "0"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "x"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<fixed=\>\"", ",", "fixed"}], "]"}], ";", "\n",
         "\n", 
        RowBox[{"fixedvars", "=", 
         RowBox[{"fixed", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        RowBox[{"nonfixedvars", "=", 
         RowBox[{"OrderedComplement", "[", 
          RowBox[{"AllVariables", ",", "fixedvars"}], "]"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonfixedvars=\>\"", ",", "nonfixedvars"}], 
         "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"set", " ", "eqns"}], " ", "*)"}], "\n", 
        RowBox[{"eqns", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"EcoEqns", "[", 
               RowBox[{"attributes", ",", 
                RowBox[{"Fixed", "\[Rule]", "fixed"}], ",", 
                RowBox[{"PerCapita", "\[Rule]", "percapita"}], ",", 
                RowBox[{"IgnoreVar", "->", "ignorevar"}]}], "]"}], "/.", 
              "Eq"}], "/.", 
             RowBox[{"t", "\[Rule]", "time"}]}], "/.", "fixed"}], "/.", 
           "attributes"}], "/.", "Gs"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<eqns=\>\"", ",", "eqns"}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"solve", " ", "it"}], " ", "*)"}], "\n", 
        RowBox[{"unks", "=", "nonfixedvars"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"eqns", "=", "eqns"}], ",", 
              RowBox[{"unks", "=", "unks"}], ",", 
              RowBox[{"options", "=", 
               RowBox[{"Sequence", "@@", "nsolveopts"}]}]}], "}"}], ",", 
            RowBox[{"PrintCall", "[", 
             RowBox[{"Global`sol", "=", 
              RowBox[{"NSolve", "[", 
               RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
             "]"}]}], "]"}]}], "]"}], ";", "\n", 
        RowBox[{"sol", "=", 
         RowBox[{"NSolve", "[", 
          RowBox[{"eqns", ",", "unks", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", "nsolveopts"}], "]"}]}], "]"}]}], ";", 
        "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "sol", "]"}], "===", "NSolve"}], ",", 
          RowBox[{"sol", "=", 
           RowBox[{"NSolve", "[", 
            RowBox[{"eqns", ",", "unks", ",", "Reals", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Sequence", "@@", "nsolveopts"}], "]"}]}], "]"}]}]}], 
         "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<sol=\>\"", ",", "sol"}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "sol", "]"}], "===", "NSolve"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"EcoEq", "::", "nosol"}], ",", 
             RowBox[{"Head", "[", "sol", "]"}]}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"add", " ", "in", " ", "Fixed", " ", "variables"}], " ", 
         "*)"}], "\n", 
        RowBox[{"res", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"fixed", ",", 
               RowBox[{"var_", "\[Rule]", "var_"}]}], "]"}], ",", "#"}], 
            "]"}], "&"}], " ", "/@", " ", "sol"}]}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"chop", ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", 
              RowBox[{"Chop", "[", "res", "]"}], "]"}], ",", "AllVariables"}],
             "]"}], "]"}], ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", "res", "]"}], ",", "AllVariables"}], 
            "]"}], "]"}]}], "\n", "]"}], ";"}]}], "\n", "\n", "]"}]}], 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.687881450105945*^9, 3.6878814505620613`*^9}, {
   3.68857168476537*^9, 3.688571684934305*^9}, {3.6885717562075033`*^9, 
   3.688571756902958*^9}, {3.688571805445076*^9, 3.6885718054840527`*^9}, {
   3.6885777801299953`*^9, 3.688577821198338*^9}, {3.688578111707645*^9, 
   3.688578263696265*^9}, {3.688583189141659*^9, 3.688583201104134*^9}, {
   3.6885837935779333`*^9, 3.688583810589251*^9}, {3.688583857663521*^9, 
   3.688583866440373*^9}, 3.688584023610524*^9, {3.688584454327429*^9, 
   3.688584464134824*^9}, {3.6885851260336657`*^9, 3.6885852077551622`*^9}, 
   3.688685223038662*^9, {3.693593326673889*^9, 3.693593328006213*^9}, {
   3.693651209563744*^9, 3.693651212696253*^9}, {3.693651330751341*^9, 
   3.693651337237907*^9}, {3.693700342037077*^9, 3.6937003445534773`*^9}, {
   3.69961046687166*^9, 3.699610497623667*^9}, 3.709124896659213*^9, {
   3.709336699110145*^9, 3.709336699577385*^9}, {3.7101059510781393`*^9, 
   3.710105954644555*^9}, {3.710254347130986*^9, 3.710254357145165*^9}, {
   3.710254389172209*^9, 3.7102544454183407`*^9}, {3.710286418340989*^9, 
   3.710286419629771*^9}, 3.710286914350444*^9, 3.7127385346721067`*^9, {
   3.714088449593779*^9, 3.714088465042605*^9}, {3.714088783139654*^9, 
   3.714088791448407*^9}, {3.714088844203219*^9, 3.71408885600861*^9}, 
   3.714089170503827*^9, {3.7140892855105886`*^9, 3.7140893056027193`*^9}, {
   3.7146455898601007`*^9, 3.714645607554661*^9}, {3.714645833218658*^9, 
   3.714645878205338*^9}, {3.7146594716484127`*^9, 3.714659498519136*^9}, {
   3.714659560420806*^9, 3.714659597546504*^9}, {3.714661306250412*^9, 
   3.7146613128544407`*^9}, {3.7146613520466423`*^9, 3.714661374692927*^9}, {
   3.714661426985828*^9, 3.714661471021627*^9}, {3.714670952581798*^9, 
   3.7146709761045732`*^9}, {3.714673053941062*^9, 3.71467307388553*^9}, {
   3.714673325535184*^9, 3.7146733431977777`*^9}, {3.714673385822101*^9, 
   3.714673408156714*^9}, {3.7146763296033154`*^9, 3.714676349908175*^9}, {
   3.714676870217898*^9, 3.7146768813446712`*^9}, {3.714677005871266*^9, 
   3.7146770388481817`*^9}, {3.714677885477186*^9, 3.714677895396152*^9}, {
   3.7146815798359137`*^9, 3.71468158317702*^9}, {3.714686709068077*^9, 
   3.714686720449131*^9}, {3.714686780357995*^9, 3.714686847805605*^9}, {
   3.714686886251251*^9, 3.7146869069408197`*^9}, {3.7146904343318*^9, 
   3.714690435561199*^9}, {3.7146905887398357`*^9, 3.714690601923481*^9}, {
   3.714690631972337*^9, 3.714690933211876*^9}, {3.714691441205781*^9, 
   3.7146914443765163`*^9}, 3.714771558293874*^9, {3.71477345759927*^9, 
   3.714773544216226*^9}, {3.714773631881823*^9, 3.714773638759398*^9}, {
   3.7147737076976557`*^9, 3.714773768872843*^9}, {3.714773810344654*^9, 
   3.714773862655966*^9}, {3.714774175646474*^9, 3.714774238321686*^9}, {
   3.714774276778345*^9, 3.714774313756324*^9}, {3.714774363666697*^9, 
   3.714774431577939*^9}, {3.71477474128935*^9, 3.714774765274622*^9}, {
   3.714774824264062*^9, 3.7147748384112673`*^9}, {3.7147748942865953`*^9, 
   3.7147749226594543`*^9}, {3.7147749728240833`*^9, 
   3.7147749743011627`*^9}, {3.714777387544536*^9, 3.714777422944803*^9}, {
   3.715423204967746*^9, 3.715423247100832*^9}, {3.716851794553669*^9, 
   3.716851838573512*^9}, {3.716851923962669*^9, 3.71685195096766*^9}, {
   3.716852009532653*^9, 3.716852055393906*^9}, {3.716852216771632*^9, 
   3.71685231192962*^9}, {3.7168523670615377`*^9, 3.71685238929698*^9}, {
   3.7168524239048243`*^9, 3.716852506519627*^9}, {3.7168526119630947`*^9, 
   3.716852660342918*^9}, {3.720561423750366*^9, 3.720561426334433*^9}, {
   3.720561478834214*^9, 3.720561481166069*^9}, {3.721849189319437*^9, 
   3.72184920349916*^9}, {3.721849430040469*^9, 3.7218494327297087`*^9}, 
   3.7218496199026947`*^9, {3.722043437583398*^9, 3.722043661426222*^9}, {
   3.722083757551734*^9, 3.72208381655929*^9}, {3.725055711251069*^9, 
   3.725055715332081*^9}, 3.7251409579843616`*^9, 3.725141965221623*^9, {
   3.728485760884264*^9, 3.728485790162279*^9}, {3.728492488068541*^9, 
   3.728492510850383*^9}, {3.728493399302709*^9, 3.728493401619061*^9}, {
   3.7284934402687283`*^9, 3.728493443062832*^9}, {3.728495197386813*^9, 
   3.7284952624184313`*^9}, {3.728495727453259*^9, 3.7284957368624372`*^9}, {
   3.728495928466558*^9, 3.72849592873841*^9}, {3.731976096240344*^9, 
   3.7319762267049303`*^9}, {3.731976277432869*^9, 3.7319762780290833`*^9}, {
   3.7319768020188913`*^9, 3.731976803777299*^9}, {3.731976892921598*^9, 
   3.731976916165578*^9}, {3.731976959563902*^9, 3.731976962085402*^9}, {
   3.731977155942281*^9, 3.73197716443357*^9}, {3.731977195279862*^9, 
   3.7319772065728207`*^9}, {3.731977279507853*^9, 3.731977284166617*^9}, {
   3.731977461555399*^9, 3.731977465980788*^9}, {3.731978006012163*^9, 
   3.731978013040636*^9}, {3.731978082421216*^9, 3.731978094010425*^9}, {
   3.731979039353709*^9, 3.731979039363929*^9}, {3.731979598523592*^9, 
   3.73197961490341*^9}, {3.73197972820308*^9, 3.7319797289924088`*^9}, {
   3.731980249144205*^9, 3.73198026694471*^9}, 3.731980373788886*^9, {
   3.7319804050810537`*^9, 3.731980445644969*^9}, {3.731980548309566*^9, 
   3.731980566185113*^9}, {3.731980610588462*^9, 3.7319806369962673`*^9}, {
   3.731980738391506*^9, 3.731980763895586*^9}, {3.731980818773868*^9, 
   3.731980857708199*^9}, {3.731980943731715*^9, 3.731981000719969*^9}, 
   3.731981067123608*^9, {3.732221099817436*^9, 3.7322211073866863`*^9}, {
   3.732237132742322*^9, 3.73223714782172*^9}, {3.732237266376129*^9, 
   3.732237271289744*^9}, {3.732273382440886*^9, 3.73227340932165*^9}, {
   3.732273491519849*^9, 3.732273491669429*^9}, {3.732394286439495*^9, 
   3.732394371996009*^9}, 3.755182267229639*^9, 3.755184973022751*^9, {
   3.75582209648076*^9, 3.7558220982190313`*^9}, {3.7558225635660257`*^9, 
   3.7558225772644787`*^9}, {3.7585221898099403`*^9, 3.7585221899906693`*^9}, 
   3.759140406004279*^9, {3.75914072046175*^9, 3.759140778591229*^9}, {
   3.759141110454555*^9, 3.7591411170112877`*^9}, 3.759142070148613*^9, {
   3.759926864600369*^9, 3.759926908779594*^9}, {3.7599440817309227`*^9, 
   3.759944089031756*^9}, {3.7599442652749147`*^9, 3.7599442925085506`*^9}, {
   3.759944468213972*^9, 3.759944470421031*^9}, {3.759944509678103*^9, 
   3.759944625568841*^9}, {3.759944680926206*^9, 3.759944704050845*^9}, {
   3.759944777100625*^9, 3.759944777332377*^9}, {3.7599452123441133`*^9, 
   3.759945212472487*^9}, 3.761151167307536*^9, 3.7613779187363462`*^9, {
   3.769182368428945*^9, 3.7691823684332743`*^9}, {3.769182447225265*^9, 
   3.769182447229724*^9}, 3.7697607053790417`*^9, 3.770438265000821*^9, {
   3.770721434046843*^9, 3.770721434486648*^9}, {3.7746909735763407`*^9, 
   3.774690974277783*^9}, 3.786090308105297*^9, 3.7860903405306396`*^9, {
   3.7861697725876913`*^9, 3.7861697838397303`*^9}, {3.7861698579109*^9, 
   3.7861698645494623`*^9}, {3.786257005170101*^9, 3.786257029661643*^9}, {
   3.786259628183383*^9, 3.78625966453019*^9}, {3.7862596972230663`*^9, 
   3.7862597130857067`*^9}, {3.786260599076335*^9, 3.7862606519012136`*^9}, {
   3.786260711471278*^9, 3.7862607825400476`*^9}, {3.786262427305735*^9, 
   3.7862624297094097`*^9}, {3.786262672446123*^9, 3.7862626757022247`*^9}, {
   3.7941372405540857`*^9, 3.794137240568924*^9}, 3.798128132723709*^9, {
   3.798232559307932*^9, 3.798232607817318*^9}, 3.8002032936287107`*^9, {
   3.800228806267811*^9, 3.8002288701566067`*^9}, {3.800229240434243*^9, 
   3.8002292588092833`*^9}, {3.800230257115494*^9, 3.800230271819356*^9}, {
   3.800230689976359*^9, 3.800230696507571*^9}, {3.800230861506472*^9, 
   3.8002308853617268`*^9}, {3.800231148936945*^9, 3.8002311628361807`*^9}, {
   3.800269707014142*^9, 3.80026972050751*^9}, {3.8004654280139236`*^9, 
   3.8004654993620977`*^9}, {3.807369332962606*^9, 3.807369333743342*^9}, {
   3.807369626808475*^9, 3.807369633505528*^9}, {3.807376451767674*^9, 
   3.807376461724361*^9}, {3.8154778674250393`*^9, 3.8154778786474133`*^9}, {
   3.8154783955502*^9, 3.8154784000536633`*^9}, {3.815479106257626*^9, 
   3.815479107656157*^9}, {3.829315987079705*^9, 3.829316001463244*^9}, 
   3.833033078563163*^9, {3.833033108685328*^9, 3.833033148581917*^9}, 
   3.833038502668605*^9, 3.835030194667267*^9, {3.859148473878541*^9, 
   3.859148484706414*^9}, 3.8591503881615667`*^9, 3.8594808660648727`*^9, 
   3.8594809215028048`*^9, {3.859481010380721*^9, 3.859481014177998*^9}, {
   3.85948118066334*^9, 3.859481183379318*^9}, {3.859481298816181*^9, 
   3.859481315770236*^9}, {3.859481351730167*^9, 3.859481376563326*^9}, {
   3.8595884244545803`*^9, 3.859588479932879*^9}, {3.859588743998242*^9, 
   3.859588765495607*^9}, {3.859588806482554*^9, 3.859588926483329*^9}, {
   3.859589076697467*^9, 3.8595890862667627`*^9}, {3.859589141801827*^9, 
   3.859589247695283*^9}, {3.859589278802657*^9, 3.8595893184973927`*^9}, {
   3.859589355053155*^9, 3.859589394885363*^9}, {3.8595894565019217`*^9, 
   3.859589464785759*^9}, {3.859589499943409*^9, 3.8595895551048613`*^9}, {
   3.859589593067071*^9, 3.8595896843311996`*^9}, 3.859589915082026*^9, {
   3.859589979348977*^9, 3.8595899793771067`*^9}, {3.859590726243621*^9, 
   3.859590757603325*^9}, 3.859640095466408*^9, {3.859648360374277*^9, 
   3.859648389450727*^9}, {3.859649217444069*^9, 3.85964922877459*^9}, {
   3.859657651647107*^9, 3.859657715461317*^9}, {3.8597223431582127`*^9, 
   3.859722349203199*^9}, {3.870793309356901*^9, 3.870793309988036*^9}, 
   3.870810224016097*^9, {3.871909025974709*^9, 3.871909029201529*^9}, 
   3.8719101640474253`*^9, 3.8719116216008463`*^9, {3.8719117586639767`*^9, 
   3.8719117851224957`*^9}, {3.871911824020739*^9, 3.871911898782824*^9}, {
   3.8719119821779833`*^9, 3.871912009909605*^9}, {3.8719124337875853`*^9, 
   3.871912435171369*^9}, {3.8719131498057203`*^9, 3.871913180106717*^9}, {
   3.871913220456274*^9, 3.871913227902382*^9}, {3.8719134735780153`*^9, 
   3.871913509640698*^9}, {3.8719136888826103`*^9, 3.8719137381955547`*^9}, {
   3.871914277230426*^9, 3.871914282229678*^9}, {3.871917802088578*^9, 
   3.871917805074687*^9}, {3.8786729753409986`*^9, 3.878672995239841*^9}, {
   3.895730252940528*^9, 3.895730278366877*^9}, {3.8957303334834337`*^9, 
   3.895730334583846*^9}, 3.895730555648501*^9, {3.8957403869975033`*^9, 
   3.895740409874614*^9}, {3.8957405918184423`*^9, 3.895740593502267*^9}, {
   3.895745366265431*^9, 3.89574537072058*^9}, {3.89574542484844*^9, 
   3.895745554278697*^9}},ExpressionUUID->"a81e8d9d-6dd9-46ad-b70a-\
0282dfebb957"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",ExpressionUUID->"e72664da-56ef-4a7d-8254-33f2d2f3dbd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "NSolveEcoEq", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "Automatic"}], ",", "\n", 
     RowBox[{"NSolveOpts", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Method", "\[Rule]", "\"\<EndomorphismMatrix\>\""}], "}"}]}], 
     ",", "\n", 
     RowBox[{"PerCapita", "\[Rule]", "False"}], ",", 
     RowBox[{"Fixed", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Chop", "\[Rule]", "True"}], ",", 
     RowBox[{"QSS", "\[Rule]", "False"}], ",", 
     RowBox[{"Time", "\[Rule]", "t"}], ",", 
     RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
     RowBox[{"Verbosity", "->", "0"}], ",", 
     RowBox[{"IgnoreVar", "->", "False"}]}], "}"}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.68788145061252*^9, {3.6885716849598207`*^9, 3.688571685061096*^9}, 
   3.6998307192614937`*^9, {3.699830756047996*^9, 3.699830757855876*^9}, {
   3.7146768525874043`*^9, 3.714676860849709*^9}, {3.714771544699765*^9, 
   3.714771544916628*^9}, 3.725140957991322*^9, {3.755266321588594*^9, 
   3.755266324656404*^9}, 3.7553697389508457`*^9, 3.755370573729661*^9, 
   3.75994589946877*^9, 3.7701200065679617`*^9, {3.770645589515258*^9, 
   3.770645593339229*^9}, {3.7982325865648317`*^9, 3.798232589900823*^9}, {
   3.817979839496348*^9, 3.817979840182137*^9}, {3.817986745774179*^9, 
   3.817986747250039*^9}, 3.817986827594922*^9, 3.8293159782581778`*^9, {
   3.859588972329741*^9, 3.859588974605693*^9}, {3.859590467440824*^9, 
   3.859590470000128*^9}, {3.8708128961119843`*^9, 3.870812906654851*^9}, 
   3.870813046791561*^9, {3.8719137515576057`*^9, 3.871913757389619*^9}, {
   3.895747758856038*^9, 
   3.895747768043292*^9}},ExpressionUUID->"a29242de-80b3-4242-8bdc-\
a67b902b430f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Messages", "Subsubsection",
 CellChangeTimes->{{3.7695018515541153`*^9, 
  3.769501852845079*^9}},ExpressionUUID->"79d5772e-00aa-49c2-93f9-\
697cac95c54f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "::", "noneq"}], "=", "\n", 
   "\"\<Can't find equilibrium of periodically forced model with FindRoot.  \
Give Time option or try FindEcoCycle instead.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "::", "nosol"}], "=", 
   "\"\<`1` couldn't find a solution.  Try FindEcoEq instead.\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "::", "badmtd"}], "=", 
   "\"\<Method is not known (\\\"Solve\\\",\\\"NSolve\\\",\\\"FindRoot\\\",\\\
\"FindRoots\\\").\>\""}], ";"}]}], "Code",
 CellChangeTimes->{{3.769501857001574*^9, 3.769501857579821*^9}, {
  3.8596474251654797`*^9, 3.859647429307817*^9}, {3.8719132863927526`*^9, 
  3.871913346568707*^9}},ExpressionUUID->"f9fb8ee5-03da-40ce-a49c-\
a32fe40cf5db"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["FindEcoEq", "Subsection",
 CellChangeTimes->{{3.6954006453555927`*^9, 3.6954006557460127`*^9}, {
   3.6962556239228687`*^9, 3.696255625343861*^9}, 3.699565737020871*^9, 
   3.895745649128731*^9},
 CellTags->{
  "1.7.0", "1.7.1"},ExpressionUUID->"e718424c-4b66-41a2-90b8-ebff33b6aa8f"],

Cell[CellGroupData[{

Cell["Usage", "Subsubsection",
 CellChangeTimes->{{3.769494692292095*^9, 
  3.769494692848196*^9}},ExpressionUUID->"19c95129-4ee8-4545-aa42-\
aeb232dd6b00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindEcoEq", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<FindEcoEq[\!\(\*StyleBox[\"init\", \"TI\"]\)] finds an ecological \
equilibrium using initial guess / range \!\(\*StyleBox[\"init\", \"TI\"]\).\n\
FindEcoEq[\!\(\*StyleBox[\"attributes\", \"TI\"]\), \!\(\*StyleBox[\"init\", \
\"TI\"]\)] uses trait values/interaction coefficients \
\!\(\*StyleBox[\"attributes\", \"TI\"]\) and initial guess / range \
\!\(\*StyleBox[\"init\", \"TI\"]\).\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.76948331462147*^9, 3.769483315463594*^9}, {
   3.807375225831135*^9, 3.807375269109378*^9}, {3.807375299950779*^9, 
   3.807375331109776*^9}, {3.807375372814131*^9, 3.807375394598486*^9}, {
   3.8073754723757067`*^9, 3.807375491334848*^9}, {3.8073761836229362`*^9, 
   3.807376252238955*^9}, {3.807378136944607*^9, 3.807378170459052*^9}, {
   3.872019832401194*^9, 3.8720198383532343`*^9}, 
   3.8957456523698072`*^9},ExpressionUUID->"448d68ee-f66b-4ac6-a178-\
0035cd1538fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parser", "Subsubsection",
 CellChangeTimes->{{3.895575257543274*^9, 
  3.8955752603901043`*^9}},ExpressionUUID->"e86650a0-532b-4d90-bc4a-\
b802de50035a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindEcoEq", "[", "in___", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"func", "=", "FindEcoEq"}], ",", "args", ",", "opts", ",", 
       "rest", ",", "parameters", ",", "attributes", ",", "Gs", ",", 
       "variables", ",", "variableslist", ",", "ranges", ",", "\n", "vars"}], 
      "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<in=\>\"", ",", "in"}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"args", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ExtractArgs", "[", 
         RowBox[{
          RowBox[{"{", "in", "}"}], ",", "func"}], "]"}], "]"}]}], ";", "\n", 
      
      RowBox[{"opts", "=", 
       RowBox[{"ExtractOpts", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", "func"}], "]"}]}], ";", "\n", 
      RowBox[{"vars", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "==", "Symbol"}], "&"}]}], 
           "]"}], "&"}]}], "]"}]}], ";", "\n", 
      RowBox[{"ranges", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", 
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vars", "==", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"vars", "=", "All"}], ",", 
        RowBox[{"vars", "=", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<args=\>\"", ",", "args"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<opts=\>\"", ",", "opts"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<vars=\>\"", ",", "vars"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ranges=\>\"", ",", "ranges"}], "]"}], ";"}], "*)"}], 
      "\n", "\n", 
      RowBox[{"parameters", "=", 
       RowBox[{"ExtractParameters", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"attributes", "=", 
       RowBox[{"ExtractAttributes", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"Gs", "=", 
       RowBox[{"ExtractVarCovs", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"variables", "=", 
       RowBox[{"ExtractVariables", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"variableslist", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"args", ",", "RuleListQ"}], "]"}], ",", "VariablesQ"}], 
        "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parameters=\>\"", ",", "parameters"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<attributes=\>\"", ",", "attributes"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<variables=\>\"", ",", "variables"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<variableslist=\>\"", ",", "variableslist"}], "]"}], 
        ";"}], "*)"}], "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"variableslist", "==", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t", 
        RowBox[{"iFindEcoEq", "[", 
         RowBox[{
         "parameters", ",", "attributes", ",", "Gs", ",", "variables", ",", 
          "vars", ",", 
          RowBox[{"Method", "->", "\"\<FindRoot\>\""}], ",", "opts"}], "]"}], 
        ",", "\n", "\t", 
        RowBox[{
         RowBox[{
          RowBox[{"iFindEcoEq", "[", 
           RowBox[{
           "parameters", ",", "attributes", ",", "Gs", ",", "#", ",", "vars", 
            ",", 
            RowBox[{"Method", "->", "\"\<FindRoot\>\""}], ",", "opts"}], 
           "]"}], "&"}], "/@", "variableslist"}]}], "\n", "]"}]}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.7127802306821003`*^9, 3.71278023163732*^9}, {
   3.769860889371685*^9, 3.769860898625585*^9}, {3.890088762767192*^9, 
   3.8900887857559834`*^9}, {3.890088825582732*^9, 3.8900888418951406`*^9}, {
   3.8900889470940847`*^9, 3.890088957136177*^9}, {3.8901267099939337`*^9, 
   3.890126710376408*^9}, {3.89012675925627*^9, 3.89012677188067*^9}, {
   3.890147666024979*^9, 3.890147669484149*^9}, {3.895556083668763*^9, 
   3.895556095879417*^9}, 3.8955566991026297`*^9, {3.8955577669801817`*^9, 
   3.8955577681779213`*^9}, {3.8955622577005453`*^9, 3.895562258529551*^9}, 
   3.89556232631433*^9, {3.89556263361314*^9, 3.8955626472449636`*^9}, {
   3.895562842722169*^9, 3.895562849597785*^9}, {3.895563092493565*^9, 
   3.895563126066338*^9}, {3.895563181729741*^9, 3.89556321475914*^9}, {
   3.895565622997553*^9, 3.895565825215711*^9}, {3.895566197384026*^9, 
   3.8955663023293247`*^9}, {3.8955663794538603`*^9, 3.895566420626652*^9}, {
   3.895567028632929*^9, 3.895567029623745*^9}, {3.895567212564479*^9, 
   3.895567218896427*^9}, {3.895567272624502*^9, 3.895567274409018*^9}, {
   3.8955675907546473`*^9, 3.895567768041896*^9}, {3.895567851076992*^9, 
   3.895567855084454*^9}, {3.895567885960531*^9, 3.8955679150019197`*^9}, {
   3.8955680083366737`*^9, 3.895568008699531*^9}, {3.895568048854352*^9, 
   3.895568157442192*^9}, {3.895568229874014*^9, 3.895568253702044*^9}, {
   3.8955693854122*^9, 3.8955694265490522`*^9}, 3.895575272473558*^9, {
   3.895575467928422*^9, 3.8955755135470257`*^9}, 3.895575682651147*^9, 
   3.895578721564733*^9, 3.895579374206821*^9, {3.89557941527911*^9, 
   3.8955794329631166`*^9}, {3.8955794748472223`*^9, 3.895579478562263*^9}, {
   3.895579560992878*^9, 3.895579561228808*^9}, {3.8955796500246983`*^9, 
   3.8955796662780857`*^9}, {3.895579769850182*^9, 3.895579777141037*^9}, {
   3.895579856895706*^9, 3.8955798595931683`*^9}, 3.895588510289165*^9, {
   3.8955886111527357`*^9, 3.895588612849946*^9}, {3.895589347468148*^9, 
   3.895589379222314*^9}, 3.895589610715495*^9, {3.895590444412505*^9, 
   3.895590453519902*^9}, 3.895590508127524*^9, 3.8955905439582157`*^9, {
   3.895592440937796*^9, 3.895592532735264*^9}, {3.895592590752514*^9, 
   3.895592650561548*^9}, {3.8955927319425507`*^9, 3.895592749052278*^9}, {
   3.8955928168610477`*^9, 3.895592818217918*^9}, {3.895592874955657*^9, 
   3.895592877402446*^9}, {3.8955932689174023`*^9, 3.895593272134426*^9}, {
   3.8955933455504208`*^9, 3.895593351409342*^9}, {3.895593492152051*^9, 
   3.895593498259594*^9}, {3.8955937696317577`*^9, 3.895593822470418*^9}, {
   3.895594059820359*^9, 3.895594072801594*^9}, {3.895594137936792*^9, 
   3.895594145714094*^9}, {3.895594303461802*^9, 3.895594305709622*^9}, 
   3.895594386310108*^9, {3.895594605950818*^9, 3.895594668846685*^9}, 
   3.8955947205307293`*^9, {3.8955949418141413`*^9, 3.895594948532854*^9}, {
   3.895594990704443*^9, 3.895594992920826*^9}, {3.895595557746958*^9, 
   3.895595583989648*^9}, 3.895595615253611*^9, {3.895595728916885*^9, 
   3.895595737345203*^9}, {3.895596389418861*^9, 3.89559639595473*^9}, {
   3.895723271852386*^9, 3.8957232826615477`*^9}, {3.8957234998949127`*^9, 
   3.895723500200151*^9}, {3.8957242143085203`*^9, 3.895724217157454*^9}, {
   3.895724248060494*^9, 3.8957243588861322`*^9}, {3.89572449468648*^9, 
   3.895724523840683*^9}, 3.8957253216621437`*^9, {3.895725378768009*^9, 
   3.895725408595636*^9}, {3.8957259620756197`*^9, 3.895725965867037*^9}, 
   3.895728224448289*^9, 3.895728385634983*^9, {3.8957300332924833`*^9, 
   3.895730144758787*^9}, {3.8957301798778553`*^9, 3.895730182357575*^9}, {
   3.895730289538713*^9, 3.895730391101716*^9}, {3.895730526156761*^9, 
   3.895730532051901*^9}, {3.89573058065491*^9, 3.8957306458853292`*^9}, 
   3.895730712347293*^9, {3.895730770671678*^9, 3.8957308047917347`*^9}, {
   3.895730894218618*^9, 3.895730896210866*^9}, 3.895730996639587*^9, {
   3.895731039820635*^9, 3.895731053193363*^9}, {3.895731088006267*^9, 
   3.8957311912927027`*^9}, 3.895731256114368*^9, {3.895731355063397*^9, 
   3.895731359533929*^9}, {3.895731606212158*^9, 3.89573165236588*^9}, 
   3.895732191332889*^9, {3.895732243309506*^9, 3.895732244028244*^9}, {
   3.895733005810913*^9, 3.8957330070744953`*^9}, {3.895733079504335*^9, 
   3.8957330993229094`*^9}, {3.895733177048377*^9, 3.8957331856636963`*^9}, {
   3.895733261265317*^9, 3.8957333102784653`*^9}, {3.895733341083591*^9, 
   3.8957333617799177`*^9}, {3.895739915028021*^9, 3.8957399168763523`*^9}, {
   3.895739956286934*^9, 3.895739960845393*^9}, {3.895740036353834*^9, 
   3.8957400475824833`*^9}, 3.895740267670516*^9, {3.895740363081471*^9, 
   3.895740370369906*^9}, {3.895740401135902*^9, 3.89574040209801*^9}, {
   3.8957405628990307`*^9, 3.8957405644202223`*^9}, {3.895740604411921*^9, 
   3.895740610039589*^9}, {3.895740755442668*^9, 3.8957407775015907`*^9}, {
   3.895740883555833*^9, 3.895740889820269*^9}, {3.895741220046998*^9, 
   3.895741223130054*^9}, {3.895741466079542*^9, 3.895741521576285*^9}, {
   3.8957415922179947`*^9, 3.895741593243791*^9}, {3.8957456670099497`*^9, 
   3.895745668385545*^9}, {3.895745725528208*^9, 3.8957457275431337`*^9}, 
   3.8957457701737328`*^9, {3.895745902910035*^9, 3.895745905670906*^9}, {
   3.895745990501214*^9, 3.8957460228781776`*^9}, {3.895746073218238*^9, 
   3.89574607453283*^9}, {3.895746204203211*^9, 3.895746212100449*^9}, {
   3.895746924417447*^9, 3.895746943645068*^9}, {3.895747117304611*^9, 
   3.895747133697699*^9}, {3.895747924832057*^9, 3.895747928325673*^9}, {
   3.895748738594009*^9, 
   3.8957487585063972`*^9}},ExpressionUUID->"07d849aa-9d77-4e6e-928e-\
8d16a1fa3c68"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition", "Subsubsection",
 CellChangeTimes->{{3.7694936745853653`*^9, 
  3.769493676072991*^9}},ExpressionUUID->"6bc80d68-e2ea-4c9e-8e0a-\
55e074be8d59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iFindEcoEq", "[", 
    RowBox[{
    "pars_", ",", "attributesin_", ",", "Gsin_", ",", "init_", ",", "vars_", 
     ",", 
     RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{"(*", " ", "options", " ", "*)"}], "\n", 
      RowBox[{
      "method", ",", "solveopts", ",", "nsolveopts", ",", "findrootopts", ",",
        "findrootsopts", ",", "\n", "boundarydetection", ",", "time", ",", 
       "fixed", ",", "chop", ",", "qss", ",", "percapita", ",", "verbose", 
       ",", "ignorevar", ",", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"other", " ", "variables"}], " ", "*)"}], "\n", "attributes", 
       ",", "nonvars", ",", "nonfixedvars", ",", "fixedvars", ",", "Gs", ",", 
       "removets", ",", "eqns", ",", "unks", ",", "newunk", ",", "sol", ",", 
       "res"}], "}"}], ",", "\n", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[ScriptCapitalN]", ",", "verbosity", ",", 
         RowBox[{"func", "=", "\"\<FindEcoEq\>\""}]}], "}"}], ",", "\n", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "verbosity"}], " ", "*)"}], "\n", "\n", 
       RowBox[{
        RowBox[{"verbose", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Verbose", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Verbosity", "/.", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"opts", ",", 
                  RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
              "]"}]}], "]"}]}], ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Verbosity", "/.", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"opts", ",", 
                RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "Global`$verbosity", "]"}], ",", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"Global`$verbosity", ",", "verbosity"}], "]"}]}]}], "]"}],
         ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"handle", " ", "options"}], " ", "*)"}], "\n", "\n", 
        RowBox[{"method", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Method", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"findrootopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"FindRootOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"findrootsopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"FindRootsOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"boundarydetection", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"BoundaryDetection", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"time", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Time", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"chop", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Chop", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"qss", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"QSS", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"fixed", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Fixed", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"percapita", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"PerCapita", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"ignorevar", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"IgnoreVar", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"FindEcoEq", " ", 
          RowBox[{"doesn", "'"}], "t", " ", "work", " ", "on", " ", 
          "Periodic", " ", "models"}], " ", "*)"}], "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"modelperiod", "=!=", "0"}], "&&", 
           RowBox[{"time", "===", "t"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"FindEcoEq", "::", "noneq"}], "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"fix", " ", "attributes"}], " ", "*)"}], "\n", 
        RowBox[{"attributes", "=", 
         RowBox[{"FixAttributes", "[", "attributesin", "]"}]}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "figure", " ", "out", " ", "number", " ", "of", " ", "species", " ", 
          "in", " ", "guilds"}], " ", "*)"}], "\n", 
        RowBox[{"Set\[ScriptCapitalN]", "[", "attributes", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<\[ScriptCapitalN]=\>\"", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"expand", " ", "Gs"}], " ", "*)"}], "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gsin=\>\"", ",", "Gsin"}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"moments", ",", "\n", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Gsin", "===", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Gs", "=", "ZeroGs"}], ",", 
            RowBox[{"Gs", "=", 
             RowBox[{"ExpandGs", "[", 
              RowBox[{"Gsin", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[FormalCapitalN]", "[", "gu", "]"}], "\[Rule]", 
                  RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}]}]}], 
           "]"}], ",", "\n", "\t", 
          RowBox[{"Gs", "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vars", "===", "All"}], ",", "\n", "\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"vars", "=", "AllVariables"}], ";"}], "*)"}], "\n", "\t", 
          
          RowBox[{"nonvars", "=", 
           RowBox[{"{", "}"}]}], ",", "\n", "\t", 
          RowBox[{"nonvars", "=", 
           RowBox[{"OrderedComplement", "[", 
            RowBox[{"AllVariables", ",", "vars"}], "]"}]}]}], "\n", "]"}], 
        ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonvars=\>\"", ",", "nonvars"}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"qss", "\[Equal]", "False"}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "0"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "x"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<fixed=\>\"", ",", "fixed"}], "]"}], ";", "\n",
         "\n", 
        RowBox[{"fixedvars", "=", 
         RowBox[{"fixed", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        RowBox[{"nonfixedvars", "=", 
         RowBox[{"OrderedComplement", "[", 
          RowBox[{"AllVariables", ",", "fixedvars"}], "]"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonfixedvars=\>\"", ",", "nonfixedvars"}], 
         "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"set", " ", "eqns"}], " ", "*)"}], "\n", 
        RowBox[{"eqns", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"EcoEqns", "[", 
               RowBox[{"attributes", ",", 
                RowBox[{"Fixed", "\[Rule]", "fixed"}], ",", 
                RowBox[{"PerCapita", "\[Rule]", "percapita"}], ",", 
                RowBox[{"IgnoreVar", "->", "ignorevar"}]}], "]"}], "/.", 
              "Eq"}], "/.", 
             RowBox[{"t", "\[Rule]", "time"}]}], "/.", "fixed"}], "/.", 
           "attributes"}], "/.", "Gs"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<eqns=\>\"", ",", "eqns"}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"solve", " ", "it"}], " ", "*)"}], "\n", 
        RowBox[{"Which", "[", "\n", "\t", 
         RowBox[{
          StyleBox[
           RowBox[{"method", "\[Equal]", "\"\<FindRoot\>\""}],
           FontSize->16], 
          StyleBox[",",
           FontSize->16], "\n", "\t", 
          RowBox[{
           RowBox[{"unks", "=", 
            RowBox[{"Table", "[", "\n", "\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"newunk", "=", 
                RowBox[{"{", 
                 RowBox[{"var", ",", 
                  RowBox[{"(", 
                   RowBox[{"var", "/.", 
                    RowBox[{"Append", "[", 
                    RowBox[{"init", ",", 
                    RowBox[{"var", "\[Rule]", "0"}]}], "]"}]}], ")"}]}], 
                 "}"}]}], ";", "\n", "\t\t", 
               RowBox[{"If", "[", 
                RowBox[{"boundarydetection", ",", 
                 RowBox[{"newunk", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"newunk", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"range", "[", "var", "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"range", "[", "var", "]"}], "]"}]}], "}"}]}], 
                   "]"}]}]}], "]"}], ";", "\n", "\t\t", "newunk"}], ",", 
              RowBox[{"{", 
               RowBox[{"var", ",", "nonfixedvars"}], "}"}]}], "]"}]}], ";", 
           "\n", "\t", 
           RowBox[{"VPrint", "[", 
            RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", 
           "\n", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"eqns", "=", "eqns"}], ",", 
                 RowBox[{"unks", "=", "unks"}], ",", 
                 RowBox[{"options", "=", 
                  RowBox[{"Sequence", "@@", "findrootopts"}]}]}], "}"}], ",", 
               
               RowBox[{"PrintCall", "[", 
                RowBox[{"Global`sol", "=", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
           RowBox[{"sol", "=", 
            RowBox[{"FindRoot", "[", 
             RowBox[{"eqns", ",", "unks", ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "findrootopts"}], "]"}]}], "]"}]}]}],
           ",", "\n", "\n", "\t", 
          StyleBox[
           RowBox[{"method", "==", "\"\<FindRoots\>\""}],
           FontSize->16], 
          StyleBox[",",
           FontSize->16], "\n", "\t", 
          RowBox[{
           RowBox[{"unks", "=", "vars"}], ";", "\n", "\t", 
           RowBox[{"VPrint", "[", 
            RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", 
           "\n", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"eqns", "=", "eqns"}], ",", 
                 RowBox[{"unks", "=", "unks"}], ",", 
                 RowBox[{"options", "=", 
                  RowBox[{"Sequence", "@@", "findrootsopts"}]}]}], "}"}], ",", 
               RowBox[{"PrintCall", "[", 
                RowBox[{"Global`sol", "=", 
                 RowBox[{"FindRoots", "[", 
                  RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
           RowBox[{"sol", "=", 
            RowBox[{"FindRoots", "[", 
             RowBox[{"eqns", ",", "init", ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "findrootsopts"}], "]"}]}], 
             "]"}]}]}], ",", "\n", "\t", "Else", ",", "\n", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EcoEq", "::", "badmtd"}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], "\n", "]"}], ";",
         "\n", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<sol=\>\"", ",", "sol"}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"add", " ", "in", " ", "Fixed", " ", "variables"}], " ", 
         "*)"}], "\n", 
        RowBox[{"Which", "[", "\n", "\t", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<Solve\>\"", ",", "\"\<NSolve\>\"", ",", 
              "\"\<FindRoots\>\""}], "}"}], ",", "method"}], "]"}], ",", "\n",
           "\t", 
          RowBox[{"res", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"fixed", ",", 
                 RowBox[{"var_", "\[Rule]", "var_"}]}], "]"}], ",", "#"}], 
              "]"}], "&"}], " ", "/@", " ", "sol"}]}], ",", "\n", "\t", 
          RowBox[{"method", "\[Equal]", "\"\<FindRoot\>\""}], ",", "\n", "\t", 
          RowBox[{"res", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"fixed", ",", 
               RowBox[{"var_", "\[Rule]", "var_"}]}], "]"}], ",", "sol"}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"chop", ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", 
              RowBox[{"Chop", "[", "res", "]"}], "]"}], ",", "AllVariables"}],
             "]"}], "]"}], ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", "res", "]"}], ",", "AllVariables"}], 
            "]"}], "]"}]}], "\n", "]"}], ";"}]}], "\n", "\n", "]"}]}], 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.687881450105945*^9, 3.6878814505620613`*^9}, {
   3.68857168476537*^9, 3.688571684934305*^9}, {3.6885717562075033`*^9, 
   3.688571756902958*^9}, {3.688571805445076*^9, 3.6885718054840527`*^9}, {
   3.6885777801299953`*^9, 3.688577821198338*^9}, {3.688578111707645*^9, 
   3.688578263696265*^9}, {3.688583189141659*^9, 3.688583201104134*^9}, {
   3.6885837935779333`*^9, 3.688583810589251*^9}, {3.688583857663521*^9, 
   3.688583866440373*^9}, 3.688584023610524*^9, {3.688584454327429*^9, 
   3.688584464134824*^9}, {3.6885851260336657`*^9, 3.6885852077551622`*^9}, 
   3.688685223038662*^9, {3.693593326673889*^9, 3.693593328006213*^9}, {
   3.693651209563744*^9, 3.693651212696253*^9}, {3.693651330751341*^9, 
   3.693651337237907*^9}, {3.693700342037077*^9, 3.6937003445534773`*^9}, {
   3.69961046687166*^9, 3.699610497623667*^9}, 3.709124896659213*^9, {
   3.709336699110145*^9, 3.709336699577385*^9}, {3.7101059510781393`*^9, 
   3.710105954644555*^9}, {3.710254347130986*^9, 3.710254357145165*^9}, {
   3.710254389172209*^9, 3.7102544454183407`*^9}, {3.710286418340989*^9, 
   3.710286419629771*^9}, 3.710286914350444*^9, 3.7127385346721067`*^9, {
   3.714088449593779*^9, 3.714088465042605*^9}, {3.714088783139654*^9, 
   3.714088791448407*^9}, {3.714088844203219*^9, 3.71408885600861*^9}, 
   3.714089170503827*^9, {3.7140892855105886`*^9, 3.7140893056027193`*^9}, {
   3.7146455898601007`*^9, 3.714645607554661*^9}, {3.714645833218658*^9, 
   3.714645878205338*^9}, {3.7146594716484127`*^9, 3.714659498519136*^9}, {
   3.714659560420806*^9, 3.714659597546504*^9}, {3.714661306250412*^9, 
   3.7146613128544407`*^9}, {3.7146613520466423`*^9, 3.714661374692927*^9}, {
   3.714661426985828*^9, 3.714661471021627*^9}, {3.714670952581798*^9, 
   3.7146709761045732`*^9}, {3.714673053941062*^9, 3.71467307388553*^9}, {
   3.714673325535184*^9, 3.7146733431977777`*^9}, {3.714673385822101*^9, 
   3.714673408156714*^9}, {3.7146763296033154`*^9, 3.714676349908175*^9}, {
   3.714676870217898*^9, 3.7146768813446712`*^9}, {3.714677005871266*^9, 
   3.7146770388481817`*^9}, {3.714677885477186*^9, 3.714677895396152*^9}, {
   3.7146815798359137`*^9, 3.71468158317702*^9}, {3.714686709068077*^9, 
   3.714686720449131*^9}, {3.714686780357995*^9, 3.714686847805605*^9}, {
   3.714686886251251*^9, 3.7146869069408197`*^9}, {3.7146904343318*^9, 
   3.714690435561199*^9}, {3.7146905887398357`*^9, 3.714690601923481*^9}, {
   3.714690631972337*^9, 3.714690933211876*^9}, {3.714691441205781*^9, 
   3.7146914443765163`*^9}, 3.714771558293874*^9, {3.71477345759927*^9, 
   3.714773544216226*^9}, {3.714773631881823*^9, 3.714773638759398*^9}, {
   3.7147737076976557`*^9, 3.714773768872843*^9}, {3.714773810344654*^9, 
   3.714773862655966*^9}, {3.714774175646474*^9, 3.714774238321686*^9}, {
   3.714774276778345*^9, 3.714774313756324*^9}, {3.714774363666697*^9, 
   3.714774431577939*^9}, {3.71477474128935*^9, 3.714774765274622*^9}, {
   3.714774824264062*^9, 3.7147748384112673`*^9}, {3.7147748942865953`*^9, 
   3.7147749226594543`*^9}, {3.7147749728240833`*^9, 
   3.7147749743011627`*^9}, {3.714777387544536*^9, 3.714777422944803*^9}, {
   3.715423204967746*^9, 3.715423247100832*^9}, {3.716851794553669*^9, 
   3.716851838573512*^9}, {3.716851923962669*^9, 3.71685195096766*^9}, {
   3.716852009532653*^9, 3.716852055393906*^9}, {3.716852216771632*^9, 
   3.71685231192962*^9}, {3.7168523670615377`*^9, 3.71685238929698*^9}, {
   3.7168524239048243`*^9, 3.716852506519627*^9}, {3.7168526119630947`*^9, 
   3.716852660342918*^9}, {3.720561423750366*^9, 3.720561426334433*^9}, {
   3.720561478834214*^9, 3.720561481166069*^9}, {3.721849189319437*^9, 
   3.72184920349916*^9}, {3.721849430040469*^9, 3.7218494327297087`*^9}, 
   3.7218496199026947`*^9, {3.722043437583398*^9, 3.722043661426222*^9}, {
   3.722083757551734*^9, 3.72208381655929*^9}, {3.725055711251069*^9, 
   3.725055715332081*^9}, 3.7251409579843616`*^9, 3.725141965221623*^9, {
   3.728485760884264*^9, 3.728485790162279*^9}, {3.728492488068541*^9, 
   3.728492510850383*^9}, {3.728493399302709*^9, 3.728493401619061*^9}, {
   3.7284934402687283`*^9, 3.728493443062832*^9}, {3.728495197386813*^9, 
   3.7284952624184313`*^9}, {3.728495727453259*^9, 3.7284957368624372`*^9}, {
   3.728495928466558*^9, 3.72849592873841*^9}, {3.731976096240344*^9, 
   3.7319762267049303`*^9}, {3.731976277432869*^9, 3.7319762780290833`*^9}, {
   3.7319768020188913`*^9, 3.731976803777299*^9}, {3.731976892921598*^9, 
   3.731976916165578*^9}, {3.731976959563902*^9, 3.731976962085402*^9}, {
   3.731977155942281*^9, 3.73197716443357*^9}, {3.731977195279862*^9, 
   3.7319772065728207`*^9}, {3.731977279507853*^9, 3.731977284166617*^9}, {
   3.731977461555399*^9, 3.731977465980788*^9}, {3.731978006012163*^9, 
   3.731978013040636*^9}, {3.731978082421216*^9, 3.731978094010425*^9}, {
   3.731979039353709*^9, 3.731979039363929*^9}, {3.731979598523592*^9, 
   3.73197961490341*^9}, {3.73197972820308*^9, 3.7319797289924088`*^9}, {
   3.731980249144205*^9, 3.73198026694471*^9}, 3.731980373788886*^9, {
   3.7319804050810537`*^9, 3.731980445644969*^9}, {3.731980548309566*^9, 
   3.731980566185113*^9}, {3.731980610588462*^9, 3.7319806369962673`*^9}, {
   3.731980738391506*^9, 3.731980763895586*^9}, {3.731980818773868*^9, 
   3.731980857708199*^9}, {3.731980943731715*^9, 3.731981000719969*^9}, 
   3.731981067123608*^9, {3.732221099817436*^9, 3.7322211073866863`*^9}, {
   3.732237132742322*^9, 3.73223714782172*^9}, {3.732237266376129*^9, 
   3.732237271289744*^9}, {3.732273382440886*^9, 3.73227340932165*^9}, {
   3.732273491519849*^9, 3.732273491669429*^9}, {3.732394286439495*^9, 
   3.732394371996009*^9}, 3.755182267229639*^9, 3.755184973022751*^9, {
   3.75582209648076*^9, 3.7558220982190313`*^9}, {3.7558225635660257`*^9, 
   3.7558225772644787`*^9}, {3.7585221898099403`*^9, 3.7585221899906693`*^9}, 
   3.759140406004279*^9, {3.75914072046175*^9, 3.759140778591229*^9}, {
   3.759141110454555*^9, 3.7591411170112877`*^9}, 3.759142070148613*^9, {
   3.759926864600369*^9, 3.759926908779594*^9}, {3.7599440817309227`*^9, 
   3.759944089031756*^9}, {3.7599442652749147`*^9, 3.7599442925085506`*^9}, {
   3.759944468213972*^9, 3.759944470421031*^9}, {3.759944509678103*^9, 
   3.759944625568841*^9}, {3.759944680926206*^9, 3.759944704050845*^9}, {
   3.759944777100625*^9, 3.759944777332377*^9}, {3.7599452123441133`*^9, 
   3.759945212472487*^9}, 3.761151167307536*^9, 3.7613779187363462`*^9, {
   3.769182368428945*^9, 3.7691823684332743`*^9}, {3.769182447225265*^9, 
   3.769182447229724*^9}, 3.7697607053790417`*^9, 3.770438265000821*^9, {
   3.770721434046843*^9, 3.770721434486648*^9}, {3.7746909735763407`*^9, 
   3.774690974277783*^9}, 3.786090308105297*^9, 3.7860903405306396`*^9, {
   3.7861697725876913`*^9, 3.7861697838397303`*^9}, {3.7861698579109*^9, 
   3.7861698645494623`*^9}, {3.786257005170101*^9, 3.786257029661643*^9}, {
   3.786259628183383*^9, 3.78625966453019*^9}, {3.7862596972230663`*^9, 
   3.7862597130857067`*^9}, {3.786260599076335*^9, 3.7862606519012136`*^9}, {
   3.786260711471278*^9, 3.7862607825400476`*^9}, {3.786262427305735*^9, 
   3.7862624297094097`*^9}, {3.786262672446123*^9, 3.7862626757022247`*^9}, {
   3.7941372405540857`*^9, 3.794137240568924*^9}, 3.798128132723709*^9, {
   3.798232559307932*^9, 3.798232607817318*^9}, 3.8002032936287107`*^9, {
   3.800228806267811*^9, 3.8002288701566067`*^9}, {3.800229240434243*^9, 
   3.8002292588092833`*^9}, {3.800230257115494*^9, 3.800230271819356*^9}, {
   3.800230689976359*^9, 3.800230696507571*^9}, {3.800230861506472*^9, 
   3.8002308853617268`*^9}, {3.800231148936945*^9, 3.8002311628361807`*^9}, {
   3.800269707014142*^9, 3.80026972050751*^9}, {3.8004654280139236`*^9, 
   3.8004654993620977`*^9}, {3.807369332962606*^9, 3.807369333743342*^9}, {
   3.807369626808475*^9, 3.807369633505528*^9}, {3.807376451767674*^9, 
   3.807376461724361*^9}, {3.8154778674250393`*^9, 3.8154778786474133`*^9}, {
   3.8154783955502*^9, 3.8154784000536633`*^9}, {3.815479106257626*^9, 
   3.815479107656157*^9}, {3.829315987079705*^9, 3.829316001463244*^9}, 
   3.833033078563163*^9, {3.833033108685328*^9, 3.833033148581917*^9}, 
   3.833038502668605*^9, 3.835030194667267*^9, {3.859148473878541*^9, 
   3.859148484706414*^9}, 3.8591503881615667`*^9, 3.8594808660648727`*^9, 
   3.8594809215028048`*^9, {3.859481010380721*^9, 3.859481014177998*^9}, {
   3.85948118066334*^9, 3.859481183379318*^9}, {3.859481298816181*^9, 
   3.859481315770236*^9}, {3.859481351730167*^9, 3.859481376563326*^9}, {
   3.8595884244545803`*^9, 3.859588479932879*^9}, {3.859588743998242*^9, 
   3.859588765495607*^9}, {3.859588806482554*^9, 3.859588926483329*^9}, {
   3.859589076697467*^9, 3.8595890862667627`*^9}, {3.859589141801827*^9, 
   3.859589247695283*^9}, {3.859589278802657*^9, 3.8595893184973927`*^9}, {
   3.859589355053155*^9, 3.859589394885363*^9}, {3.8595894565019217`*^9, 
   3.859589464785759*^9}, {3.859589499943409*^9, 3.8595895551048613`*^9}, {
   3.859589593067071*^9, 3.8595896843311996`*^9}, 3.859589915082026*^9, {
   3.859589979348977*^9, 3.8595899793771067`*^9}, {3.859590726243621*^9, 
   3.859590757603325*^9}, 3.859640095466408*^9, {3.859648360374277*^9, 
   3.859648389450727*^9}, {3.859649217444069*^9, 3.85964922877459*^9}, {
   3.859657651647107*^9, 3.859657715461317*^9}, {3.8597223431582127`*^9, 
   3.859722349203199*^9}, {3.870793309356901*^9, 3.870793309988036*^9}, 
   3.870810224016097*^9, {3.871909025974709*^9, 3.871909029201529*^9}, 
   3.8719101640474253`*^9, 3.8719116216008463`*^9, {3.8719117586639767`*^9, 
   3.8719117851224957`*^9}, {3.871911824020739*^9, 3.871911898782824*^9}, {
   3.8719119821779833`*^9, 3.871912009909605*^9}, {3.8719124337875853`*^9, 
   3.871912435171369*^9}, {3.8719131498057203`*^9, 3.871913180106717*^9}, {
   3.871913220456274*^9, 3.871913227902382*^9}, {3.8719134735780153`*^9, 
   3.871913509640698*^9}, {3.8719136888826103`*^9, 3.8719137381955547`*^9}, {
   3.871914277230426*^9, 3.871914282229678*^9}, {3.871917802088578*^9, 
   3.871917805074687*^9}, {3.8786729753409986`*^9, 3.878672995239841*^9}, {
   3.895730252940528*^9, 3.895730278366877*^9}, {3.8957303334834337`*^9, 
   3.895730334583846*^9}, 3.895730555648501*^9, {3.8957403869975033`*^9, 
   3.895740409874614*^9}, {3.8957405918184423`*^9, 3.895740593502267*^9}, {
   3.895745674687949*^9, 3.8957456749881287`*^9}, {3.895745778457499*^9, 
   3.895745885426029*^9}, {3.895746427256188*^9, 3.8957464679543333`*^9}, {
   3.8957465015110064`*^9, 3.895746530836865*^9}, {3.8957465648800497`*^9, 
   3.89574656586539*^9}, 3.8957466587158537`*^9, 3.895746902836652*^9, 
   3.895747004855443*^9, {3.895747049148716*^9, 3.8957470925184526`*^9}, {
   3.8957473696738253`*^9, 
   3.895747369832449*^9}},ExpressionUUID->"6ad1d61a-2b99-468a-ab83-\
56fc4ff9ee53"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",ExpressionUUID->"738c8a5a-631b-41e0-8985-7f8534cf7a26"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FindEcoEq", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "Automatic"}], ",", "\n", 
     RowBox[{"FindRootOpts", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"FindRootsOpts", "->", 
      RowBox[{"{", "}"}]}], ",", "\n", 
     RowBox[{"PerCapita", "\[Rule]", "False"}], ",", 
     RowBox[{"Fixed", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Chop", "\[Rule]", "True"}], ",", 
     RowBox[{"QSS", "\[Rule]", "False"}], ",", 
     RowBox[{"Time", "\[Rule]", "t"}], ",", 
     RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
     RowBox[{"Verbosity", "->", "0"}], ",", 
     RowBox[{"IgnoreVar", "->", "False"}]}], "}"}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.68788145061252*^9, {3.6885716849598207`*^9, 3.688571685061096*^9}, 
   3.6998307192614937`*^9, {3.699830756047996*^9, 3.699830757855876*^9}, {
   3.7146768525874043`*^9, 3.714676860849709*^9}, {3.714771544699765*^9, 
   3.714771544916628*^9}, 3.725140957991322*^9, {3.755266321588594*^9, 
   3.755266324656404*^9}, 3.7553697389508457`*^9, 3.755370573729661*^9, 
   3.75994589946877*^9, 3.7701200065679617`*^9, {3.770645589515258*^9, 
   3.770645593339229*^9}, {3.7982325865648317`*^9, 3.798232589900823*^9}, {
   3.817979839496348*^9, 3.817979840182137*^9}, {3.817986745774179*^9, 
   3.817986747250039*^9}, 3.817986827594922*^9, 3.8293159782581778`*^9, {
   3.859588972329741*^9, 3.859588974605693*^9}, {3.859590467440824*^9, 
   3.859590470000128*^9}, {3.8708128961119843`*^9, 3.870812906654851*^9}, 
   3.870813046791561*^9, {3.8719137515576057`*^9, 3.871913757389619*^9}, {
   3.8957463735184927`*^9, 3.895746373790223*^9}, 
   3.895746759024796*^9},ExpressionUUID->"916fd241-1f6d-4a32-bd57-\
20cd779d88b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Messages", "Subsubsection",
 CellChangeTimes->{{3.7695018515541153`*^9, 
  3.769501852845079*^9}},ExpressionUUID->"9719155e-9423-4c4d-b01c-\
1fcb358b29c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "::", "noneq"}], "=", "\n", 
   "\"\<Can't find equilibrium of periodically forced model with FindRoot.  \
Give Time option or try FindEcoCycle instead.\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.769501857001574*^9, 3.769501857579821*^9}, {
  3.8596474251654797`*^9, 3.859647429307817*^9}, {3.8719132863927526`*^9, 
  3.871913346568707*^9}, {3.8957467495110283`*^9, 
  3.8957467516118526`*^9}},ExpressionUUID->"987688a6-7531-4060-9e38-\
714cc76891af"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["FindEcoEqs", "Subsection",
 CellChangeTimes->{{3.6954006453555927`*^9, 3.6954006557460127`*^9}, {
   3.6962556239228687`*^9, 3.696255625343861*^9}, 3.699565737020871*^9, 
   3.895745649128731*^9, 3.895748132798851*^9},
 CellTags->{
  "1.7.0", "1.7.1"},ExpressionUUID->"a2dcdae5-6076-457f-a63d-d727d0518ae5"],

Cell[CellGroupData[{

Cell["Usage", "Subsubsection",
 CellChangeTimes->{{3.769494692292095*^9, 
  3.769494692848196*^9}},ExpressionUUID->"b5f0d8dd-bd56-45fc-af75-\
340d600a0bed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindEcoEqs", "::", "usage"}], " ", "=", " ", "\n", 
   "\"\<FindEcoEqs[\!\(\*StyleBox[\"init\", \"TI\"]\)] finds an ecological \
equilibrium using initial guess / range \!\(\*StyleBox[\"init\", \"TI\"]\).\n\
FindEcoEqs[\!\(\*StyleBox[\"attributes\", \"TI\"]\), \!\(\*StyleBox[\"init\", \
\"TI\"]\)] uses trait values/interaction coefficients \
\!\(\*StyleBox[\"attributes\", \"TI\"]\) and initial guess / range \
\!\(\*StyleBox[\"init\", \"TI\"]\).\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.76948331462147*^9, 3.769483315463594*^9}, {
   3.807375225831135*^9, 3.807375269109378*^9}, {3.807375299950779*^9, 
   3.807375331109776*^9}, {3.807375372814131*^9, 3.807375394598486*^9}, {
   3.8073754723757067`*^9, 3.807375491334848*^9}, {3.8073761836229362`*^9, 
   3.807376252238955*^9}, {3.807378136944607*^9, 3.807378170459052*^9}, {
   3.872019832401194*^9, 3.8720198383532343`*^9}, 3.8957456523698072`*^9, {
   3.8957481364356003`*^9, 
   3.895748140286104*^9}},ExpressionUUID->"0b5f195c-426a-43bf-a5f9-\
17a389906a84"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parser", "Subsubsection",
 CellChangeTimes->{{3.895575257543274*^9, 
  3.8955752603901043`*^9}},ExpressionUUID->"3ae30d26-e084-4509-ba29-\
660ec82b043a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindEcoEqs", "[", "in___", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"func", "=", "FindEcoEqs"}], ",", "args", ",", "opts", ",", 
       "rest", ",", "parameters", ",", "attributes", ",", "Gs", ",", 
       "variables", ",", "variableslist", ",", "ranges", ",", "\n", "vars"}], 
      "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"modelloaded", "\[NotEqual]", "True"}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{"EcoEvoGeneral", "::", "nomodel"}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<in=\>\"", ",", "in"}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"args", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ExtractArgs", "[", 
         RowBox[{
          RowBox[{"{", "in", "}"}], ",", "func"}], "]"}], "]"}]}], ";", "\n", 
      
      RowBox[{"opts", "=", 
       RowBox[{"ExtractOpts", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", "func"}], "]"}]}], ";", "\n", 
      RowBox[{"vars", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", 
         RowBox[{
          RowBox[{"VectorQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], "==", "Symbol"}], "&"}]}], 
           "]"}], "&"}]}], "]"}]}], ";", "\n", 
      RowBox[{"ranges", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "in", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", 
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vars", "==", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"vars", "=", "All"}], ",", 
        RowBox[{"vars", "=", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<args=\>\"", ",", "args"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<opts=\>\"", ",", "opts"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<vars=\>\"", ",", "vars"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ranges=\>\"", ",", "ranges"}], "]"}], ";"}], "*)"}], 
      "\n", "\n", 
      RowBox[{"parameters", "=", 
       RowBox[{"ExtractParameters", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"attributes", "=", 
       RowBox[{"ExtractAttributes", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"Gs", "=", 
       RowBox[{"ExtractVarCovs", "[", "args", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<parameters=\>\"", ",", "parameters"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<attributes=\>\"", ",", "attributes"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"iFindEcoEqs", "[", 
       RowBox[{
       "parameters", ",", "attributes", ",", "Gs", ",", "ranges", ",", "vars",
         ",", "opts"}], "]"}]}]}], "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.7127802306821003`*^9, 3.71278023163732*^9}, {
   3.769860889371685*^9, 3.769860898625585*^9}, {3.890088762767192*^9, 
   3.8900887857559834`*^9}, {3.890088825582732*^9, 3.8900888418951406`*^9}, {
   3.8900889470940847`*^9, 3.890088957136177*^9}, {3.8901267099939337`*^9, 
   3.890126710376408*^9}, {3.89012675925627*^9, 3.89012677188067*^9}, {
   3.890147666024979*^9, 3.890147669484149*^9}, {3.895556083668763*^9, 
   3.895556095879417*^9}, 3.8955566991026297`*^9, {3.8955577669801817`*^9, 
   3.8955577681779213`*^9}, {3.8955622577005453`*^9, 3.895562258529551*^9}, 
   3.89556232631433*^9, {3.89556263361314*^9, 3.8955626472449636`*^9}, {
   3.895562842722169*^9, 3.895562849597785*^9}, {3.895563092493565*^9, 
   3.895563126066338*^9}, {3.895563181729741*^9, 3.89556321475914*^9}, {
   3.895565622997553*^9, 3.895565825215711*^9}, {3.895566197384026*^9, 
   3.8955663023293247`*^9}, {3.8955663794538603`*^9, 3.895566420626652*^9}, {
   3.895567028632929*^9, 3.895567029623745*^9}, {3.895567212564479*^9, 
   3.895567218896427*^9}, {3.895567272624502*^9, 3.895567274409018*^9}, {
   3.8955675907546473`*^9, 3.895567768041896*^9}, {3.895567851076992*^9, 
   3.895567855084454*^9}, {3.895567885960531*^9, 3.8955679150019197`*^9}, {
   3.8955680083366737`*^9, 3.895568008699531*^9}, {3.895568048854352*^9, 
   3.895568157442192*^9}, {3.895568229874014*^9, 3.895568253702044*^9}, {
   3.8955693854122*^9, 3.8955694265490522`*^9}, 3.895575272473558*^9, {
   3.895575467928422*^9, 3.8955755135470257`*^9}, 3.895575682651147*^9, 
   3.895578721564733*^9, 3.895579374206821*^9, {3.89557941527911*^9, 
   3.8955794329631166`*^9}, {3.8955794748472223`*^9, 3.895579478562263*^9}, {
   3.895579560992878*^9, 3.895579561228808*^9}, {3.8955796500246983`*^9, 
   3.8955796662780857`*^9}, {3.895579769850182*^9, 3.895579777141037*^9}, {
   3.895579856895706*^9, 3.8955798595931683`*^9}, 3.895588510289165*^9, {
   3.8955886111527357`*^9, 3.895588612849946*^9}, {3.895589347468148*^9, 
   3.895589379222314*^9}, 3.895589610715495*^9, {3.895590444412505*^9, 
   3.895590453519902*^9}, 3.895590508127524*^9, 3.8955905439582157`*^9, {
   3.895592440937796*^9, 3.895592532735264*^9}, {3.895592590752514*^9, 
   3.895592650561548*^9}, {3.8955927319425507`*^9, 3.895592749052278*^9}, {
   3.8955928168610477`*^9, 3.895592818217918*^9}, {3.895592874955657*^9, 
   3.895592877402446*^9}, {3.8955932689174023`*^9, 3.895593272134426*^9}, {
   3.8955933455504208`*^9, 3.895593351409342*^9}, {3.895593492152051*^9, 
   3.895593498259594*^9}, {3.8955937696317577`*^9, 3.895593822470418*^9}, {
   3.895594059820359*^9, 3.895594072801594*^9}, {3.895594137936792*^9, 
   3.895594145714094*^9}, {3.895594303461802*^9, 3.895594305709622*^9}, 
   3.895594386310108*^9, {3.895594605950818*^9, 3.895594668846685*^9}, 
   3.8955947205307293`*^9, {3.8955949418141413`*^9, 3.895594948532854*^9}, {
   3.895594990704443*^9, 3.895594992920826*^9}, {3.895595557746958*^9, 
   3.895595583989648*^9}, 3.895595615253611*^9, {3.895595728916885*^9, 
   3.895595737345203*^9}, {3.895596389418861*^9, 3.89559639595473*^9}, {
   3.895723271852386*^9, 3.8957232826615477`*^9}, {3.8957234998949127`*^9, 
   3.895723500200151*^9}, {3.8957242143085203`*^9, 3.895724217157454*^9}, {
   3.895724248060494*^9, 3.8957243588861322`*^9}, {3.89572449468648*^9, 
   3.895724523840683*^9}, 3.8957253216621437`*^9, {3.895725378768009*^9, 
   3.895725408595636*^9}, {3.8957259620756197`*^9, 3.895725965867037*^9}, 
   3.895728224448289*^9, 3.895728385634983*^9, {3.8957300332924833`*^9, 
   3.895730144758787*^9}, {3.8957301798778553`*^9, 3.895730182357575*^9}, {
   3.895730289538713*^9, 3.895730391101716*^9}, {3.895730526156761*^9, 
   3.895730532051901*^9}, {3.89573058065491*^9, 3.8957306458853292`*^9}, 
   3.895730712347293*^9, {3.895730770671678*^9, 3.8957308047917347`*^9}, {
   3.895730894218618*^9, 3.895730896210866*^9}, 3.895730996639587*^9, {
   3.895731039820635*^9, 3.895731053193363*^9}, {3.895731088006267*^9, 
   3.8957311912927027`*^9}, 3.895731256114368*^9, {3.895731355063397*^9, 
   3.895731359533929*^9}, {3.895731606212158*^9, 3.89573165236588*^9}, 
   3.895732191332889*^9, {3.895732243309506*^9, 3.895732244028244*^9}, {
   3.895733005810913*^9, 3.8957330070744953`*^9}, {3.895733079504335*^9, 
   3.8957330993229094`*^9}, {3.895733177048377*^9, 3.8957331856636963`*^9}, {
   3.895733261265317*^9, 3.8957333102784653`*^9}, {3.895733341083591*^9, 
   3.8957333617799177`*^9}, {3.895739915028021*^9, 3.8957399168763523`*^9}, {
   3.895739956286934*^9, 3.895739960845393*^9}, {3.895740036353834*^9, 
   3.8957400475824833`*^9}, 3.895740267670516*^9, {3.895740363081471*^9, 
   3.895740370369906*^9}, {3.895740401135902*^9, 3.89574040209801*^9}, {
   3.8957405628990307`*^9, 3.8957405644202223`*^9}, {3.895740604411921*^9, 
   3.895740610039589*^9}, {3.895740755442668*^9, 3.8957407775015907`*^9}, {
   3.895740883555833*^9, 3.895740889820269*^9}, {3.895741220046998*^9, 
   3.895741223130054*^9}, {3.895741466079542*^9, 3.895741521576285*^9}, {
   3.8957415922179947`*^9, 3.895741593243791*^9}, {3.8957456670099497`*^9, 
   3.895745668385545*^9}, {3.895745725528208*^9, 3.8957457275431337`*^9}, 
   3.8957457701737328`*^9, {3.895745902910035*^9, 3.895745905670906*^9}, {
   3.895745990501214*^9, 3.8957460228781776`*^9}, {3.895746073218238*^9, 
   3.89574607453283*^9}, {3.895746204203211*^9, 3.895746212100449*^9}, {
   3.895746924417447*^9, 3.895746943645068*^9}, {3.895747117304611*^9, 
   3.895747133697699*^9}, {3.895747924832057*^9, 3.895747928325673*^9}, {
   3.895748148886169*^9, 3.895748187861413*^9}, {3.895748282354927*^9, 
   3.895748285721237*^9}, {3.895748703413549*^9, 
   3.89574870620884*^9}},ExpressionUUID->"46864737-e396-499c-86e6-\
c2eca1a1c8d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition", "Subsubsection",
 CellChangeTimes->{{3.7694936745853653`*^9, 
  3.769493676072991*^9}},ExpressionUUID->"c6c513e6-7f01-4df5-8c2b-\
8ea70acf14ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"iFindEcoEqs", "[", 
    RowBox[{
    "pars_", ",", "attributesin_", ",", "Gsin_", ",", "ranges_", ",", "vars_",
      ",", 
     RowBox[{"opts___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{"(*", " ", "options", " ", "*)"}], "\n", 
      RowBox[{
      "method", ",", "solveopts", ",", "nsolveopts", ",", "findrootopts", ",",
        "findrootsopts", ",", "\n", "boundarydetection", ",", "time", ",", 
       "fixed", ",", "chop", ",", "qss", ",", "percapita", ",", "verbose", 
       ",", "ignorevar", ",", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"other", " ", "variables"}], " ", "*)"}], "\n", "attributes", 
       ",", "nonvars", ",", "nonfixedvars", ",", "fixedvars", ",", "Gs", ",", 
       "removets", ",", "eqns", ",", "unks", ",", "newunk", ",", "sol", ",", 
       "res"}], "}"}], ",", "\n", "\n", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[ScriptCapitalN]", ",", "verbosity", ",", 
         RowBox[{"func", "=", "\"\<FindEcoEqs\>\""}]}], "}"}], ",", "\n", 
       "\n", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "verbosity"}], " ", "*)"}], "\n", "\n", 
       RowBox[{
        RowBox[{"verbose", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Verbose", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"verbose", ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Verbosity", "/.", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{"opts", ",", 
                  RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
              "]"}]}], "]"}]}], ",", "\n", "\t", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Verbosity", "/.", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"opts", ",", 
                RowBox[{"Options", "[", "EcoEq", "]"}]}], "}"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "Global`$verbosity", "]"}], ",", 
          RowBox[{"verbosity", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"Global`$verbosity", ",", "verbosity"}], "]"}]}]}], "]"}],
         ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"handle", " ", "options"}], " ", "*)"}], "\n", "\n", 
        RowBox[{"method", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Method", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"findrootsopts", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"FindRootsOpts", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"boundarydetection", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"BoundaryDetection", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"time", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Time", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"chop", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Chop", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"qss", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"QSS", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"fixed", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Fixed", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"percapita", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"PerCapita", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"ignorevar", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"IgnoreVar", "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"opts", ",", 
              RowBox[{"Options", "[", "FindEcoEq", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"FindEcoEq", " ", 
          RowBox[{"doesn", "'"}], "t", " ", "work", " ", "on", " ", 
          "Periodic", " ", "models"}], " ", "*)"}], "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"modelperiod", "=!=", "0"}], "&&", 
           RowBox[{"time", "===", "t"}]}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"FindEcoEq", "::", "noneq"}], "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"fix", " ", "attributes"}], " ", "*)"}], "\n", 
        RowBox[{"attributes", "=", 
         RowBox[{"FixAttributes", "[", "attributesin", "]"}]}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "figure", " ", "out", " ", "number", " ", "of", " ", "species", " ", 
          "in", " ", "guilds"}], " ", "*)"}], "\n", 
        RowBox[{"Set\[ScriptCapitalN]", "[", "attributes", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<\[ScriptCapitalN]=\>\"", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"expand", " ", "Gs"}], " ", "*)"}], "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gsin=\>\"", ",", "Gsin"}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"moments", ",", "\n", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Gsin", "===", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Gs", "=", "ZeroGs"}], ",", 
            RowBox[{"Gs", "=", 
             RowBox[{"ExpandGs", "[", 
              RowBox[{"Gsin", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[FormalCapitalN]", "[", "gu", "]"}], "\[Rule]", 
                  RowBox[{"\[ScriptCapitalN]", "[", "gu", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"gu", ",", "guilds"}], "}"}]}], "]"}]}], "]"}]}]}], 
           "]"}], ",", "\n", "\t", 
          RowBox[{"Gs", "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<Gs=\>\"", ",", "Gs"}], "]"}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"vars", "===", "All"}], ",", "\n", "\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"vars", "=", "AllVariables"}], ";"}], "*)"}], "\n", "\t", 
          
          RowBox[{"nonvars", "=", 
           RowBox[{"{", "}"}]}], ",", "\n", "\t", 
          RowBox[{"nonvars", "=", 
           RowBox[{"OrderedComplement", "[", 
            RowBox[{"AllVariables", ",", "vars"}], "]"}]}]}], "\n", "]"}], 
        ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonvars=\>\"", ",", "nonvars"}], "]"}], ";", 
        "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"qss", "\[Equal]", "False"}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "0"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}], ",", "\n", "\t", 
          RowBox[{"fixed", "=", 
           RowBox[{"JoinFirst", "[", 
            RowBox[{"fixed", ",", 
             RowBox[{"Replace", "[", 
              RowBox[{"nonvars", ",", 
               RowBox[{"x_", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"x", "\[Rule]", "x"}], ")"}]}], ",", "1"}], "]"}]}], 
            "]"}]}]}], "\n", "]"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<fixed=\>\"", ",", "fixed"}], "]"}], ";", "\n",
         "\n", 
        RowBox[{"fixedvars", "=", 
         RowBox[{"fixed", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        RowBox[{"nonfixedvars", "=", 
         RowBox[{"OrderedComplement", "[", 
          RowBox[{"AllVariables", ",", "fixedvars"}], "]"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<nonfixedvars=\>\"", ",", "nonfixedvars"}], 
         "]"}], ";", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"set", " ", "eqns"}], " ", "*)"}], "\n", 
        RowBox[{"eqns", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"EcoEqns", "[", 
               RowBox[{"attributes", ",", 
                RowBox[{"Fixed", "\[Rule]", "fixed"}], ",", 
                RowBox[{"PerCapita", "\[Rule]", "percapita"}], ",", 
                RowBox[{"IgnoreVar", "->", "ignorevar"}]}], "]"}], "/.", 
              "Eq"}], "/.", 
             RowBox[{"t", "\[Rule]", "time"}]}], "/.", "fixed"}], "/.", 
           "attributes"}], "/.", "Gs"}]}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<eqns=\>\"", ",", "eqns"}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"unks", "=", "vars"}], ";", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<unks=\>\"", ",", "unks"}], "]"}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"verbosity", ">=", "1"}], ",", "\n", "\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"eqns", "=", "eqns"}], ",", 
              RowBox[{"unks", "=", "unks"}], ",", 
              RowBox[{"options", "=", 
               RowBox[{"Sequence", "@@", "findrootsopts"}]}]}], "}"}], ",", 
            RowBox[{"PrintCall", "[", 
             RowBox[{"Global`sol", "=", 
              RowBox[{"FindRoots", "[", 
               RowBox[{"eqns", ",", "unks", ",", "options"}], "]"}]}], 
             "]"}]}], "]"}]}], "]"}], ";", "\n", 
        RowBox[{"sol", "=", 
         RowBox[{"FindRoots", "[", 
          RowBox[{"eqns", ",", 
           RowBox[{"Sequence", "@@", "ranges"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", "findrootsopts"}], "]"}]}], "]"}]}], 
        ";", "\n", "\n", 
        RowBox[{"VPrint", "[", 
         RowBox[{"3", ",", "\"\<sol=\>\"", ",", "sol"}], "]"}], ";", "\n", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"add", " ", "in", " ", "Fixed", " ", "variables"}], " ", 
         "*)"}], "\n", 
        RowBox[{"res", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"fixed", ",", 
               RowBox[{"var_", "\[Rule]", "var_"}]}], "]"}], ",", "#"}], 
            "]"}], "&"}], " ", "/@", " ", "sol"}]}], ";", "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{"chop", ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", 
              RowBox[{"Chop", "[", "res", "]"}], "]"}], ",", "AllVariables"}],
             "]"}], "]"}], ",", "\n", "\t", 
          RowBox[{"Return", "[", 
           RowBox[{"SortRuleList", "[", 
            RowBox[{
             RowBox[{"EqSort", "[", "res", "]"}], ",", "AllVariables"}], 
            "]"}], "]"}]}], "\n", "]"}], ";"}]}], "\n", "\n", "]"}]}], 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.687881450105945*^9, 3.6878814505620613`*^9}, {
   3.68857168476537*^9, 3.688571684934305*^9}, {3.6885717562075033`*^9, 
   3.688571756902958*^9}, {3.688571805445076*^9, 3.6885718054840527`*^9}, {
   3.6885777801299953`*^9, 3.688577821198338*^9}, {3.688578111707645*^9, 
   3.688578263696265*^9}, {3.688583189141659*^9, 3.688583201104134*^9}, {
   3.6885837935779333`*^9, 3.688583810589251*^9}, {3.688583857663521*^9, 
   3.688583866440373*^9}, 3.688584023610524*^9, {3.688584454327429*^9, 
   3.688584464134824*^9}, {3.6885851260336657`*^9, 3.6885852077551622`*^9}, 
   3.688685223038662*^9, {3.693593326673889*^9, 3.693593328006213*^9}, {
   3.693651209563744*^9, 3.693651212696253*^9}, {3.693651330751341*^9, 
   3.693651337237907*^9}, {3.693700342037077*^9, 3.6937003445534773`*^9}, {
   3.69961046687166*^9, 3.699610497623667*^9}, 3.709124896659213*^9, {
   3.709336699110145*^9, 3.709336699577385*^9}, {3.7101059510781393`*^9, 
   3.710105954644555*^9}, {3.710254347130986*^9, 3.710254357145165*^9}, {
   3.710254389172209*^9, 3.7102544454183407`*^9}, {3.710286418340989*^9, 
   3.710286419629771*^9}, 3.710286914350444*^9, 3.7127385346721067`*^9, {
   3.714088449593779*^9, 3.714088465042605*^9}, {3.714088783139654*^9, 
   3.714088791448407*^9}, {3.714088844203219*^9, 3.71408885600861*^9}, 
   3.714089170503827*^9, {3.7140892855105886`*^9, 3.7140893056027193`*^9}, {
   3.7146455898601007`*^9, 3.714645607554661*^9}, {3.714645833218658*^9, 
   3.714645878205338*^9}, {3.7146594716484127`*^9, 3.714659498519136*^9}, {
   3.714659560420806*^9, 3.714659597546504*^9}, {3.714661306250412*^9, 
   3.7146613128544407`*^9}, {3.7146613520466423`*^9, 3.714661374692927*^9}, {
   3.714661426985828*^9, 3.714661471021627*^9}, {3.714670952581798*^9, 
   3.7146709761045732`*^9}, {3.714673053941062*^9, 3.71467307388553*^9}, {
   3.714673325535184*^9, 3.7146733431977777`*^9}, {3.714673385822101*^9, 
   3.714673408156714*^9}, {3.7146763296033154`*^9, 3.714676349908175*^9}, {
   3.714676870217898*^9, 3.7146768813446712`*^9}, {3.714677005871266*^9, 
   3.7146770388481817`*^9}, {3.714677885477186*^9, 3.714677895396152*^9}, {
   3.7146815798359137`*^9, 3.71468158317702*^9}, {3.714686709068077*^9, 
   3.714686720449131*^9}, {3.714686780357995*^9, 3.714686847805605*^9}, {
   3.714686886251251*^9, 3.7146869069408197`*^9}, {3.7146904343318*^9, 
   3.714690435561199*^9}, {3.7146905887398357`*^9, 3.714690601923481*^9}, {
   3.714690631972337*^9, 3.714690933211876*^9}, {3.714691441205781*^9, 
   3.7146914443765163`*^9}, 3.714771558293874*^9, {3.71477345759927*^9, 
   3.714773544216226*^9}, {3.714773631881823*^9, 3.714773638759398*^9}, {
   3.7147737076976557`*^9, 3.714773768872843*^9}, {3.714773810344654*^9, 
   3.714773862655966*^9}, {3.714774175646474*^9, 3.714774238321686*^9}, {
   3.714774276778345*^9, 3.714774313756324*^9}, {3.714774363666697*^9, 
   3.714774431577939*^9}, {3.71477474128935*^9, 3.714774765274622*^9}, {
   3.714774824264062*^9, 3.7147748384112673`*^9}, {3.7147748942865953`*^9, 
   3.7147749226594543`*^9}, {3.7147749728240833`*^9, 
   3.7147749743011627`*^9}, {3.714777387544536*^9, 3.714777422944803*^9}, {
   3.715423204967746*^9, 3.715423247100832*^9}, {3.716851794553669*^9, 
   3.716851838573512*^9}, {3.716851923962669*^9, 3.71685195096766*^9}, {
   3.716852009532653*^9, 3.716852055393906*^9}, {3.716852216771632*^9, 
   3.71685231192962*^9}, {3.7168523670615377`*^9, 3.71685238929698*^9}, {
   3.7168524239048243`*^9, 3.716852506519627*^9}, {3.7168526119630947`*^9, 
   3.716852660342918*^9}, {3.720561423750366*^9, 3.720561426334433*^9}, {
   3.720561478834214*^9, 3.720561481166069*^9}, {3.721849189319437*^9, 
   3.72184920349916*^9}, {3.721849430040469*^9, 3.7218494327297087`*^9}, 
   3.7218496199026947`*^9, {3.722043437583398*^9, 3.722043661426222*^9}, {
   3.722083757551734*^9, 3.72208381655929*^9}, {3.725055711251069*^9, 
   3.725055715332081*^9}, 3.7251409579843616`*^9, 3.725141965221623*^9, {
   3.728485760884264*^9, 3.728485790162279*^9}, {3.728492488068541*^9, 
   3.728492510850383*^9}, {3.728493399302709*^9, 3.728493401619061*^9}, {
   3.7284934402687283`*^9, 3.728493443062832*^9}, {3.728495197386813*^9, 
   3.7284952624184313`*^9}, {3.728495727453259*^9, 3.7284957368624372`*^9}, {
   3.728495928466558*^9, 3.72849592873841*^9}, {3.731976096240344*^9, 
   3.7319762267049303`*^9}, {3.731976277432869*^9, 3.7319762780290833`*^9}, {
   3.7319768020188913`*^9, 3.731976803777299*^9}, {3.731976892921598*^9, 
   3.731976916165578*^9}, {3.731976959563902*^9, 3.731976962085402*^9}, {
   3.731977155942281*^9, 3.73197716443357*^9}, {3.731977195279862*^9, 
   3.7319772065728207`*^9}, {3.731977279507853*^9, 3.731977284166617*^9}, {
   3.731977461555399*^9, 3.731977465980788*^9}, {3.731978006012163*^9, 
   3.731978013040636*^9}, {3.731978082421216*^9, 3.731978094010425*^9}, {
   3.731979039353709*^9, 3.731979039363929*^9}, {3.731979598523592*^9, 
   3.73197961490341*^9}, {3.73197972820308*^9, 3.7319797289924088`*^9}, {
   3.731980249144205*^9, 3.73198026694471*^9}, 3.731980373788886*^9, {
   3.7319804050810537`*^9, 3.731980445644969*^9}, {3.731980548309566*^9, 
   3.731980566185113*^9}, {3.731980610588462*^9, 3.7319806369962673`*^9}, {
   3.731980738391506*^9, 3.731980763895586*^9}, {3.731980818773868*^9, 
   3.731980857708199*^9}, {3.731980943731715*^9, 3.731981000719969*^9}, 
   3.731981067123608*^9, {3.732221099817436*^9, 3.7322211073866863`*^9}, {
   3.732237132742322*^9, 3.73223714782172*^9}, {3.732237266376129*^9, 
   3.732237271289744*^9}, {3.732273382440886*^9, 3.73227340932165*^9}, {
   3.732273491519849*^9, 3.732273491669429*^9}, {3.732394286439495*^9, 
   3.732394371996009*^9}, 3.755182267229639*^9, 3.755184973022751*^9, {
   3.75582209648076*^9, 3.7558220982190313`*^9}, {3.7558225635660257`*^9, 
   3.7558225772644787`*^9}, {3.7585221898099403`*^9, 3.7585221899906693`*^9}, 
   3.759140406004279*^9, {3.75914072046175*^9, 3.759140778591229*^9}, {
   3.759141110454555*^9, 3.7591411170112877`*^9}, 3.759142070148613*^9, {
   3.759926864600369*^9, 3.759926908779594*^9}, {3.7599440817309227`*^9, 
   3.759944089031756*^9}, {3.7599442652749147`*^9, 3.7599442925085506`*^9}, {
   3.759944468213972*^9, 3.759944470421031*^9}, {3.759944509678103*^9, 
   3.759944625568841*^9}, {3.759944680926206*^9, 3.759944704050845*^9}, {
   3.759944777100625*^9, 3.759944777332377*^9}, {3.7599452123441133`*^9, 
   3.759945212472487*^9}, 3.761151167307536*^9, 3.7613779187363462`*^9, {
   3.769182368428945*^9, 3.7691823684332743`*^9}, {3.769182447225265*^9, 
   3.769182447229724*^9}, 3.7697607053790417`*^9, 3.770438265000821*^9, {
   3.770721434046843*^9, 3.770721434486648*^9}, {3.7746909735763407`*^9, 
   3.774690974277783*^9}, 3.786090308105297*^9, 3.7860903405306396`*^9, {
   3.7861697725876913`*^9, 3.7861697838397303`*^9}, {3.7861698579109*^9, 
   3.7861698645494623`*^9}, {3.786257005170101*^9, 3.786257029661643*^9}, {
   3.786259628183383*^9, 3.78625966453019*^9}, {3.7862596972230663`*^9, 
   3.7862597130857067`*^9}, {3.786260599076335*^9, 3.7862606519012136`*^9}, {
   3.786260711471278*^9, 3.7862607825400476`*^9}, {3.786262427305735*^9, 
   3.7862624297094097`*^9}, {3.786262672446123*^9, 3.7862626757022247`*^9}, {
   3.7941372405540857`*^9, 3.794137240568924*^9}, 3.798128132723709*^9, {
   3.798232559307932*^9, 3.798232607817318*^9}, 3.8002032936287107`*^9, {
   3.800228806267811*^9, 3.8002288701566067`*^9}, {3.800229240434243*^9, 
   3.8002292588092833`*^9}, {3.800230257115494*^9, 3.800230271819356*^9}, {
   3.800230689976359*^9, 3.800230696507571*^9}, {3.800230861506472*^9, 
   3.8002308853617268`*^9}, {3.800231148936945*^9, 3.8002311628361807`*^9}, {
   3.800269707014142*^9, 3.80026972050751*^9}, {3.8004654280139236`*^9, 
   3.8004654993620977`*^9}, {3.807369332962606*^9, 3.807369333743342*^9}, {
   3.807369626808475*^9, 3.807369633505528*^9}, {3.807376451767674*^9, 
   3.807376461724361*^9}, {3.8154778674250393`*^9, 3.8154778786474133`*^9}, {
   3.8154783955502*^9, 3.8154784000536633`*^9}, {3.815479106257626*^9, 
   3.815479107656157*^9}, {3.829315987079705*^9, 3.829316001463244*^9}, 
   3.833033078563163*^9, {3.833033108685328*^9, 3.833033148581917*^9}, 
   3.833038502668605*^9, 3.835030194667267*^9, {3.859148473878541*^9, 
   3.859148484706414*^9}, 3.8591503881615667`*^9, 3.8594808660648727`*^9, 
   3.8594809215028048`*^9, {3.859481010380721*^9, 3.859481014177998*^9}, {
   3.85948118066334*^9, 3.859481183379318*^9}, {3.859481298816181*^9, 
   3.859481315770236*^9}, {3.859481351730167*^9, 3.859481376563326*^9}, {
   3.8595884244545803`*^9, 3.859588479932879*^9}, {3.859588743998242*^9, 
   3.859588765495607*^9}, {3.859588806482554*^9, 3.859588926483329*^9}, {
   3.859589076697467*^9, 3.8595890862667627`*^9}, {3.859589141801827*^9, 
   3.859589247695283*^9}, {3.859589278802657*^9, 3.8595893184973927`*^9}, {
   3.859589355053155*^9, 3.859589394885363*^9}, {3.8595894565019217`*^9, 
   3.859589464785759*^9}, {3.859589499943409*^9, 3.8595895551048613`*^9}, {
   3.859589593067071*^9, 3.8595896843311996`*^9}, 3.859589915082026*^9, {
   3.859589979348977*^9, 3.8595899793771067`*^9}, {3.859590726243621*^9, 
   3.859590757603325*^9}, 3.859640095466408*^9, {3.859648360374277*^9, 
   3.859648389450727*^9}, {3.859649217444069*^9, 3.85964922877459*^9}, {
   3.859657651647107*^9, 3.859657715461317*^9}, {3.8597223431582127`*^9, 
   3.859722349203199*^9}, {3.870793309356901*^9, 3.870793309988036*^9}, 
   3.870810224016097*^9, {3.871909025974709*^9, 3.871909029201529*^9}, 
   3.8719101640474253`*^9, 3.8719116216008463`*^9, {3.8719117586639767`*^9, 
   3.8719117851224957`*^9}, {3.871911824020739*^9, 3.871911898782824*^9}, {
   3.8719119821779833`*^9, 3.871912009909605*^9}, {3.8719124337875853`*^9, 
   3.871912435171369*^9}, {3.8719131498057203`*^9, 3.871913180106717*^9}, {
   3.871913220456274*^9, 3.871913227902382*^9}, {3.8719134735780153`*^9, 
   3.871913509640698*^9}, {3.8719136888826103`*^9, 3.8719137381955547`*^9}, {
   3.871914277230426*^9, 3.871914282229678*^9}, {3.871917802088578*^9, 
   3.871917805074687*^9}, {3.8786729753409986`*^9, 3.878672995239841*^9}, {
   3.895730252940528*^9, 3.895730278366877*^9}, {3.8957303334834337`*^9, 
   3.895730334583846*^9}, 3.895730555648501*^9, {3.8957403869975033`*^9, 
   3.895740409874614*^9}, {3.8957405918184423`*^9, 3.895740593502267*^9}, {
   3.895745674687949*^9, 3.8957456749881287`*^9}, {3.895745778457499*^9, 
   3.895745885426029*^9}, {3.895746427256188*^9, 3.8957464679543333`*^9}, {
   3.8957465015110064`*^9, 3.895746530836865*^9}, {3.8957465648800497`*^9, 
   3.89574656586539*^9}, 3.8957466587158537`*^9, 3.895746902836652*^9, 
   3.895747004855443*^9, {3.895747049148716*^9, 3.8957470925184526`*^9}, {
   3.8957473696738253`*^9, 3.895747369832449*^9}, {3.895748288332128*^9, 
   3.8957482916817083`*^9}, {3.895748391900106*^9, 
   3.8957484518699093`*^9}},ExpressionUUID->"de6e5b24-4a00-43c2-9feb-\
57b7e1a1fda7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",ExpressionUUID->"d4978c96-2e19-4547-bfad-07524f53a321"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FindEcoEqs", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Method", "\[Rule]", "Automatic"}], ",", "\n", 
     RowBox[{"FindRootOpts", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"FindRootsOpts", "->", 
      RowBox[{"{", "}"}]}], ",", "\n", 
     RowBox[{"PerCapita", "\[Rule]", "False"}], ",", 
     RowBox[{"Fixed", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"Chop", "\[Rule]", "True"}], ",", 
     RowBox[{"QSS", "\[Rule]", "False"}], ",", 
     RowBox[{"Time", "\[Rule]", "t"}], ",", 
     RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
     RowBox[{"Verbosity", "->", "0"}], ",", 
     RowBox[{"IgnoreVar", "->", "False"}]}], "}"}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.68788145061252*^9, {3.6885716849598207`*^9, 3.688571685061096*^9}, 
   3.6998307192614937`*^9, {3.699830756047996*^9, 3.699830757855876*^9}, {
   3.7146768525874043`*^9, 3.714676860849709*^9}, {3.714771544699765*^9, 
   3.714771544916628*^9}, 3.725140957991322*^9, {3.755266321588594*^9, 
   3.755266324656404*^9}, 3.7553697389508457`*^9, 3.755370573729661*^9, 
   3.75994589946877*^9, 3.7701200065679617`*^9, {3.770645589515258*^9, 
   3.770645593339229*^9}, {3.7982325865648317`*^9, 3.798232589900823*^9}, {
   3.817979839496348*^9, 3.817979840182137*^9}, {3.817986745774179*^9, 
   3.817986747250039*^9}, 3.817986827594922*^9, 3.8293159782581778`*^9, {
   3.859588972329741*^9, 3.859588974605693*^9}, {3.859590467440824*^9, 
   3.859590470000128*^9}, {3.8708128961119843`*^9, 3.870812906654851*^9}, 
   3.870813046791561*^9, {3.8719137515576057`*^9, 3.871913757389619*^9}, {
   3.8957463735184927`*^9, 3.895746373790223*^9}, 3.895746759024796*^9, 
   3.895748433745779*^9},ExpressionUUID->"a0e9ec7b-c7e3-4d9c-839f-\
6691ecc5def4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Messages", "Subsubsection",
 CellChangeTimes->{{3.7695018515541153`*^9, 
  3.769501852845079*^9}},ExpressionUUID->"48e74311-84a6-4511-ac42-\
7fcdd3b3efb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EcoEq", "::", "noneq"}], "=", "\n", 
   "\"\<Can't find equilibrium of periodically forced model with FindRoot.  \
Give Time option or try FindEcoCycle instead.\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.769501857001574*^9, 3.769501857579821*^9}, {
  3.8596474251654797`*^9, 3.859647429307817*^9}, {3.8719132863927526`*^9, 
  3.871913346568707*^9}, {3.8957467495110283`*^9, 
  3.8957467516118526`*^9}},ExpressionUUID->"8928a793-ad25-4d85-bb3e-\
dedd5a10dde0"]
}, Open  ]]
}, Closed]]
},
WindowSize->{808, 764},
WindowMargins->{{352, Automatic}, {Automatic, 50}},
Magnification->1.25,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b638a04e-5bd9-4518-8260-7f3ee4ad65fe"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "1.7.0"->{
  Cell[580, 22, 299, 4, 67, "Subsection",ExpressionUUID->"00cd7117-b6cd-4a16-b559-b50803931bc0",
   CellTags->{"1.7.0", "1.7.1"}],
  Cell[106473, 2168, 316, 5, 46, "Subsection",ExpressionUUID->"e114b706-511f-4db9-b0ab-91b74f214f84",
   CellTags->{"1.7.0", "1.7.1"}],
  Cell[143028, 2899, 290, 5, 46, "Subsection",ExpressionUUID->"e718424c-4b66-41a2-90b8-ebff33b6aa8f",
   CellTags->{"1.7.0", "1.7.1"}],
  Cell[186245, 3781, 313, 5, 46, "Subsection",ExpressionUUID->"a2dcdae5-6076-457f-a63d-d727d0518ae5",
   CellTags->{"1.7.0", "1.7.1"}]},
 "1.7.1"->{
  Cell[580, 22, 299, 4, 67, "Subsection",ExpressionUUID->"00cd7117-b6cd-4a16-b559-b50803931bc0",
   CellTags->{"1.7.0", "1.7.1"}],
  Cell[106473, 2168, 316, 5, 46, "Subsection",ExpressionUUID->"e114b706-511f-4db9-b0ab-91b74f214f84",
   CellTags->{"1.7.0", "1.7.1"}],
  Cell[143028, 2899, 290, 5, 46, "Subsection",ExpressionUUID->"e718424c-4b66-41a2-90b8-ebff33b6aa8f",
   CellTags->{"1.7.0", "1.7.1"}],
  Cell[186245, 3781, 313, 5, 46, "Subsection",ExpressionUUID->"a2dcdae5-6076-457f-a63d-d727d0518ae5",
   CellTags->{"1.7.0", "1.7.1"}]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"1.7.0", 224771, 4549},
 {"1.7.1", 225323, 4558}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 299, 4, 67, "Subsection",ExpressionUUID->"00cd7117-b6cd-4a16-b559-b50803931bc0",
 CellTags->{"1.7.0", "1.7.1"}],
Cell[CellGroupData[{
Cell[904, 30, 156, 3, 56, "Subsubsection",ExpressionUUID->"d60e9445-48fe-419b-9155-c309298ab8ae"],
Cell[1063, 35, 3037, 55, 546, "Code",ExpressionUUID->"a1423a8e-1bcd-477e-8f94-62c6e20605f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4137, 95, 159, 3, 56, "Subsubsection",ExpressionUUID->"0175d95c-231e-49c4-8b45-8b8da1aef5cc"],
Cell[4299, 100, 8955, 169, 816, "Code",ExpressionUUID->"b5a09804-ad41-45c0-83ed-a967324e0b87"],
Cell[13257, 271, 9125, 171, 744, "Code",ExpressionUUID->"4885417d-26f9-4722-be7e-b9fbf1aeffac"],
Cell[22385, 444, 9467, 180, 841, "Code",ExpressionUUID->"2ce343f2-41ea-4110-b43a-91fa878f1c7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31889, 629, 163, 3, 56, "Subsubsection",ExpressionUUID->"27a7cec4-4ed5-474b-9c85-9892ad21c607"],
Cell[32055, 634, 34235, 709, 3419, "Code",ExpressionUUID->"18468973-76fd-4a55-a05d-338d246c3279"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66327, 1348, 87, 0, 56, "Subsubsection",ExpressionUUID->"02f1735a-c9d7-4585-9cd6-06d84a031d10"],
Cell[66417, 1350, 1938, 40, 114, "Code",ExpressionUUID->"78ce2824-75a7-4987-8d29-b91a275f217e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68392, 1395, 160, 3, 56, "Subsubsection",ExpressionUUID->"b5cbbcce-7db5-4aa3-ac37-3914d6d8eb2e"],
Cell[68555, 1400, 1658, 34, 114, "Code",ExpressionUUID->"68f89b0e-5fee-4fbf-9f15-6fcdde8e3abc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70250, 1439, 161, 3, 56, "Subsubsection",ExpressionUUID->"a0633838-c88f-4d52-8b68-8e6888510716"],
Cell[70414, 1444, 793, 19, 138, "Code",ExpressionUUID->"72ec5213-0fe9-432d-8057-8b6cf753af3e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[71256, 1469, 158, 3, 46, "Subsection",ExpressionUUID->"ae80f2a0-faaf-421f-afa4-248fd0788fa1"],
Cell[CellGroupData[{
Cell[71439, 1476, 157, 3, 56, "Subsubsection",ExpressionUUID->"f5a0d152-5c6a-4890-a8e0-323e332777f1"],
Cell[71599, 1481, 8430, 153, 649, "Code",ExpressionUUID->"3af9ae23-d888-4499-a1dd-1f672ffa1a5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80066, 1639, 163, 3, 56, "Subsubsection",ExpressionUUID->"3507ba4e-1157-438c-96bb-40fc633bc396"],
Cell[80232, 1644, 24345, 476, 2217, "Code",ExpressionUUID->"2d56be05-4f29-4333-8b30-1dd98d8288f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104614, 2125, 87, 0, 56, "Subsubsection",ExpressionUUID->"891b5f7a-30c7-4cf3-8da9-bd641cdb7e6a"],
Cell[104704, 2127, 1720, 35, 114, "Code",ExpressionUUID->"1aaf3e11-1001-45f5-9932-8e40749524cd"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[106473, 2168, 316, 5, 46, "Subsection",ExpressionUUID->"e114b706-511f-4db9-b0ab-91b74f214f84",
 CellTags->{"1.7.0", "1.7.1"}],
Cell[CellGroupData[{
Cell[106814, 2177, 156, 3, 56, "Subsubsection",ExpressionUUID->"fbf17b3d-6457-42d5-82ab-af0c75dea668"],
Cell[106973, 2182, 1206, 20, 162, "Code",ExpressionUUID->"2e74ce64-7c66-4e70-a4ef-67eaaac23cdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108216, 2207, 159, 3, 56, "Subsubsection",ExpressionUUID->"f37f2af6-eba9-4bb6-b6f4-629c73f9876d"],
Cell[108378, 2212, 8342, 152, 649, "Code",ExpressionUUID->"055269d3-de2d-4f05-90dd-b3f02eabd837"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116757, 2369, 163, 3, 56, "Subsubsection",ExpressionUUID->"2fcc0a69-7a7d-4ff8-92ff-5bc542617877"],
Cell[116923, 2374, 23159, 448, 2098, "Code",ExpressionUUID->"a81e8d9d-6dd9-46ad-b70a-0282dfebb957"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140119, 2827, 87, 0, 56, "Subsubsection",ExpressionUUID->"e72664da-56ef-4a7d-8254-33f2d2f3dbd0"],
Cell[140209, 2829, 1776, 35, 114, "Code",ExpressionUUID->"a29242de-80b3-4242-8bdc-a67b902b430f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142022, 2869, 161, 3, 56, "Subsubsection",ExpressionUUID->"79d5772e-00aa-49c2-93f9-697cac95c54f"],
Cell[142186, 2874, 793, 19, 138, "Code",ExpressionUUID->"f9fb8ee5-03da-40ce-a49c-a32fe40cf5db"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[143028, 2899, 290, 5, 46, "Subsection",ExpressionUUID->"e718424c-4b66-41a2-90b8-ebff33b6aa8f",
 CellTags->{"1.7.0", "1.7.1"}],
Cell[CellGroupData[{
Cell[143343, 2908, 156, 3, 56, "Subsubsection",ExpressionUUID->"19c95129-4ee8-4545-aa42-aeb232dd6b00"],
Cell[143502, 2913, 1014, 17, 114, "Code",ExpressionUUID->"448d68ee-f66b-4ac6-a178-0035cd1538fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144553, 2935, 159, 3, 56, "Subsubsection",ExpressionUUID->"e86650a0-532b-4d90-bc4a-b802de50035a"],
Cell[144715, 2940, 10305, 197, 841, "Code",ExpressionUUID->"07d849aa-9d77-4e6e-928e-8d16a1fa3c68"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155057, 3142, 163, 3, 56, "Subsubsection",ExpressionUUID->"6bc80d68-e2ea-4c9e-8e0a-55e074be8d59"],
Cell[155223, 3147, 28340, 566, 2733, "Code",ExpressionUUID->"6ad1d61a-2b99-468a-ab83-56fc4ff9ee53"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183600, 3718, 87, 0, 56, "Subsubsection",ExpressionUUID->"738c8a5a-631b-41e0-8985-7f8534cf7a26"],
Cell[183690, 3720, 1796, 35, 114, "Code",ExpressionUUID->"916fd241-1f6d-4a32-bd57-20cd779d88b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185523, 3760, 161, 3, 56, "Subsubsection",ExpressionUUID->"9719155e-9423-4c4d-b01c-1fcb358b29c9"],
Cell[185687, 3765, 509, 10, 90, "Code",ExpressionUUID->"987688a6-7531-4060-9e38-714cc76891af"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[186245, 3781, 313, 5, 46, "Subsection",ExpressionUUID->"a2dcdae5-6076-457f-a63d-d727d0518ae5",
 CellTags->{"1.7.0", "1.7.1"}],
Cell[CellGroupData[{
Cell[186583, 3790, 156, 3, 56, "Subsubsection",ExpressionUUID->"b5f0d8dd-bd56-45fc-af75-340d600a0bed"],
Cell[186742, 3795, 1069, 18, 114, "Code",ExpressionUUID->"0b5f195c-426a-43bf-a5f9-17a389906a84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187848, 3818, 159, 3, 56, "Subsubsection",ExpressionUUID->"3ae30d26-e084-4509-ba29-660ec82b043a"],
Cell[188010, 3823, 9285, 170, 697, "Code",ExpressionUUID->"46864737-e396-499c-86e6-c2eca1a1c8d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197332, 3998, 163, 3, 56, "Subsubsection",ExpressionUUID->"c6c513e6-7f01-4df5-8c2b-8ea70acf14ff"],
Cell[197498, 4003, 24224, 468, 2195, "Code",ExpressionUUID->"de6e5b24-4a00-43c2-9feb-57b7e1a1fda7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221759, 4476, 87, 0, 56, "Subsubsection",ExpressionUUID->"d4978c96-2e19-4547-bfad-07524f53a321"],
Cell[221849, 4478, 1819, 35, 114, "Code",ExpressionUUID->"a0e9ec7b-c7e3-4d9c-839f-6691ecc5def4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223705, 4518, 161, 3, 56, "Subsubsection",ExpressionUUID->"48e74311-84a6-4511-ac42-7fcdd3b3efb0"],
Cell[223869, 4523, 509, 10, 90, "Code",ExpressionUUID->"8928a793-ad25-4d85-bb3e-dedd5a10dde0"]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)

